<% if params[:service] == "googlescholar" and ((controller.action_name == "edit" or (controller.action_name == "update" and !@user.errors.empty?))) %>
<div class="span6">
	  <%= form_for :user, :url => user_path(@user.username, :partial => "service", :service => "googlescholar"), :html => { :class => "well", :method => :put, :remote => true } do |f| %>
      <label>Google Scholar</label>
		  <%= f.text_field :googlescholar %><br />
		  <%= link_to "Cancel", user_path(@user.username, :partial => "service"), :remote => true, :class => "btn" %>
		  <%= f.submit("Submit", :class => "btn-primary") %>
		<% end %>
	</div>
<% else %>
  <div class="span3">
	  <%= image_tag "googlescholar.png", :class => "photo_mini", :title => "Google Scholar" %><br/>
		<span class="name"><%= @user.googlescholar.blank? ? "not set" : link_to(@user.googlescholar, "http://scholar.google.com/citations?user=" + @user.googlescholar) %></span>
		<% if current_user == @user or current_user.try(:admin?) %>&nbsp;<%= link_to '<i class="icon-pencil"></i>'.html_safe, edit_user_path(@user.username, :partial => "service", :service => "googlescholar"),
		                                       :remote => true,
																					 :method => :get,
		                                       :title => "Edit Google Scholar" %>
		<% end %>
	</div>
<% end %>