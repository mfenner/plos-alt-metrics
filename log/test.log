# Logfile created on Thu Jan 13 13:19:15 -0800 2011  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load Including Associations (0.6ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (16.0ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.1/foo', NULL, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mConnotea Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844140, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mCrossRef Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844140, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (44.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:19:17', `retrieved_at` = '2011-01-13 21:18:17' WHERE `id` = 562580130[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:17', `retrieved_at` = '2011-01-13 21:18:17' WHERE `id` = 721439208[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:17', `retrieved_at` = '2011-01-13 21:18:17' WHERE `id` = 1040397643[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:17', `retrieved_at` = '2009-01-13 21:19:17' WHERE `id` = 721439208[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (47.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844141, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844141, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (49.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844142, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844142, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (50.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 21:19:17' [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.6ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 21:19:16' [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (56.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.1/foo', '2011-01-12 21:19:17', 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844143, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844143, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (48.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.1/foo', '2011-01-12 21:19:17', 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844144, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844144, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Update (0.1ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 21:19:17' [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (55.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:17', '10.1/foo', NULL, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844145, NULL, 12978895, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:17', 959844145, NULL, 365262434, 0)[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:19:17', `published_on` = '2011-01-12 21:19:17' WHERE `id` = 959844145[0m
2011-01-13 13:19:17 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:17 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (257.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:18', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:18', 1, NULL, 1, 0)[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (54.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:19:18 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:18', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 13:19:18 - DEBUG:   [4;35;1mSQL (43.8ms)[0m   [0mCOMMIT[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:19', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (44.5ms)[0m   [0mCOMMIT[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:19', '10.0/citable', NULL, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:19', 959844146, NULL, 12978895, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:19', 959844146, NULL, 365262434, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 21:19:19', NULL, '2011-01-13 21:19:19', 1040397658)[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:19:19 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:19 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:19', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:19 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:19 - INFO: Got 1 citation details.
2011-01-13 13:19:19 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:19:19 - DEBUG: Existing citation count: 1
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG: After existing citations uniquified: 1
2011-01-13 13:19:19 - INFO: Creating citation uri
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 21:19:19', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 21:19:19', 1040397658)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG: Citation count: 2
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:19', `retrieved_at` = '2011-01-13 21:19:19' WHERE `id` = 1040397658[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:19:19', 1, '2011-01-13 21:19:19', 2011, 1040397658, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 21:19:19', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 13:19:19 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:19', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:19:19', `retrieved_at` = '2011-01-13 21:19:19' WHERE `id` = 959844146[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - INFO: Refreshed article 10.0/citable
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (51.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:19', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:19', 959844147, NULL, 12978895, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:19', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:19', 959844147, NULL, 365262434, 0)[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:19:19 - INFO: Skipping: article not published yet
2011-01-13 13:19:19 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (38.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:19:19 - DEBUG: Updating 2 stale articles
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:19 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:19 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mRetrieval Update (29.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:19', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:19 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:19 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:19 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:19 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:19 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:19 - DEBUG: Request headers:
2011-01-13 13:19:19 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:19 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:19 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:20 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:19:20 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:20', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (49.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mCrossRef Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 21:19:20', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:19:20 - DEBUG: Updating 2 stale articles
2011-01-13 13:19:20 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:20 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:20 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:20', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:20 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:20 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:20 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:20 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:20 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:20 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:20 - DEBUG: Request headers:
2011-01-13 13:19:20 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:20 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:20 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:22 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:20", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:19:22 - DEBUG: Response headers:
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - INFO: Got 0 citation details.
2011-01-13 13:19:22 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:19:22 - DEBUG: Existing citation count: 0
2011-01-13 13:19:22 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:19:22 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:19:22 - DEBUG: Citation count: 0
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:22', `retrieved_at` = '2011-01-13 21:19:22' WHERE `id` = 124229983[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:19:22', 1, '2011-01-13 21:19:22', 2011, 124229983, 0)[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 13:19:22 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:22', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:22 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:22', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:22 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:20", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:22', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:19:22', `retrieved_at` = '2011-01-13 21:19:22' WHERE `id` = 959844139[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:19:22 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 13:19:22 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:22 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:22', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 13:19:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:22 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:22 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:22 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:22 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 13:19:22 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 13:19:22 - DEBUG: Request headers:
2011-01-13 13:19:22 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:22 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:22 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:24 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:19:24 - DEBUG: Response headers:
2011-01-13 13:19:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:24 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:24 - INFO: Got 0 citation details.
2011-01-13 13:19:24 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:19:24 - DEBUG: Existing citation count: 0
2011-01-13 13:19:24 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:19:24 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:19:24 - DEBUG: Citation count: 0
2011-01-13 13:19:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:19:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 13:19:24 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:19:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:24 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:24', `retrieved_at` = '2011-01-13 21:19:24' WHERE `id` = 868470324[0m
2011-01-13 13:19:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:19:24 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 13:19:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:19:25', 1, '2011-01-13 21:19:25', 2011, 868470324, 0)[0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 13:19:25 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:19:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:25', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:25 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:25', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 13:19:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:25 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:25 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:20", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:25 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:25 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:19:25 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 13:19:25 - DEBUG: Request headers:
2011-01-13 13:19:25 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:26 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 13:19:26 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:26', `disable_until` = '2011-01-13 21:19:36' WHERE `id` = 365262434[0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:26', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 13:19:26 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 13:19:26 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (52.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:26 - DEBUG: Updating 1 stale article
2011-01-13 13:19:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:26 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:26 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:26', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:26 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:19", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:26 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:26 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:26 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:26 - DEBUG: Request headers:
2011-01-13 13:19:26 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:26 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:26 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:27 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:19", updated_at: "2011-01-13 21:19:26", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:19:27 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:27', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (44.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:19:27', 0, '2011-01-13 21:19:27', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (45.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 21:19:27' WHERE `id` = 12978895[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:27 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 13:19:27 - INFO: Sent mail to alm@alm.example.org
2011-01-13 13:19:27 - DEBUG: 
Date: Thu, 13 Jan 2011 13:19:27 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 21:19:27', `disable_until` = '2011-01-15 21:19:27' WHERE `id` = 12978895[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (49.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mConnotea Update (0.1ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 21:19:27' WHERE `id` = 12978895[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:27 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mConnotea Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 21:19:27', `disable_until` = '2011-01-13 21:19:31' WHERE `id` = 12978895[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - INFO: Connotea is disabled until 2011-01-13 13:19:31 -0800. Skipping.
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:27 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 21:19:31', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (45.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '13a29f68aaa7c4719fde2d4b2dcd9bc99cc5bacf', '2011-01-13 21:19:31', '57451f09d05e768553170dc2d330b9d5db474fa1', NULL, '2011-01-13 21:19:31', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (51.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (44.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = '2011-01-27 21:19:31', `remember_token` = '3baa8fab40913a9776461cf2938843522f116538' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (47.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = '2011-01-20 21:19:31', `remember_token` = 'cd9c32d8df231e2c256c69461d428ab5956de0fb' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (47.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = '2011-01-20 21:19:31', `remember_token` = 'b18b8a1c1549b4346831c273e61bf4040073357d' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (49.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (6.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (56.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = '2011-01-27 21:19:31', `remember_token` = '0c045e524670e11d6e4fbe32e71ccd10d2fca360' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (45.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = '2011-01-27 21:19:31', `remember_token` = 'b604f41adf95c16a26f6f4eaa82dfe8107c71c89' WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:19:31', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:19:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:31 - DEBUG:   [4;36;1mSQL (52.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:33 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:19:33) [POST]
2011-01-13 13:19:33 - INFO:   Parameters: {"article"=>{"doi"=>"10.0/dummy"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:19:33 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:19:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:19:33', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mConnotea Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:33', 959844148, NULL, 12978895, 0)[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mCrossRef Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:19:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:19:33', 959844148, NULL, 365262434, 0)[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:19:33 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0%2Fdummy
2011-01-13 13:19:33 - INFO: Completed in 24ms (DB: 93) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.0%2Fdummy]
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSQL (51.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:33 - INFO: 

Processing ArticlesController#destroy (for 0.0.0.0 at 2011-01-13 13:19:33) [DELETE]
2011-01-13 13:19:33 - INFO:   Parameters: {"action"=>"destroy", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:33 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 124229983) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Destroy (0.1ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 124229983[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mArticle Destroy (0.2ms)[0m   [0;1mDELETE FROM `articles` WHERE `id` = 959844139[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - INFO: Redirected to http://test.host/articles
2011-01-13 13:19:33 - INFO: Completed in 9ms (DB: 54) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSQL (51.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:33 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:33) [GET]
2011-01-13 13:19:33 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles", "query"=>"pgen"}
2011-01-13 13:19:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (doi like '%pgen%') ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:19:33 - INFO: Rendering articles/index
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:33 - INFO: Completed in 8ms (View: 3, DB: 53) | 200 OK [http://test.host/articles.csv?query=pgen]
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:33 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:19:33) [GET]
2011-01-13 13:19:33 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:33 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:33 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:c1806333a3da060c61dfdf4c54ba0fe7", :article_id=>959844139}
2011-01-13 13:19:33 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:33 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:33 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:33', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:33 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:33 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:33 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:33 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:33 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:33 - DEBUG: Request headers:
2011-01-13 13:19:33 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:33 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:33 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:34 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:34', `disable_until` = '2011-01-13 21:19:44' WHERE `id` = 12978895[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_json_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:34 - INFO: RetrievalWorker done.
2011-01-13 13:19:34 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:c1806333a3da060c61dfdf4c54ba0fe7
2011-01-13 13:19:34 - INFO: Completed in 328ms (View: 0, DB: 7) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json]
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (60.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:19:34) [GET]
2011-01-13 13:19:34 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:34 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:d471b237cdb201b348daa343ba218870", :article_id=>959844139}
2011-01-13 13:19:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:34 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:34 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:34 - DEBUG: Request headers:
2011-01-13 13:19:34 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:34 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:34 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:34', `disable_until` = '2011-01-13 21:19:44' WHERE `id` = 12978895[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:34 - INFO: RetrievalWorker done.
2011-01-13 13:19:34 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:d471b237cdb201b348daa343ba218870
2011-01-13 13:19:34 - INFO: Completed in 203ms (View: 0, DB: 67) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c]
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (47.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:19:34) [GET]
2011-01-13 13:19:34 - INFO:   Parameters: {"format"=>"json", "citations"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:34 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mCitation Load (0.2ms)[0m   [0mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:dc996b668360bcc208f293aa65d9b564", :article_id=>959844139}
2011-01-13 13:19:34 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:34 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:34 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:34 - DEBUG: Request headers:
2011-01-13 13:19:34 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:34 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:34 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:34', `disable_until` = '2011-01-13 21:19:44' WHERE `id` = 12978895[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_with_citations_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:34 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:34 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:34 - INFO: RetrievalWorker done.
2011-01-13 13:19:34 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:dc996b668360bcc208f293aa65d9b564
2011-01-13 13:19:34 - INFO: Completed in 259ms (View: 0, DB: 55) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&citations=1]
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (53.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:19:34) [GET]
2011-01-13 13:19:34 - INFO:   Parameters: {"format"=>"json", "history"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:34 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mHistory Load (0.4ms)[0m   [0;1mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.6ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:a26fe42aff61902e291a674e385bb273", :article_id=>959844139}
2011-01-13 13:19:34 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:34 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mRetrieval Update (0.5ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:34', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:34 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:34 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:34 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:34 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:34 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:34 - DEBUG: Request headers:
2011-01-13 13:19:34 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:34 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:35 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:35 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:35', `disable_until` = '2011-01-13 21:19:45' WHERE `id` = 12978895[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:35 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_with_history_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:35 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:35', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:35 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:35', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:35 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:35', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:35 - INFO: RetrievalWorker done.
2011-01-13 13:19:35 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:a26fe42aff61902e291a674e385bb273
2011-01-13 13:19:35 - INFO: Completed in 234ms (View: 0, DB: 62) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&history=1]
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSQL (43.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:35 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:19:35) [GET]
2011-01-13 13:19:35 - INFO:   Parameters: {"format"=>"xml", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:35 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:35 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:1611d13c18db5c0c3607d65393392f4b", :article_id=>959844139}
2011-01-13 13:19:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:35 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:35 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:35', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:35 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:35 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:35 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:35 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:35 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:35 - DEBUG: Request headers:
2011-01-13 13:19:35 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:35 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:35 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:36 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:35", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:36 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:36', `disable_until` = '2011-01-13 21:19:46' WHERE `id` = 12978895[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:36 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:36 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:36', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:36 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:36', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:36 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:36', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:36 - INFO: RetrievalWorker done.
2011-01-13 13:19:36 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:1611d13c18db5c0c3607d65393392f4b
2011-01-13 13:19:36 - INFO: Completed in 1475ms (View: 0, DB: 51) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml]
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSQL (43.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:36 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:19:36) [GET]
2011-01-13 13:19:36 - INFO:   Parameters: {"format"=>"xml", "citations"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:36 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:36 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:ad1dfdd6cd376b545ffeb7ee8be20da7", :article_id=>959844139}
2011-01-13 13:19:36 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:36 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:36 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:36', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:36 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:36 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:36 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:36 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:36 - DEBUG: Request headers:
2011-01-13 13:19:36 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:36 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:36 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:36", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:37 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:37', `disable_until` = '2011-01-13 21:19:47' WHERE `id` = 12978895[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_citations_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:37 - INFO: RetrievalWorker done.
2011-01-13 13:19:37 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:ad1dfdd6cd376b545ffeb7ee8be20da7
2011-01-13 13:19:37 - INFO: Completed in 448ms (View: 0, DB: 50) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?citations=1]
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (43.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"xml", "history"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mHistory Load (0.1ms)[0m   [0mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:fa8ea3b27b86e3ebcb77dbc1fd865248", :article_id=>959844139}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:37 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:37 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:37 - DEBUG: Request headers:
2011-01-13 13:19:37 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:37 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:37 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:37", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:37 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:37', `disable_until` = '2011-01-13 21:19:47' WHERE `id` = 12978895[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.7ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_history_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:37 - INFO: RetrievalWorker done.
2011-01-13 13:19:37 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:fa8ea3b27b86e3ebcb77dbc1fd865248
2011-01-13 13:19:37 - INFO: Completed in 227ms (View: 0, DB: 52) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?history=1]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (46.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#edit (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"action"=>"edit", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:37 - INFO: Rendering template within layouts/application
2011-01-13 13:19:37 - INFO: Rendering articles/edit
Rendered articles/_form (6.1ms)
2011-01-13 13:19:37 - INFO: Completed in 16ms (View: 15, DB: 47) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005/edit]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"action"=>"index", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:19:37 - INFO: Rendering template within layouts/application
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:37 - INFO: Completed in 9ms (View: 7, DB: 1) | 200 OK [http://test.host/articles]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#new (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"action"=>"new", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:37 - INFO: Rendering template within layouts/application
2011-01-13 13:19:37 - INFO: Rendering articles/new
Rendered articles/_form (3.9ms)
2011-01-13 13:19:37 - INFO: Completed in 7ms (View: 6, DB: 0) | 200 OK [http://test.host/articles/new]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"1", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) AND `articles`.id IN (959844139, 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 5ms (View: 1, DB: 1) | 200 OK [http://test.host/articles.csv?cited=1]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load Including Associations (0.2ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"0", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load Including Associations (0.2ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) AND `articles`.id IN (819830547) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 5ms (View: 1, DB: 1) | 200 OK [http://test.host/articles.csv?cited=0]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 4ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 8ms (View: 5, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "order"=>"published_on", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY published_on LIMIT 0, 30[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (562580130,959844139,819830547)) [0m
2011-01-13 13:19:37 - INFO: Rendering articles/index
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:19:37 - INFO: Completed in 52ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?order=published_on]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:19:37) [POST]
2011-01-13 13:19:37 - INFO:   Parameters: {"article"=>{}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - INFO: Rendering template within layouts/application
2011-01-13 13:19:37 - INFO: Rendering articles/new
Rendered articles/_form (10.9ms)
2011-01-13 13:19:37 - INFO: Completed in 18ms (View: 13, DB: 1) | 200 OK [http://test.host/articles?]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.0ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#show (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:f75298e3a608b901222c7d73c0861915", :article_id=>959844139}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:19:37 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:19:37 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:19:37 - DEBUG: Request headers:
2011-01-13 13:19:37 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:37 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:37 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:37", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:37 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mConnotea Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:37', `disable_until` = '2011-01-13 21:19:47' WHERE `id` = 12978895[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:113:in `test_should_show_article'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:37 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:37 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:19:37 - INFO: RetrievalWorker done.
2011-01-13 13:19:37 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:f75298e3a608b901222c7d73c0861915
2011-01-13 13:19:37 - INFO: Rendering template within layouts/application
2011-01-13 13:19:37 - INFO: Rendering articles/show
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:19:37 - INFO: Completed in 215ms (View: 12, DB: 7) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (53.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:19:37) [GET]
2011-01-13 13:19:37 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles"}
2011-01-13 13:19:37 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:4af53bf530ee46000f31d58f3103f203", :article_id=>562580130}
2011-01-13 13:19:37 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:37 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:37', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:19:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:37 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:37 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:37 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:19:37 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:19:37 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:19:37 - DEBUG: Request headers:
2011-01-13 13:19:37 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:37 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:37 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:19:38 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:37", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:19:38 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:38', `disable_until` = '2011-01-13 21:19:48' WHERE `id` = 12978895[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:19:38 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:19:38 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:38', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:38 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:38', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:19:38 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:38 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:19:38 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:19:38 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:19:38 - DEBUG: Request headers:
2011-01-13 13:19:38 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:38 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:38 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:38", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:19:38 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mCrossRef Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:19:38', `disable_until` = '2011-01-13 21:19:48' WHERE `id` = 365262434[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:19:38 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:19:38 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:38', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 13:19:38 - INFO: RetrievalWorker done.
2011-01-13 13:19:38 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:4af53bf530ee46000f31d58f3103f203
2011-01-13 13:19:38 - INFO: Rendering articles/show
2011-01-13 13:19:38 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:19:38 - INFO: Completed in 420ms (View: 7, DB: 64) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv]
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSQL (35.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:38 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:19:38) [GET]
2011-01-13 13:19:38 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"connotea"}
2011-01-13 13:19:38 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:38 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:f999784f85cd13c53dc16e7e284b686b", :article_id=>562580130}
2011-01-13 13:19:38 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:19:38 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:38 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:19:38', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:19:38 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:19:38 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:19:38 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:19:38 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:19:38 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:19:38 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:19:38 - DEBUG: Request headers:
2011-01-13 13:19:38 - DEBUG: [accept] = '*/*'
2011-01-13 13:19:38 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:19:38 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:20:04 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:38", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:20:04 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:20:04', `disable_until` = '2011-01-13 21:20:14' WHERE `id` = 12978895[0m
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:20:04 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:20:04 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:04', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:04 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:20:04 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:04', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:20:04 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:04 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:04 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:20:04 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:20:04 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:20:04 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:20:04 - DEBUG: Request headers:
2011-01-13 13:20:04 - DEBUG: [accept] = '*/*'
2011-01-13 13:20:04 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:20:05 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:20:04", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:20:05 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mCrossRef Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:20:05', `disable_until` = '2011-01-13 21:20:15' WHERE `id` = 365262434[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:20:05 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:20:05 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:05', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 13:20:05 - INFO: RetrievalWorker done.
2011-01-13 13:20:05 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:f999784f85cd13c53dc16e7e284b686b
2011-01-13 13:20:05 - INFO: Rendering articles/show
2011-01-13 13:20:05 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:20:05 - INFO: Completed in 26624ms (View: 3, DB: 44) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=connotea]
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (67.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:20:05 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:20:05) [GET]
2011-01-13 13:20:05 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"crossref"}
2011-01-13 13:20:05 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.3ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:20:05 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:828592cb741f7c5037e29abc578de694", :article_id=>562580130}
2011-01-13 13:20:05 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:20:05 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:20:05 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:05', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:20:05 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:05 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:20:05 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:20:05 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:20:05 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:20:05 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:20:05 - DEBUG: Request headers:
2011-01-13 13:20:05 - DEBUG: [accept] = '*/*'
2011-01-13 13:20:05 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:20:05 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:20:35 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:20:05", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 13:20:35 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:20:35', `disable_until` = '2011-01-13 21:20:45' WHERE `id` = 12978895[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:35', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:35 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:35', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:35 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:20:35 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:20:35 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:20:35 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:20:35 - DEBUG: Request headers:
2011-01-13 13:20:35 - DEBUG: [accept] = '*/*'
2011-01-13 13:20:35 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:20:35 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:20:35", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:20:35 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:20:35', `disable_until` = '2011-01-13 21:20:45' WHERE `id` = 365262434[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:20:35 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:20:35 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:19:33", updated_at: "2011-01-13 21:19:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:20:35', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 13:20:35 - INFO: RetrievalWorker done.
2011-01-13 13:20:35 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:828592cb741f7c5037e29abc578de694
2011-01-13 13:20:35 - INFO: Rendering articles/show
2011-01-13 13:20:35 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Completed in 30235ms (View: 4, DB: 76) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=crossref]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (65.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#update (for 0.0.0.0 at 2011-01-13 13:20:35) [PUT]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{}, "action"=>"update", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1371%2Fjournal.pbio.0000005
2011-01-13 13:20:35 - INFO: Completed in 4ms (DB: 67) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005?]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{"doi"=>"10.1000/182"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1000/182') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:20:35', '10.1000/182', NULL, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844149, NULL, 12978895, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844149, NULL, 365262434, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1000%2F182
2011-01-13 13:20:35 - INFO: Completed in 60ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{"doi"=>"10.0092/ooh"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0092/ooh') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:20:35', '10.0092/ooh', NULL, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844150, NULL, 12978895, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844150, NULL, 365262434, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0092%2Fooh
2011-01-13 13:20:35 - INFO: Completed in 11ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{"doi"=>"10.10/♥"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.10/♥') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:20:35', '10.10/♥', NULL, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844151, NULL, 12978895, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844151, NULL, 365262434, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F10.10%2F%E2%99%A5
2011-01-13 13:20:35 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{"doi"=>"1.0/1337"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '1.0/1337') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:20:35', '1.0/1337', NULL, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844152, NULL, 12978895, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844152, NULL, 365262434, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F1.0%2F1337
2011-01-13 13:20:35 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:20:35 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"article"=>{"doi"=>"10.9898098098098/นก"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.9898098098098/นก') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:20:35', '10.9898098098098/นก', NULL, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844153, NULL, 12978895, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:20:35', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:20:35', 959844153, NULL, 365262434, 0)[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/articles/info:doi%2F10.9898098098098%2F%E0%B8%99%E0%B8%81
2011-01-13 13:20:35 - INFO: Completed in 11ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (52.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing DocsController#index (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"index", "controller"=>"docs"}
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/docs/install
2011-01-13 13:20:35 - INFO: Completed in 2ms (DB: 53) | 302 Found [http://test.host/docs]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing DocsController#install (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"install", "controller"=>"docs"}
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering docs/index
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:35 - INFO: Completed in 18ms (View: 6, DB: 0) | 200 OK [http://test.host/docs/install]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: 

Processing GroupsController#groupArticleSummaries (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:20:35 - DEBUG: groupArticleSummaries
2011-01-13 13:20:35 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load Including Associations (0.4ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering groups/groupArticleSummaries
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:35 - INFO: Completed in 10ms (View: 3, DB: 1) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load (0.0ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:20:35 - DEBUG: groupArticleSummaries
2011-01-13 13:20:35 - INFO: format:application/json
2011-01-13 13:20:35 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: Completed in 5ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=json]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "callback"=>"foo", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:20:35 - DEBUG: groupArticleSummaries
2011-01-13 13:20:35 - INFO: format:application/json
2011-01-13 13:20:35 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: Completed in 5ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?callback=foo&format=json]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: 

Processing GroupsController#groupArticleSummaries to xml (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"format"=>"xml", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:20:35 - DEBUG: groupArticleSummaries
2011-01-13 13:20:35 - INFO: format:application/xml
2011-01-13 13:20:35 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:20:35 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:20:35 - INFO: Completed in 7ms (View: 3, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=xml]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/
2011-01-13 13:20:35 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/logout]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = '2011-01-27 21:20:35', `remember_token` = '58ec6689fc47fd418a37e27e02468c3cbd740168' WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering sessions/new
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:35 - INFO: Completed in 5ms (View: 4, DB: 1) | 200 OK [http://test.host/login]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (47.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = '2011-01-27 21:20:35', `remember_token` = '29bd77996189806fc065932b1a8e57629046567f' WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = '2011-01-13 21:15:35' WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '29bd77996189806fc065932b1a8e57629046567f') LIMIT 1[0m
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering sessions/new
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '29bd77996189806fc065932b1a8e57629046567f') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:35 - INFO: Completed in 8ms (View: 6, DB: 49) | 200 OK [http://test.host/login]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '29bd77996189806fc065932b1a8e57629046567f') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (49.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:20:35 - WARN: Failed login for 'quentin' from 0.0.0.0 at 2011-01-13 13:20:35 -0800
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering sessions/new
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:35 - INFO: Completed in 6ms (View: 4, DB: 51) | 200 OK [http://test.host/session?login=quentin&password=bad+password]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/
2011-01-13 13:20:35 - INFO: Completed in 3ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (51.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = '2011-01-27 21:20:35', `remember_token` = 'a698de69233266f6b4e57432db07e1a33e2c94e8' WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'a698de69233266f6b4e57432db07e1a33e2c94e8') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Rendering template within layouts/application
2011-01-13 13:20:35 - INFO: Rendering sessions/new
2011-01-13 13:20:35 - INFO: Completed in 11ms (View: 6, DB: 53) | 200 OK [http://test.host/login]
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (43.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:20:35) [GET]
2011-01-13 13:20:35 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/
2011-01-13 13:20:35 - INFO: Completed in 0ms (DB: 44) | 302 Found [http://test.host/logout]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"remember_me"=>"0", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/
2011-01-13 13:20:35 - INFO: Completed in 3ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=0]
2011-01-13 13:20:35 - DEBUG:   [4;36;1mSQL (40.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:35 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:20:35) [POST]
2011-01-13 13:20:35 - INFO:   Parameters: {"remember_me"=>"1", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:35', `remember_token_expires_at` = '2011-01-27 21:20:35', `remember_token` = 'd3d86ad4bcffb1b644461936aeb96c6e5738ac54' WHERE `id` = 1[0m
2011-01-13 13:20:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:35 - INFO: Redirected to http://test.host/
2011-01-13 13:20:35 - INFO: Completed in 3ms (DB: 41) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=1]
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (44.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"create", "controller"=>"sources", "source"=>{}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUnconfiguredSource Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUnconfiguredSource Create (0.3ms)[0m   [0;1mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:20:36', 0, '2011-01-13 21:20:36', 30, NULL, NULL, 604800, NULL, 10, 'UnconfiguredSource', NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262436 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262436)[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Redirected to http://test.host/sources
2011-01-13 13:20:36 - INFO: Completed in 12ms (DB: 47) | 302 Found [http://test.host/sources?&class=UnconfiguredSource]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (40.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#destroy (for 0.0.0.0 at 2011-01-13 13:20:36) [DELETE]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"destroy", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 1040397643) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 1040397643[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 650162847) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 650162847) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 650162847[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mCrossRef Destroy (0.2ms)[0m   [0;1mDELETE FROM `sources` WHERE `id` = 365262434[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Redirected to http://test.host/sources
2011-01-13 13:20:36 - INFO: Completed in 15ms (DB: 44) | 302 Found [http://test.host/sources/365262434]
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (44.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#edit (for 0.0.0.0 at 2011-01-13 13:20:36) [GET]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"edit", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering sources/edit
2011-01-13 13:20:36 - DEBUG:   [4;35;1mGroup Load (0.2ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (7.8ms)
2011-01-13 13:20:36 - INFO: Completed in 12ms (View: 10, DB: 46) | 200 OK [http://test.host/sources/365262434/edit]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#index (for 0.0.0.0 at 2011-01-13 13:20:36) [GET]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"index", "controller"=>"sources"}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering sources/index
2011-01-13 13:20:36 - DEBUG:   [4;35;1mGroup Load (0.0ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:20:36 - INFO: Completed in 12ms (View: 6, DB: 1) | 200 OK [http://test.host/sources]
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#new (for 0.0.0.0 at 2011-01-13 13:20:36) [GET]
2011-01-13 13:20:36 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"new", "controller"=>"sources"}
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering sources/new
2011-01-13 13:20:36 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (3.6ms)
2011-01-13 13:20:36 - INFO: Completed in 7ms (View: 6, DB: 0) | 200 OK [http://test.host/sources/new?class=UnconfiguredSource]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#show (for 0.0.0.0 at 2011-01-13 13:20:36) [GET]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"show", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) AND (`retrievals`.source_id = 365262434) ORDER BY (citations_count + other_citations_count) desc LIMIT 5[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering sources/show
2011-01-13 13:20:36 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:20:36 - INFO: Completed in 57ms (View: 54, DB: 1) | 200 OK [http://test.host/sources/365262434]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:20:36 - INFO: 

Processing SourcesController#update (for 0.0.0.0 at 2011-01-13 13:20:36) [PUT]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"update", "id"=>"365262434", "controller"=>"sources", "source"=>{"class"=>"CrossRef"}}
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mCrossRef Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Redirected to http://test.host/sources
2011-01-13 13:20:36 - INFO: Completed in 4ms (DB: 1) | 302 Found [http://test.host/sources/365262434?source%5Bclass%5D=CrossRef]
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:36', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Create (0.1ms)[0m   [0mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', 'fbf6ee8a6a88fca3675c144a5fbf7c80bd6b027e', '2011-01-13 21:20:36', 'ab8da0c48aebd7ee6994cdf24dcb0c10c559f10e', NULL, '2011-01-13 21:20:36', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Redirected to http://test.host/
2011-01-13 13:20:36 - INFO: Completed in 8ms (DB: 1) | 302 Found [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (45.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>nil}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:36', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering users/new
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: Completed in 15ms (View: 9, DB: 47) | 200 OK [http://test.host/register?user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (44.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>nil, "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:36', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering users/new
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: Completed in 13ms (View: 8, DB: 46) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (47.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:36', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering users/new
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: Completed in 10ms (View: 5, DB: 49) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (42.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:20:36) [POST]
2011-01-13 13:20:36 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:20:36', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:20:36 - INFO: Rendering template within layouts/application
2011-01-13 13:20:36 - INFO: Rendering users/new
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - INFO: Completed in 25ms (View: 11, DB: 45) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:20:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:20:36 - DEBUG:   [4;36;1mSQL (41.0ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.1/foo', NULL, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mConnotea Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844140, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mCrossRef Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844140, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (53.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Update (0.4ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:06', `retrieved_at` = '2011-01-13 21:27:06' WHERE `id` = 562580130[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:06', `retrieved_at` = '2011-01-13 21:27:06' WHERE `id` = 721439208[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:06', `retrieved_at` = '2011-01-13 21:27:06' WHERE `id` = 1040397643[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:06', `retrieved_at` = '2009-01-13 21:28:06' WHERE `id` = 721439208[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (46.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.8ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844141, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844141, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (47.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844142, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844142, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (44.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 21:28:06' [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 21:28:05' [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (45.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.1/foo', '2011-01-12 21:28:06', 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.7ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844143, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844143, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (43.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.1/foo', '2011-01-12 21:28:06', 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844144, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844144, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 21:28:06' [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.8ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (43.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:06', '10.1/foo', NULL, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844145, NULL, 12978895, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 959844145, NULL, 365262434, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:06', `published_on` = '2011-01-12 21:28:06' WHERE `id` = 959844145[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.8ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (51.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:06', 1, NULL, 1, 0)[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (46.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:28:06 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:06', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 13:28:07 - DEBUG:   [4;35;1mSQL (51.7ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:07 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:28:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 13:28:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:07 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:07', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mInterrupt: : COMMIT[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:08', '10.0/citable', NULL, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:08', 959844146, NULL, 12978895, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Create (3.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:08', 959844146, NULL, 365262434, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 21:28:08', NULL, '2011-01-13 21:28:08', 1040397658)[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:28:08 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:08 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:08', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:08 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:08 - INFO: Got 1 citation details.
2011-01-13 13:28:08 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:08 - DEBUG: Existing citation count: 1
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG: After existing citations uniquified: 1
2011-01-13 13:28:08 - INFO: Creating citation uri
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 21:28:08', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 21:28:08', 1040397658)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG: Citation count: 2
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:08', `retrieved_at` = '2011-01-13 21:28:08' WHERE `id` = 1040397658[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:08', 1, '2011-01-13 21:28:08', 2011, 1040397658, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 21:28:08', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 13:28:08 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:08', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:08', `retrieved_at` = '2011-01-13 21:28:08' WHERE `id` = 959844146[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - INFO: Refreshed article 10.0/citable
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (93.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:08', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:08', 959844147, NULL, 12978895, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:08', 959844147, NULL, 365262434, 0)[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:28:08 - INFO: Skipping: article not published yet
2011-01-13 13:28:08 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (47.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:08 - DEBUG: Updating 2 stale articles
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:08 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:08 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:08', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:08 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:08 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:08 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:08 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:08 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:08 - DEBUG: Request headers:
2011-01-13 13:28:08 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:08 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:08 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:09 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:28:09 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:09', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (132.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mCrossRef Update (94.3ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 21:28:09', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:09 - DEBUG: Updating 2 stale articles
2011-01-13 13:28:09 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:09 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:09 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:09', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:09 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:09 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:09 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:09 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:09 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:09 - DEBUG: Request headers:
2011-01-13 13:28:09 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:09 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:09 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:11 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:09", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:28:11 - DEBUG: Response headers:
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - INFO: Got 0 citation details.
2011-01-13 13:28:11 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:11 - DEBUG: Existing citation count: 0
2011-01-13 13:28:11 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:28:11 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:28:11 - DEBUG: Citation count: 0
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:11', `retrieved_at` = '2011-01-13 21:28:11' WHERE `id` = 124229983[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:11', 1, '2011-01-13 21:28:11', 2011, 124229983, 0)[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 13:28:11 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:11', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:11 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:11', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:11 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:09", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:11', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:11', `retrieved_at` = '2011-01-13 21:28:11' WHERE `id` = 959844139[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:28:11 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 13:28:11 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:11 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:11', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 13:28:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:11 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:11 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:11 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:11 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 13:28:11 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 13:28:11 - DEBUG: Request headers:
2011-01-13 13:28:11 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:11 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:11 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:13 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:11", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:28:13 - DEBUG: Response headers:
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - INFO: Got 0 citation details.
2011-01-13 13:28:13 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:13 - DEBUG: Existing citation count: 0
2011-01-13 13:28:13 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:28:13 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:28:13 - DEBUG: Citation count: 0
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:13', `retrieved_at` = '2011-01-13 21:28:13' WHERE `id` = 868470324[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mHistory Create (4.7ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:13', 1, '2011-01-13 21:28:13', 2011, 868470324, 0)[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 13:28:13 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:13', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:13 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:13', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 13:28:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:13 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:13 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:09", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:13 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:13 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:28:13 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 13:28:13 - DEBUG: Request headers:
2011-01-13 13:28:13 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:13 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:14 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:13", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 13:28:14 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:28:14', `disable_until` = '2011-01-13 21:28:24' WHERE `id` = 365262434[0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:14', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 13:28:14 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 13:28:14 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (55.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:14 - DEBUG: Updating 1 stale article
2011-01-13 13:28:14 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:14 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:14 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:14', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:14 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:14 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:14 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:08", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:14 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:14 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:14 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:14 - DEBUG: Request headers:
2011-01-13 13:28:14 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:14 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:14 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:15 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:08", updated_at: "2011-01-13 21:28:14", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:28:15 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:28:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:15', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:15 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:28:15 - DEBUG:   [4;36;1mSQL (130.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:28:15', 0, '2011-01-13 21:28:15', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:28:15 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 13:28:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (45.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 21:28:16' WHERE `id` = 12978895[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:16 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 13:28:16 - INFO: Sent mail to alm@alm.example.org
2011-01-13 13:28:16 - DEBUG: 
Date: Thu, 13 Jan 2011 13:28:16 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 21:28:16', `disable_until` = '2011-01-15 21:28:16' WHERE `id` = 12978895[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (40.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 21:28:16' WHERE `id` = 12978895[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:16 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 21:28:16', `disable_until` = '2011-01-13 21:28:20' WHERE `id` = 12978895[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - INFO: Connotea is disabled until 2011-01-13 13:28:20 -0800. Skipping.
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:16 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:18 - DEBUG:   [4;36;1mSQL (73.5ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:32', '10.1/foo', NULL, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mConnotea Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:32', 959844140, NULL, 12978895, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mCrossRef Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:32', 959844140, NULL, 365262434, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (45.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:32', `retrieved_at` = '2011-01-13 21:27:32' WHERE `id` = 562580130[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:32', `retrieved_at` = '2011-01-13 21:27:32' WHERE `id` = 721439208[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:32', `retrieved_at` = '2011-01-13 21:27:32' WHERE `id` = 1040397643[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:32', `retrieved_at` = '2009-01-13 21:28:32' WHERE `id` = 721439208[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (47.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:32', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:32', 959844141, NULL, 12978895, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:32', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:32', 959844141, NULL, 365262434, 0)[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:32 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (47.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:33', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844142, NULL, 12978895, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844142, NULL, 365262434, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (44.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSource Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 21:28:33' [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 21:28:32' [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (62.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:33', '10.1/foo', '2011-01-12 21:28:33', 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844143, NULL, 12978895, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844143, NULL, 365262434, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (44.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:33', '10.1/foo', '2011-01-12 21:28:33', 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844144, NULL, 12978895, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844144, NULL, 365262434, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 21:28:33' [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Load (0.6ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (43.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:33', '10.1/foo', NULL, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844145, NULL, 12978895, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 959844145, NULL, 365262434, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:33', `published_on` = '2011-01-12 21:28:33' WHERE `id` = 959844145[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Load (0.6ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (44.3ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:33', 1, NULL, 1, 0)[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (47.4ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:28:33 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:33', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 13:28:33 - DEBUG:   [4;35;1mSQL (45.7ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:34', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (43.6ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mCOMMIT[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:34', '10.0/citable', NULL, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:34', 959844146, NULL, 12978895, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:34', 959844146, NULL, 365262434, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mCitation Create (0.1ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 21:28:34', NULL, '2011-01-13 21:28:34', 1040397658)[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:28:34 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:34 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:34', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:34 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:34 - INFO: Got 1 citation details.
2011-01-13 13:28:34 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:34 - DEBUG: Existing citation count: 1
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG: After existing citations uniquified: 1
2011-01-13 13:28:34 - INFO: Creating citation uri
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 21:28:34', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 21:28:34', 1040397658)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG: Citation count: 2
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:34', `retrieved_at` = '2011-01-13 21:28:34' WHERE `id` = 1040397658[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:34', 1, '2011-01-13 21:28:34', 2011, 1040397658, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 21:28:34', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 13:28:34 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:34', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:34', `retrieved_at` = '2011-01-13 21:28:34' WHERE `id` = 959844146[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - INFO: Refreshed article 10.0/citable
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (46.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:34', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:34', 959844147, NULL, 12978895, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:34', 959844147, NULL, 365262434, 0)[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:28:34 - INFO: Skipping: article not published yet
2011-01-13 13:28:34 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (51.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:34 - DEBUG: Updating 2 stale articles
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:34 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:34 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:34', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:34 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:34 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:34 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:34 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:34 - DEBUG: Request headers:
2011-01-13 13:28:34 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:34 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:35 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:28:35 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:35', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (51.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 21:28:35', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:28:35 - DEBUG: Updating 2 stale articles
2011-01-13 13:28:35 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:35 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:35 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:35 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:35', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:36 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:36 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:36 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:36 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:36 - DEBUG: Request headers:
2011-01-13 13:28:36 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:36 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:36 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:38 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:35", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:28:38 - DEBUG: Response headers:
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - INFO: Got 0 citation details.
2011-01-13 13:28:38 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:38 - DEBUG: Existing citation count: 0
2011-01-13 13:28:38 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:28:38 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:28:38 - DEBUG: Citation count: 0
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:38', `retrieved_at` = '2011-01-13 21:28:38' WHERE `id` = 124229983[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mHistory Load (0.4ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:38', 1, '2011-01-13 21:28:38', 2011, 124229983, 0)[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 13:28:38 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:38', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:38 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:38', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:38 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:35", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:38', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:28:38', `retrieved_at` = '2011-01-13 21:28:38' WHERE `id` = 959844139[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:28:38 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 13:28:38 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:38 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:38', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 13:28:38 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:38 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:38 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:38 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:38 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 13:28:38 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 13:28:38 - DEBUG: Request headers:
2011-01-13 13:28:38 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:38 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:38 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:40 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:38", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:28:40 - DEBUG: Response headers:
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - INFO: Got 0 citation details.
2011-01-13 13:28:40 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:28:40 - DEBUG: Existing citation count: 0
2011-01-13 13:28:40 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:28:40 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:28:40 - DEBUG: Citation count: 0
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:40', `retrieved_at` = '2011-01-13 21:28:40' WHERE `id` = 868470324[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:28:40', 1, '2011-01-13 21:28:40', 2011, 868470324, 0)[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 13:28:40 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:40', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:40 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:40', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 13:28:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:40 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:40 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:35", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:40 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:40 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:28:40 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 13:28:40 - DEBUG: Request headers:
2011-01-13 13:28:40 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:40 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:41 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:40", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 13:28:41 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:28:41', `disable_until` = '2011-01-13 21:28:51' WHERE `id` = 365262434[0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:41', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 13:28:41 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 13:28:41 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (52.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:41 - DEBUG: Updating 1 stale article
2011-01-13 13:28:41 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:41 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:41 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:41', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:41 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:41 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:34", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:41 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:41 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:41 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:41 - DEBUG: Request headers:
2011-01-13 13:28:41 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:41 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:41 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:28:42 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:34", updated_at: "2011-01-13 21:28:41", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:28:42 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:42', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (52.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Create (0.2ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:28:42', 0, '2011-01-13 21:28:42', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (53.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mConnotea Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 21:28:42' WHERE `id` = 12978895[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:42 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 13:28:42 - INFO: Sent mail to alm@alm.example.org
2011-01-13 13:28:42 - DEBUG: 
Date: Thu, 13 Jan 2011 13:28:42 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mConnotea Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 21:28:42', `disable_until` = '2011-01-15 21:28:42' WHERE `id` = 12978895[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (54.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 21:28:42' WHERE `id` = 12978895[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:42 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 21:28:42', `disable_until` = '2011-01-13 21:28:46' WHERE `id` = 12978895[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - INFO: Connotea is disabled until 2011-01-13 13:28:46 -0800. Skipping.
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:42 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 21:28:46', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (51.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Create (0.1ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', 'f9a36dec896c5d4eb5dfabc10fc78af424f2b4aa', '2011-01-13 21:28:46', '39e8457ff83a70d6fd9b89670fcea87ed1282c69', NULL, '2011-01-13 21:28:46', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (47.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (49.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = '2011-01-27 21:28:46', `remember_token` = '15ee51265d129e4af97c1afb8dd4abf66312a5c1' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (43.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = '2011-01-20 21:28:46', `remember_token` = 'ec2320db9b2a1cb72e62b8dedae82d34b820f76d' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (40.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = '2011-01-20 21:28:46', `remember_token` = 'd37cbc58f6fefa91257204021d5b5175cc0cad61' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (42.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (43.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = '2011-01-27 21:28:46', `remember_token` = 'bdfda926c03dfcca4250b1a0b5cca8d0bd1e2657' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (45.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = '2011-01-27 21:28:46', `remember_token` = '5fcaa6bd2b410a323905f3c260190a7a74896fde' WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:28:46 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:28:46', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:28:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:47 - DEBUG:   [4;36;1mSQL (41.4ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:28:48) [POST]
2011-01-13 13:28:48 - INFO:   Parameters: {"article"=>{"doi"=>"10.0/dummy"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:28:48 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:28:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:28:48', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mConnotea Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:48', 959844148, NULL, 12978895, 0)[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mCrossRef Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:28:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:28:48', 959844148, NULL, 365262434, 0)[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:28:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0%2Fdummy
2011-01-13 13:28:48 - INFO: Completed in 47ms (DB: 78) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.0%2Fdummy]
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mSQL (49.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:48 - INFO: 

Processing ArticlesController#destroy (for 0.0.0.0 at 2011-01-13 13:28:48) [DELETE]
2011-01-13 13:28:48 - INFO:   Parameters: {"action"=>"destroy", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:28:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 124229983) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 124229983[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mArticle Destroy (0.2ms)[0m   [0;1mDELETE FROM `articles` WHERE `id` = 959844139[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:48 - INFO: Redirected to http://test.host/articles
2011-01-13 13:28:48 - INFO: Completed in 18ms (DB: 54) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mSQL (45.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:48 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:28:48) [GET]
2011-01-13 13:28:48 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles", "query"=>"pgen"}
2011-01-13 13:28:48 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (doi like '%pgen%') ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:28:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:28:48 - INFO: Rendering articles/index
2011-01-13 13:28:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:28:48 - INFO: Completed in 5ms (View: 3, DB: 46) | 200 OK [http://test.host/articles.csv?query=pgen]
2011-01-13 13:28:49 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:49 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:28:49) [GET]
2011-01-13 13:28:49 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:28:49 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:49 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:db7366316e20d0f786b933c2be96e501", :article_id=>959844139}
2011-01-13 13:28:49 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:28:49 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:49 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:28:49', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:28:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:28:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:28:49 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:28:49 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:28:49 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:28:49 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:28:49 - DEBUG: Request headers:
2011-01-13 13:28:49 - DEBUG: [accept] = '*/*'
2011-01-13 13:28:49 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:28:49 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:29:06 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:49", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:29:06 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:29:06', `disable_until` = '2011-01-13 21:29:16' WHERE `id` = 12978895[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:29:06 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_json_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:29:06 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:06', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:06 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:06', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:06 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:06', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:29:06 - INFO: RetrievalWorker done.
2011-01-13 13:29:06 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:db7366316e20d0f786b933c2be96e501
2011-01-13 13:29:06 - INFO: Completed in 17791ms (View: 0, DB: 8) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json]
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSQL (74.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:06 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:29:06) [GET]
2011-01-13 13:29:06 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:29:06 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:06 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:b2060dce8f1d96d9cc01f1b912bd5dad", :article_id=>959844139}
2011-01-13 13:29:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:06 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:06 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:06', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:29:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:06 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:06 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:06 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:29:06 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:29:06 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:29:06 - DEBUG: Request headers:
2011-01-13 13:29:06 - DEBUG: [accept] = '*/*'
2011-01-13 13:29:06 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:29:06 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:29:28 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:29:06", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 13:29:28 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:29:28', `disable_until` = '2011-01-13 21:29:38' WHERE `id` = 12978895[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 13:29:28 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 13:29:28 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:28', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:28 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:29:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:28', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:28 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:28', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:29:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:28 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:29:28 - INFO: RetrievalWorker done.
2011-01-13 13:29:28 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:b2060dce8f1d96d9cc01f1b912bd5dad
2011-01-13 13:29:28 - INFO: Completed in 22093ms (View: 0, DB: 83) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c]
2011-01-13 13:29:29 - DEBUG:   [4;36;1mSQL (58.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:29 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:29:29) [GET]
2011-01-13 13:29:29 - INFO:   Parameters: {"format"=>"json", "citations"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:29:29 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mCitation Load (0.2ms)[0m   [0mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:29 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:01af2496dc4d02e08271ff2356b62629", :article_id=>959844139}
2011-01-13 13:29:29 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:29 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:29:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:29 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:29:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:29', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:29:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:29 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:29 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:29:29 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:29:29 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:29:29 - DEBUG: Request headers:
2011-01-13 13:29:29 - DEBUG: [accept] = '*/*'
2011-01-13 13:29:29 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:29:29 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:29:59 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:29:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 13:29:59 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:29:59', `disable_until` = '2011-01-13 21:30:09' WHERE `id` = 12978895[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:59', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:59 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:59', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:29:59 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:59', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:29:59 - INFO: RetrievalWorker done.
2011-01-13 13:29:59 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:01af2496dc4d02e08271ff2356b62629
2011-01-13 13:29:59 - INFO: Completed in 30095ms (View: 0, DB: 66) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&citations=1]
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSQL (78.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:59 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:29:59) [GET]
2011-01-13 13:29:59 - INFO:   Parameters: {"format"=>"json", "history"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:29:59 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSource Load (0.5ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:59 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:702dd31712e49b5199b40c6a1b5e887c", :article_id=>959844139}
2011-01-13 13:29:59 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:29:59 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:59 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:29:59', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:29:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:29:59 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:29:59 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:29:59 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:29:59 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:29:59 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:29:59 - DEBUG: Request headers:
2011-01-13 13:29:59 - DEBUG: [accept] = '*/*'
2011-01-13 13:29:59 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:29:59 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:30:29 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:29:59", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 13:30:29 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:30:29', `disable_until` = '2011-01-13 21:30:39' WHERE `id` = 12978895[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:29', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:29 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:29', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:29 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:29', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:30:29 - INFO: RetrievalWorker done.
2011-01-13 13:30:29 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:702dd31712e49b5199b40c6a1b5e887c
2011-01-13 13:30:29 - INFO: Completed in 30054ms (View: 0, DB: 88) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&history=1]
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSQL (68.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:29 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:30:29) [GET]
2011-01-13 13:30:29 - INFO:   Parameters: {"format"=>"xml", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:30:29 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:29 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:af1894c9973152404df6aa47ea729681", :article_id=>959844139}
2011-01-13 13:30:29 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:29 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:29 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:29', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:30:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:29 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:29 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:30:29 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:30:29 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:30:29 - DEBUG: Request headers:
2011-01-13 13:30:29 - DEBUG: [accept] = '*/*'
2011-01-13 13:30:29 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:30:29 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:30:59 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:30:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 13:30:59 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:30:59', `disable_until` = '2011-01-13 21:31:09' WHERE `id` = 12978895[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 13:30:59 - INFO: RetrievalWorker done.
2011-01-13 13:30:59 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:af1894c9973152404df6aa47ea729681
2011-01-13 13:30:59 - INFO: Completed in 30068ms (View: 0, DB: 79) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml]
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (50.3ms)[0m   [0mROLLBACK[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:59 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:30:59) [GET]
2011-01-13 13:30:59 - INFO:   Parameters: {"format"=>"xml", "citations"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:30:59 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:c630593a02f1bcfdf85ba5948e0aeba1", :article_id=>959844139}
2011-01-13 13:30:59 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:59 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:59 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:30:59 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:30:59 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:30:59 - DEBUG: Request headers:
2011-01-13 13:30:59 - DEBUG: [accept] = '*/*'
2011-01-13 13:30:59 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:30:59 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:30:59 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:30:59", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:30:59 - DEBUG: Response headers:
2011-01-13 13:30:59 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:30:59 - DEBUG: [connection] = 'close']
2011-01-13 13:30:59 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Got 0 citation details.
2011-01-13 13:30:59 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:30:59 - DEBUG: Existing citation count: 0
2011-01-13 13:30:59 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:30:59 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:30:59 - DEBUG: Citation count: 0
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `retrieved_at` = '2011-01-13 21:30:59' WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:30:59', 1, '2011-01-13 21:30:59', 2011, 124229983, 0)[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Saved history[980190966: 2011, 1] = 0
2011-01-13 13:30:59 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:30:59', `retrieved_at` = '2011-01-13 21:30:59' WHERE `id` = 959844139[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:30:59 - INFO: RetrievalWorker done.
2011-01-13 13:30:59 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:c630593a02f1bcfdf85ba5948e0aeba1
2011-01-13 13:30:59 - INFO: Completed in 232ms (View: 0, DB: 61) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?citations=1]
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (53.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:59 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:30:59) [GET]
2011-01-13 13:30:59 - INFO:   Parameters: {"format"=>"xml", "history"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:30:59 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:2b2f4ce062df6e93db117da5ec7aa9de", :article_id=>959844139}
2011-01-13 13:30:59 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:30:59 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:30:59 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:59 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:30:59 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:30:59 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:30:59 - DEBUG: Request headers:
2011-01-13 13:30:59 - DEBUG: [accept] = '*/*'
2011-01-13 13:30:59 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:30:59 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:30:59 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:30:59", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:30:59 - DEBUG: Response headers:
2011-01-13 13:30:59 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:30:59 - DEBUG: [connection] = 'close']
2011-01-13 13:30:59 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Got 0 citation details.
2011-01-13 13:30:59 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:30:59 - DEBUG: Existing citation count: 0
2011-01-13 13:30:59 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:30:59 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:30:59 - DEBUG: Citation count: 0
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `retrieved_at` = '2011-01-13 21:30:59' WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:30:59', 1, '2011-01-13 21:30:59', 2011, 124229983, 0)[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Saved history[980190967: 2011, 1] = 0
2011-01-13 13:30:59 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:30:59 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:30:59', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:30:59 - DEBUG:   [4;35;1mArticle Update (0.1ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:30:59', `retrieved_at` = '2011-01-13 21:30:59' WHERE `id` = 959844139[0m
2011-01-13 13:30:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:30:59 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:30:59 - INFO: RetrievalWorker done.
2011-01-13 13:30:59 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:2b2f4ce062df6e93db117da5ec7aa9de
2011-01-13 13:30:59 - INFO: Completed in 214ms (View: 0, DB: 61) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?history=1]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (43.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#edit (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"action"=>"edit", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:00 - INFO: Rendering template within layouts/application
2011-01-13 13:31:00 - INFO: Rendering articles/edit
Rendered articles/_form (6.0ms)
2011-01-13 13:31:00 - INFO: Completed in 16ms (View: 14, DB: 44) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005/edit]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"action"=>"index", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:31:00 - INFO: Rendering template within layouts/application
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:00 - INFO: Completed in 10ms (View: 7, DB: 1) | 200 OK [http://test.host/articles]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#new (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"action"=>"new", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:00 - INFO: Rendering template within layouts/application
2011-01-13 13:31:00 - INFO: Rendering articles/new
Rendered articles/_form (4.4ms)
2011-01-13 13:31:00 - INFO: Completed in 7ms (View: 7, DB: 0) | 200 OK [http://test.host/articles/new]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"1", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) AND `articles`.id IN (959844139, 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 6ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?cited=1]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load Including Associations (0.2ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"0", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) AND `articles`.id IN (819830547) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 50ms (View: 47, DB: 1) | 200 OK [http://test.host/articles.csv?cited=0]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 9ms (View: 5, DB: 2) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 4ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "order"=>"published_on", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY published_on LIMIT 0, 30[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (562580130,959844139,819830547)) [0m
2011-01-13 13:31:00 - INFO: Rendering articles/index
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:00 - INFO: Completed in 5ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?order=published_on]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:00) [POST]
2011-01-13 13:31:00 - INFO:   Parameters: {"article"=>{}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Rendering template within layouts/application
2011-01-13 13:31:00 - INFO: Rendering articles/new
Rendered articles/_form (6.9ms)
2011-01-13 13:31:00 - INFO: Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/articles?]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#show (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:0fb86b8a682bf76cea1b961a42572662", :article_id=>959844139}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:00 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:00 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:31:00 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:31:00 - DEBUG: Request headers:
2011-01-13 13:31:00 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:00 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:00 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:00 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:00", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:00 - DEBUG: Response headers:
2011-01-13 13:31:00 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:31:00 - DEBUG: [connection] = 'close']
2011-01-13 13:31:00 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Got 0 citation details.
2011-01-13 13:31:00 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:00 - DEBUG: Existing citation count: 0
2011-01-13 13:31:00 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:00 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:00 - DEBUG: Citation count: 0
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (6.8ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `retrieved_at` = '2011-01-13 21:31:00' WHERE `id` = 124229983[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:00', 1, '2011-01-13 21:31:00', 2011, 124229983, 0)[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Saved history[980190968: 2011, 1] = 0
2011-01-13 13:31:00 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:00 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:00 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Update (0.1ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:31:00', `retrieved_at` = '2011-01-13 21:31:00' WHERE `id` = 959844139[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:31:00 - INFO: RetrievalWorker done.
2011-01-13 13:31:00 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:0fb86b8a682bf76cea1b961a42572662
2011-01-13 13:31:00 - INFO: Rendering template within layouts/application
2011-01-13 13:31:00 - INFO: Rendering articles/show
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:31:00 - INFO: Completed in 213ms (View: 7, DB: 14) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (79.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:31:00) [GET]
2011-01-13 13:31:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles"}
2011-01-13 13:31:00 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:9efb6bd0baf1ed133d59d21202fa11d9", :article_id=>562580130}
2011-01-13 13:31:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:00 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:00 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:00 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:00 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:31:00 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:00 - DEBUG: Request headers:
2011-01-13 13:31:00 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:00 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:00 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:00 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:00", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:00 - DEBUG: Response headers:
2011-01-13 13:31:00 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:31:00 - DEBUG: [connection] = 'close']
2011-01-13 13:31:00 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Got 0 citation details.
2011-01-13 13:31:00 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:00 - DEBUG: Existing citation count: 1
2011-01-13 13:31:00 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:00 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:00 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:00 - DEBUG: Citation count: 0
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `retrieved_at` = '2011-01-13 21:31:00' WHERE `id` = 721439208[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mHistory Load (0.4ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:00', 1, '2011-01-13 21:31:00', 2011, 721439208, 0)[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Saved history[980190969: 2011, 1] = 0
2011-01-13 13:31:00 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:00 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:00 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:00 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:00 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:31:00 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:00 - DEBUG: Request headers:
2011-01-13 13:31:00 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:00 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:00 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:00", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:31:00 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:31:00', `disable_until` = '2011-01-13 21:31:10' WHERE `id` = 365262434[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:31:00 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:31:00 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:00', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:00 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:31:00 - INFO: RetrievalWorker done.
2011-01-13 13:31:00 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:9efb6bd0baf1ed133d59d21202fa11d9
2011-01-13 13:31:00 - INFO: Rendering articles/show
2011-01-13 13:31:00 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:31:00 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:31:00 - INFO: Completed in 429ms (View: 7, DB: 92) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv]
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (50.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:31:01) [GET]
2011-01-13 13:31:01 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"connotea"}
2011-01-13 13:31:01 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mArticle Load Including Associations (0.4ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:76ae153f32311dccfc90dfcd55d3ef1c", :article_id=>562580130}
2011-01-13 13:31:01 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:01 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:01 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:31:01 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:01 - DEBUG: Request headers:
2011-01-13 13:31:01 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:01 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:01 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:01 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:01", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:01 - DEBUG: Response headers:
2011-01-13 13:31:01 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:31:01 - DEBUG: [connection] = 'close']
2011-01-13 13:31:01 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Got 0 citation details.
2011-01-13 13:31:01 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:01 - DEBUG: Existing citation count: 1
2011-01-13 13:31:01 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:01 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:01 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:01 - DEBUG: Citation count: 0
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval UPDATE (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `retrieved_at` = '2011-01-13 21:31:01' WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mHistory Load (0.4ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:01', 1, '2011-01-13 21:31:01', 2011, 721439208, 0)[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Saved history[980190970: 2011, 1] = 0
2011-01-13 13:31:01 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:01 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:01 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:01 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:01 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:31:01 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:01 - DEBUG: Request headers:
2011-01-13 13:31:01 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:01 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:01 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:01", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:31:01 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:31:01', `disable_until` = '2011-01-13 21:31:11' WHERE `id` = 365262434[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:31:01 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:31:01 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:31:01 - INFO: RetrievalWorker done.
2011-01-13 13:31:01 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:76ae153f32311dccfc90dfcd55d3ef1c
2011-01-13 13:31:01 - INFO: Rendering articles/show
2011-01-13 13:31:01 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:31:01 - INFO: Completed in 410ms (View: 4, DB: 63) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=connotea]
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (61.3ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:31:01) [GET]
2011-01-13 13:31:01 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"crossref"}
2011-01-13 13:31:01 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:d393076ac0fe1a0bba04fb8b539a85b3", :article_id=>562580130}
2011-01-13 13:31:01 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:01 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:01 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:01 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:01 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:31:01 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:01 - DEBUG: Request headers:
2011-01-13 13:31:01 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:01 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:01 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:01 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:01", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:01 - DEBUG: Response headers:
2011-01-13 13:31:01 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:31:01 - DEBUG: [connection] = 'close']
2011-01-13 13:31:01 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Got 0 citation details.
2011-01-13 13:31:01 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:01 - DEBUG: Existing citation count: 1
2011-01-13 13:31:01 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:01 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:01 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:01 - DEBUG: Citation count: 0
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval UPDATE (0.3ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `retrieved_at` = '2011-01-13 21:31:01' WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mHistory Load (0.4ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mHistory Create (0.3ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:01', 1, '2011-01-13 21:31:01', 2011, 721439208, 0)[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Saved history[980190971: 2011, 1] = 0
2011-01-13 13:31:01 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:01 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:01 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:01 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:31:01 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:31:01 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:31:01 - DEBUG: Request headers:
2011-01-13 13:31:01 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:01 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:01 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:31:01", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:31:01 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mCrossRef Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:31:01', `disable_until` = '2011-01-13 21:31:11' WHERE `id` = 365262434[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:31:01 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:31:01 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:28:48", updated_at: "2011-01-13 21:28:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:01', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:31:01 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:01 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:31:01 - INFO: RetrievalWorker done.
2011-01-13 13:31:01 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:d393076ac0fe1a0bba04fb8b539a85b3
2011-01-13 13:31:01 - INFO: Rendering articles/show
2011-01-13 13:31:01 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:31:01 - INFO: Completed in 410ms (View: 4, DB: 74) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=crossref]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (43.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#update (for 0.0.0.0 at 2011-01-13 13:31:02) [PUT]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{}, "action"=>"update", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1371%2Fjournal.pbio.0000005
2011-01-13 13:31:02 - INFO: Completed in 10ms (DB: 45) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005?]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{"doi"=>"10.1000/182"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1000/182') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:02', '10.1000/182', NULL, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844149, NULL, 12978895, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844149, NULL, 365262434, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1000%2F182
2011-01-13 13:31:02 - INFO: Completed in 27ms (DB: 4) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{"doi"=>"10.0092/ooh"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0092/ooh') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:02', '10.0092/ooh', NULL, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844150, NULL, 12978895, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844150, NULL, 365262434, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0092%2Fooh
2011-01-13 13:31:02 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{"doi"=>"10.10/♥"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.10/♥') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:02', '10.10/♥', NULL, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844151, NULL, 12978895, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844151, NULL, 365262434, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F10.10%2F%E2%99%A5
2011-01-13 13:31:02 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{"doi"=>"1.0/1337"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '1.0/1337') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:02', '1.0/1337', NULL, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844152, NULL, 12978895, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844152, NULL, 365262434, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F1.0%2F1337
2011-01-13 13:31:02 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:31:02 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"article"=>{"doi"=>"10.9898098098098/นก"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.9898098098098/นก') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:02', '10.9898098098098/นก', NULL, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844153, NULL, 12978895, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:02', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:02', 959844153, NULL, 365262434, 0)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/articles/info:doi%2F10.9898098098098%2F%E0%B8%99%E0%B8%81
2011-01-13 13:31:02 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (54.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing DocsController#index (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"index", "controller"=>"docs"}
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/docs/install
2011-01-13 13:31:02 - INFO: Completed in 5ms (DB: 55) | 302 Found [http://test.host/docs]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing DocsController#install (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"install", "controller"=>"docs"}
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering docs/index
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: Completed in 6ms (View: 6, DB: 0) | 200 OK [http://test.host/docs/install]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: 

Processing GroupsController#groupArticleSummaries (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:31:02 - DEBUG: groupArticleSummaries
2011-01-13 13:31:02 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load Including Associations (0.4ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering groups/groupArticleSummaries
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: Completed in 9ms (View: 3, DB: 1) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:31:02 - DEBUG: groupArticleSummaries
2011-01-13 13:31:02 - INFO: format:application/json
2011-01-13 13:31:02 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: Completed in 5ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=json]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "callback"=>"foo", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:31:02 - DEBUG: groupArticleSummaries
2011-01-13 13:31:02 - INFO: format:application/json
2011-01-13 13:31:02 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: Completed in 5ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?callback=foo&format=json]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: 

Processing GroupsController#groupArticleSummaries to xml (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"format"=>"xml", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:31:02 - DEBUG: groupArticleSummaries
2011-01-13 13:31:02 - INFO: format:application/xml
2011-01-13 13:31:02 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: Completed in 7ms (View: 3, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=xml]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/logout]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = '2011-01-27 21:31:02', `remember_token` = '22667480a725a6353b98bfda09b5783a28c7cf07' WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sessions/new
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: Completed in 5ms (View: 4, DB: 1) | 200 OK [http://test.host/login]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (48.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = '2011-01-27 21:31:02', `remember_token` = '4950d9ce74797caff611f3b413ce803fb7f54eaa' WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = '2011-01-13 21:26:02' WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '4950d9ce74797caff611f3b413ce803fb7f54eaa') LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sessions/new
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '4950d9ce74797caff611f3b413ce803fb7f54eaa') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: Completed in 6ms (View: 4, DB: 50) | 200 OK [http://test.host/login]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '4950d9ce74797caff611f3b413ce803fb7f54eaa') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (43.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:02 - WARN: Failed login for 'quentin' from 0.0.0.0 at 2011-01-13 13:31:02 -0800
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sessions/new
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: Completed in 4ms (View: 3, DB: 44) | 200 OK [http://test.host/session?login=quentin&password=bad+password]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/session?login=quentin&password=monkey]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (53.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = '2011-01-27 21:31:02', `remember_token` = '4cb145916ee9ca291f80283d211f6c6d7446b4b1' WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '4cb145916ee9ca291f80283d211f6c6d7446b4b1') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sessions/new
2011-01-13 13:31:02 - INFO: Completed in 11ms (View: 6, DB: 56) | 200 OK [http://test.host/login]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (43.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 1ms (DB: 44) | 302 Found [http://test.host/logout]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"remember_me"=>"0", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 6ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=0]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (45.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"remember_me"=>"1", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = '2011-01-27 21:31:02', `remember_token` = '0c49feed262a5e6e2abd023b26468b0af7577872' WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 3ms (DB: 46) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=1]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (43.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"create", "controller"=>"sources", "source"=>{}}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUnconfiguredSource Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUnconfiguredSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:31:02', 0, '2011-01-13 21:31:02', 30, NULL, NULL, 604800, NULL, 10, 'UnconfiguredSource', NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262436 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262436)[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/sources
2011-01-13 13:31:02 - INFO: Completed in 17ms (DB: 46) | 302 Found [http://test.host/sources?&class=UnconfiguredSource]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (48.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#destroy (for 0.0.0.0 at 2011-01-13 13:31:02) [DELETE]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"destroy", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 1040397643) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 1040397643[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 650162847) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 650162847) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mRetrieval Destroy (0.1ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 650162847[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mHistory Load (0.1ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Destroy (0.1ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mCrossRef Destroy (0.1ms)[0m   [0mDELETE FROM `sources` WHERE `id` = 365262434[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/sources
2011-01-13 13:31:02 - INFO: Completed in 10ms (DB: 51) | 302 Found [http://test.host/sources/365262434]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (50.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#edit (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"edit", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sources/edit
2011-01-13 13:31:02 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
Rendered sources/_form (9.5ms)
2011-01-13 13:31:02 - INFO: Completed in 14ms (View: 12, DB: 51) | 200 OK [http://test.host/sources/365262434/edit]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#index (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"index", "controller"=>"sources"}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sources/index
2011-01-13 13:31:02 - DEBUG:   [4;36;1mGroup Load (0.0ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:31:02 - INFO: Completed in 12ms (View: 6, DB: 1) | 200 OK [http://test.host/sources]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#new (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"new", "controller"=>"sources"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sources/new
2011-01-13 13:31:02 - DEBUG:   [4;36;1mGroup Load (0.0ms)[0m   [0;1mSELECT * FROM `groups` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
Rendered sources/_form (4.8ms)
2011-01-13 13:31:02 - INFO: Completed in 8ms (View: 7, DB: 0) | 200 OK [http://test.host/sources/new?class=UnconfiguredSource]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#show (for 0.0.0.0 at 2011-01-13 13:31:02) [GET]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"show", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) AND (`retrievals`.source_id = 365262434) ORDER BY (citations_count + other_citations_count) desc LIMIT 5[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering sources/show
2011-01-13 13:31:02 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:02 - INFO: Completed in 9ms (View: 6, DB: 1) | 200 OK [http://test.host/sources/365262434]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:02 - INFO: 

Processing SourcesController#update (for 0.0.0.0 at 2011-01-13 13:31:02) [PUT]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"update", "id"=>"365262434", "controller"=>"sources", "source"=>{"class"=>"CrossRef"}}
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mCrossRef Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/sources
2011-01-13 13:31:02 - INFO: Completed in 3ms (DB: 1) | 302 Found [http://test.host/sources/365262434?source%5Bclass%5D=CrossRef]
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Create (0.1ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '699b58db900f0f85dc76f8db943fa68e7f5a455f', '2011-01-13 21:31:02', 'f048368403a5160414fe7956dfbd42f5a9af14b4', NULL, '2011-01-13 21:31:02', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Redirected to http://test.host/
2011-01-13 13:31:02 - INFO: Completed in 8ms (DB: 1) | 302 Found [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (49.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:31:02) [POST]
2011-01-13 13:31:02 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>nil}}
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:02', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:31:02 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:02 - INFO: Rendering template within layouts/application
2011-01-13 13:31:02 - INFO: Rendering users/new
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: Completed in 26ms (View: 12, DB: 51) | 200 OK [http://test.host/register?user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (50.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:31:03) [POST]
2011-01-13 13:31:03 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>nil, "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:03', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - INFO: Rendering template within layouts/application
2011-01-13 13:31:03 - INFO: Rendering users/new
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: Completed in 15ms (View: 9, DB: 53) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (51.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:31:03) [POST]
2011-01-13 13:31:03 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:03', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - INFO: Rendering template within layouts/application
2011-01-13 13:31:03 - INFO: Rendering users/new
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: Completed in 25ms (View: 12, DB: 54) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=]
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (49.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:31:03) [POST]
2011-01-13 13:31:03 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:03', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:03 - INFO: Rendering template within layouts/application
2011-01-13 13:31:03 - INFO: Rendering users/new
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - INFO: Completed in 24ms (View: 11, DB: 51) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:31:03 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:03 - DEBUG:   [4;35;1mSQL (60.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load Including Associations (0.8ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.1/foo', NULL, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mConnotea Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844140, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mCrossRef Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844140, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (48.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:31:27', `retrieved_at` = '2011-01-13 21:30:27' WHERE `id` = 562580130[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:27', `retrieved_at` = '2011-01-13 21:30:27' WHERE `id` = 721439208[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:27', `retrieved_at` = '2011-01-13 21:30:27' WHERE `id` = 1040397643[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:27', `retrieved_at` = '2009-01-13 21:31:27' WHERE `id` = 721439208[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (47.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844141, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844141, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (47.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844142, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844142, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (47.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 21:31:27' [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 21:31:26' [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (45.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.1/foo', '2011-01-12 21:31:27', 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844143, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844143, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (44.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.1/foo', '2011-01-12 21:31:27', 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844144, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844144, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 21:31:27' [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (44.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:27', '10.1/foo', NULL, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844145, NULL, 12978895, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:27', 959844145, NULL, 365262434, 0)[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:31:27', `published_on` = '2011-01-12 21:31:27' WHERE `id` = 959844145[0m
2011-01-13 13:31:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:27 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (51.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:28', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:28', 1, NULL, 1, 0)[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (47.8ms)[0m   [0mCOMMIT[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:31:28 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:28', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 13:31:28 - DEBUG:   [4;35;1mSQL (52.5ms)[0m   [0mCOMMIT[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:29', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (51.7ms)[0m   [0mCOMMIT[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:29', '10.0/citable', NULL, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:29', 959844146, NULL, 12978895, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:29', 959844146, NULL, 365262434, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 21:31:29', NULL, '2011-01-13 21:31:29', 1040397658)[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:31:29 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:29 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:29', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:29 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:29 - INFO: Got 1 citation details.
2011-01-13 13:31:29 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:29 - DEBUG: Existing citation count: 1
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG: After existing citations uniquified: 1
2011-01-13 13:31:29 - INFO: Creating citation uri
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 21:31:29', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 21:31:29', 1040397658)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mCitation Destroy (0.3ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG: Citation count: 2
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:29', `retrieved_at` = '2011-01-13 21:31:29' WHERE `id` = 1040397658[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:29', 1, '2011-01-13 21:31:29', 2011, 1040397658, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 21:31:29', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 13:31:29 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:29', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:31:29', `retrieved_at` = '2011-01-13 21:31:29' WHERE `id` = 959844146[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - INFO: Refreshed article 10.0/citable
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (43.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:31:29', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:29', 959844147, NULL, 12978895, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:31:29', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:31:29', 959844147, NULL, 365262434, 0)[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:31:29 - INFO: Skipping: article not published yet
2011-01-13 13:31:29 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (42.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:31:29 - DEBUG: Updating 2 stale articles
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:31:29 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:29 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:29', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:31:29 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:29 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:29 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:29 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:31:29 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:31:29 - DEBUG: Request headers:
2011-01-13 13:31:29 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:29 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:29 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:30 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:31:30 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:30', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (44.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mCrossRef Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 21:31:30', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:31:30 - DEBUG: Updating 2 stale articles
2011-01-13 13:31:30 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:31:30 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:30 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:30', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:31:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:30 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:30 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:30 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:30 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:31:30 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:31:30 - DEBUG: Request headers:
2011-01-13 13:31:30 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:30 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:30 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:32 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:30", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:32 - DEBUG: Response headers:
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - INFO: Got 0 citation details.
2011-01-13 13:31:32 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:32 - DEBUG: Existing citation count: 0
2011-01-13 13:31:32 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:32 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:32 - DEBUG: Citation count: 0
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:32', `retrieved_at` = '2011-01-13 21:31:32' WHERE `id` = 124229983[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:32', 1, '2011-01-13 21:31:32', 2011, 124229983, 0)[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 13:31:32 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:32', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:32 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:32', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:32 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:30", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:32', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:31:32', `retrieved_at` = '2011-01-13 21:31:32' WHERE `id` = 959844139[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:31:32 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 13:31:32 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:32 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:32', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 13:31:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:32 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:32 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:32 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:32 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 13:31:32 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 13:31:32 - DEBUG: Request headers:
2011-01-13 13:31:32 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:32 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:32 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:34 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:32", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:31:34 - DEBUG: Response headers:
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - INFO: Got 0 citation details.
2011-01-13 13:31:34 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:31:34 - DEBUG: Existing citation count: 0
2011-01-13 13:31:34 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:31:34 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:31:34 - DEBUG: Citation count: 0
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:34', `retrieved_at` = '2011-01-13 21:31:34' WHERE `id` = 868470324[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:31:34', 1, '2011-01-13 21:31:34', 2011, 868470324, 0)[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 13:31:34 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:34', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:34 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:34', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 13:31:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:34 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:30", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:34 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:34 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:31:34 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 13:31:34 - DEBUG: Request headers:
2011-01-13 13:31:34 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:35 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 13:31:35 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:31:35', `disable_until` = '2011-01-13 21:31:45' WHERE `id` = 365262434[0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:35', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 13:31:35 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 13:31:35 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (59.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:31:35 - DEBUG: Updating 1 stale article
2011-01-13 13:31:35 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:31:35 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:35 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:35', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:31:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:35 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:35 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:29", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:31:35 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:31:35 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:31:35 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:31:35 - DEBUG: Request headers:
2011-01-13 13:31:35 - DEBUG: [accept] = '*/*'
2011-01-13 13:31:35 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:31:35 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:31:36 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:31:29", updated_at: "2011-01-13 21:31:35", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:31:36 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:31:36', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (46.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:31:36', 0, '2011-01-13 21:31:36', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (45.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mConnotea Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 21:31:36' WHERE `id` = 12978895[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:36 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:36 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 13:31:37 - INFO: Sent mail to alm@alm.example.org
2011-01-13 13:31:37 - DEBUG: 
Date: Thu, 13 Jan 2011 13:31:36 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mConnotea Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 21:31:37', `disable_until` = '2011-01-15 21:31:37' WHERE `id` = 12978895[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (44.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mConnotea Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 21:31:37' WHERE `id` = 12978895[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:31:37 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 21:31:37', `disable_until` = '2011-01-13 21:31:41' WHERE `id` = 12978895[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - INFO: Connotea is disabled until 2011-01-13 13:31:41 -0800. Skipping.
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:37 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 21:31:41', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (109.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Create (0.2ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', 'fc78ad706546754702f753773ab68bac03b0c9a6', '2011-01-13 21:31:41', '6c720ead14aaff43532cc47594b8fcb98c94c53d', NULL, '2011-01-13 21:31:41', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (47.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (42.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = '2011-01-27 21:31:41', `remember_token` = 'faf3e877dae7f42a6877d512a13a1f4debbe975e' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (50.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = '2011-01-20 21:31:41', `remember_token` = '8b127a4b98343772e2045757880e163283f6e821' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (44.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = '2011-01-20 21:31:41', `remember_token` = '3e3f118fb4af170866e96160d8a6cffeb8a61efa' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (43.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (48.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = '2011-01-27 21:31:41', `remember_token` = '5760935a6f762add323315dd9a6fa3a7d12ef0bd' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (42.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = '2011-01-27 21:31:41', `remember_token` = '22d594b6bec849f1b50a27d911091be0b4f178d7' WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:31:41', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:31:41 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:31:41 - DEBUG:   [4;36;1mSQL (48.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:05 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:32:05 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:05', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:05', '10.1/foo', NULL, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mConnotea Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844140, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mCrossRef Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844140, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (51.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:06', `retrieved_at` = '2011-01-13 21:31:06' WHERE `id` = 562580130[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:06', `retrieved_at` = '2011-01-13 21:31:06' WHERE `id` = 721439208[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:06', `retrieved_at` = '2011-01-13 21:31:06' WHERE `id` = 1040397643[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:06', `retrieved_at` = '2009-01-13 21:32:06' WHERE `id` = 721439208[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (48.4ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:06', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844141, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844141, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (51.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:06', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844142, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844142, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (47.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 21:32:06' [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 21:32:05' [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (48.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:06', '10.1/foo', '2011-01-12 21:32:06', 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844143, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844143, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (51.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:06', '10.1/foo', '2011-01-12 21:32:06', 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844144, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844144, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 21:32:06' [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (46.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:06', '10.1/foo', NULL, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844145, NULL, 12978895, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 959844145, NULL, 365262434, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:06', `published_on` = '2011-01-12 21:32:06' WHERE `id` = 959844145[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (51.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:06', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:06', 1, NULL, 1, 0)[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (53.5ms)[0m   [0mCOMMIT[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:32:06 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:06', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 13:32:06 - DEBUG:   [4;35;1mSQL (46.6ms)[0m   [0mCOMMIT[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:07', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (52.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:07', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:07', '10.0/citable', NULL, 0)[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:07', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:07', 959844146, NULL, 12978895, 0)[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:07', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:07', 959844146, NULL, 365262434, 0)[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 21:32:07', NULL, '2011-01-13 21:32:07', 1040397658)[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:32:07 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:07 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (7.7ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:07', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:07 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:07 - INFO: Got 1 citation details.
2011-01-13 13:32:07 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:07 - DEBUG: Existing citation count: 1
2011-01-13 13:32:07 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG: After existing citations uniquified: 1
2011-01-13 13:32:07 - INFO: Creating citation uri
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 21:32:07', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 21:32:07', 1040397658)[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mCitation Destroy (0.3ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG: Citation count: 2
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:07', `retrieved_at` = '2011-01-13 21:32:07' WHERE `id` = 1040397658[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:07', 1, '2011-01-13 21:32:07', 2011, 1040397658, 0)[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 21:32:07', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 13:32:07 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:07', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:07 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:07', `retrieved_at` = '2011-01-13 21:32:07' WHERE `id` = 959844146[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:08 - INFO: Refreshed article 10.0/citable
2011-01-13 13:32:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (45.3ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:08', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:08', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:08', 959844147, NULL, 12978895, 0)[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:08', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:08', 959844147, NULL, 365262434, 0)[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:08 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:32:08", updated_at: "2011-01-13 21:32:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:32:08 - INFO: Skipping: article not published yet
2011-01-13 13:32:08 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 21:32:08", updated_at: "2011-01-13 21:32:08", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSQL (129.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:32:08 - DEBUG: Updating 2 stale articles
2011-01-13 13:32:08 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:08 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:08 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:08', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:08 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:08 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:08 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:08 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:08 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:08 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:08 - DEBUG: Request headers:
2011-01-13 13:32:08 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:08 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:08 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:09 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:08", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:32:09 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:09', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (143.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mCrossRef Update (35.1ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 21:32:09', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 13:32:09 - DEBUG: Updating 2 stale articles
2011-01-13 13:32:09 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:09 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:09 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:09', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:09 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:09 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:09 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:09 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:09 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:09 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:09 - DEBUG: Request headers:
2011-01-13 13:32:09 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:09 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:09 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:11 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:09", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:11 - DEBUG: Response headers:
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - INFO: Got 0 citation details.
2011-01-13 13:32:11 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:11 - DEBUG: Existing citation count: 0
2011-01-13 13:32:11 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:11 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:11 - DEBUG: Citation count: 0
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:11', `retrieved_at` = '2011-01-13 21:32:11' WHERE `id` = 124229983[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:11', 1, '2011-01-13 21:32:11', 2011, 124229983, 0)[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 13:32:11 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:11', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:11 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:11', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:11 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:09", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:11', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:11', `retrieved_at` = '2011-01-13 21:32:11' WHERE `id` = 959844139[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:11 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 13:32:11 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:11 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:11', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 13:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:11 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:11 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:11 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:11 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 13:32:11 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 13:32:11 - DEBUG: Request headers:
2011-01-13 13:32:11 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:11 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:11 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:13 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:11", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:13 - DEBUG: Response headers:
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - INFO: Got 0 citation details.
2011-01-13 13:32:13 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:13 - DEBUG: Existing citation count: 0
2011-01-13 13:32:13 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:13 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:13 - DEBUG: Citation count: 0
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:13', `retrieved_at` = '2011-01-13 21:32:13' WHERE `id` = 868470324[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:13', 1, '2011-01-13 21:32:13', 2011, 868470324, 0)[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 13:32:13 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:13', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:13 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:13', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 13:32:13 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:13 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:13 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:09", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:13 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:13 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:32:13 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 13:32:13 - DEBUG: Request headers:
2011-01-13 13:32:13 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:13 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:14 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:13", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 13:32:14 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:32:14', `disable_until` = '2011-01-13 21:32:24' WHERE `id` = 365262434[0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:14', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 13:32:14 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 13:32:14 - DEBUG:   [4;36;1mCrossRef Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (57.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:14 - DEBUG: Updating 1 stale article
2011-01-13 13:32:14 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:14 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:14 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:14', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:14 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:14 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:14 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:07", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:14 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:14 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:14 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:14 - DEBUG: Request headers:
2011-01-13 13:32:14 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:14 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:14 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:15 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:07", updated_at: "2011-01-13 21:32:14", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 13:32:15 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:15', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (94.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:32:15', 0, '2011-01-13 21:32:15', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.7ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (45.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 21:32:15' WHERE `id` = 12978895[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:15 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 13:32:15 - INFO: Sent mail to alm@alm.example.org
2011-01-13 13:32:15 - DEBUG: 
Date: Thu, 13 Jan 2011 13:32:15 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 21:32:15', `disable_until` = '2011-01-15 21:32:15' WHERE `id` = 12978895[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (49.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mConnotea Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 21:32:15' WHERE `id` = 12978895[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:15 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mConnotea Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 21:32:15', `disable_until` = '2011-01-13 21:32:19' WHERE `id` = 12978895[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - INFO: Connotea is disabled until 2011-01-13 13:32:19 -0800. Skipping.
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 21:32:19', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (36.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mUser Create (0.2ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', 'd514d5969e4da85aa7c60e4dcfa24f44f1669cd7', '2011-01-13 21:32:19', '15ad98b6000cfe2c6d70a00b4440744c27071d6a', NULL, '2011-01-13 21:32:19', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:32:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:19 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (36.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (51.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = '2011-01-27 21:32:20', `remember_token` = 'cd1579f671b0ee72f64770213823226656bb1351' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (44.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = '2011-01-20 21:32:20', `remember_token` = 'a5edad246abf1ff7b5b40654e1eef7cea2d0891b' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (48.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = '2011-01-20 21:32:20', `remember_token` = 'bd18022100b81680e5e9ef52c80d2a61c4f3a13a' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (49.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (45.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = '2011-01-27 21:32:20', `remember_token` = '07e165b1718e925dd1472374a87d2f65bc29d426' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (53.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = '2011-01-27 21:32:20', `remember_token` = 'df0bf09294b07887dfd34257ef103d072cb27774' WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:20', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:20 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:20 - DEBUG:   [4;36;1mSQL (46.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:22 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:22) [POST]
2011-01-13 13:32:22 - INFO:   Parameters: {"article"=>{"doi"=>"10.0/dummy"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:22 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:22', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:22', '10.0/dummy', NULL, 0)[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mConnotea Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:22', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:22', 959844148, NULL, 12978895, 0)[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mCrossRef Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:22', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:22', 959844148, NULL, 365262434, 0)[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 13:32:22 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0%2Fdummy
2011-01-13 13:32:22 - INFO: Completed in 24ms (DB: 78) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.0%2Fdummy]
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (49.8ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - INFO: 

Processing ArticlesController#destroy (for 0.0.0.0 at 2011-01-13 13:32:22) [DELETE]
2011-01-13 13:32:22 - INFO:   Parameters: {"action"=>"destroy", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:22 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Destroy (0.3ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Destroy (0.3ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Destroy (0.4ms)[0m   [0;1mDELETE FROM `articles` WHERE `id` = 959844139[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Redirected to http://test.host/articles
2011-01-13 13:32:22 - INFO: Completed in 19ms (DB: 54) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (52.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:22 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:22) [GET]
2011-01-13 13:32:22 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles", "query"=>"pgen"}
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (doi like '%pgen%') ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:32:22 - INFO: Rendering articles/index
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:22 - INFO: Completed in 6ms (View: 3, DB: 53) | 200 OK [http://test.host/articles.csv?query=pgen]
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:32:22) [GET]
2011-01-13 13:32:22 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:6f0f34580d94565594011a036014454a", :article_id=>959844139}
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:22 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:22 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:22 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:22 - DEBUG: Request headers:
2011-01-13 13:32:22 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:22 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:22 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:22 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:22 - DEBUG: Response headers:
2011-01-13 13:32:22 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:22 - DEBUG: [connection] = 'close']
2011-01-13 13:32:22 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Got 0 citation details.
2011-01-13 13:32:22 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:22 - DEBUG: Existing citation count: 0
2011-01-13 13:32:22 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:22 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:22 - DEBUG: Citation count: 0
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `retrieved_at` = '2011-01-13 21:32:22' WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:22', 1, '2011-01-13 21:32:22', 2011, 124229983, 0)[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Saved history[980190966: 2011, 1] = 0
2011-01-13 13:32:22 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:22 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:22 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Update (0.4ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:22', `retrieved_at` = '2011-01-13 21:32:22' WHERE `id` = 959844139[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:22 - INFO: RetrievalWorker done.
2011-01-13 13:32:22 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:6f0f34580d94565594011a036014454a
2011-01-13 13:32:22 - INFO: Completed in 235ms (View: 0, DB: 9) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json]
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (50.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:32:22) [GET]
2011-01-13 13:32:22 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.6ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:8849bbfbb43ce810b35f21ad4c0693e1", :article_id=>959844139}
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:22 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:22 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:22 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:22 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:22 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:22 - DEBUG: Request headers:
2011-01-13 13:32:22 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:22 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:22 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:22 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:22 - DEBUG: Response headers:
2011-01-13 13:32:22 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:22 - DEBUG: [connection] = 'close']
2011-01-13 13:32:22 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Got 0 citation details.
2011-01-13 13:32:22 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:22 - DEBUG: Existing citation count: 0
2011-01-13 13:32:22 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:22 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:22 - DEBUG: Citation count: 0
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `retrieved_at` = '2011-01-13 21:32:22' WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:22', 1, '2011-01-13 21:32:22', 2011, 124229983, 0)[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Saved history[980190967: 2011, 1] = 0
2011-01-13 13:32:22 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:22 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:22 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:22', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mArticle Load (0.6ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:22 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:22', `retrieved_at` = '2011-01-13 21:32:22' WHERE `id` = 959844139[0m
2011-01-13 13:32:22 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:22 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:22 - INFO: RetrievalWorker done.
2011-01-13 13:32:22 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:8849bbfbb43ce810b35f21ad4c0693e1
2011-01-13 13:32:22 - INFO: Completed in 231ms (View: 0, DB: 62) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c]
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (68.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:32:23) [GET]
2011-01-13 13:32:23 - INFO:   Parameters: {"format"=>"json", "citations"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:3761fa5a969d81ccd66dbf563fe64eed", :article_id=>959844139}
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:23 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:23 - DEBUG: Request headers:
2011-01-13 13:32:23 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:23 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:23 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:23 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:23", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:23 - DEBUG: Response headers:
2011-01-13 13:32:23 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:23 - DEBUG: [connection] = 'close']
2011-01-13 13:32:23 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Got 0 citation details.
2011-01-13 13:32:23 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:23 - DEBUG: Existing citation count: 0
2011-01-13 13:32:23 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:23 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:23 - DEBUG: Citation count: 0
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval UPDATE (0.4ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mHistory Create (0.4ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:23', 1, '2011-01-13 21:32:23', 2011, 124229983, 0)[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Saved history[980190968: 2011, 1] = 0
2011-01-13 13:32:23 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Update (0.2ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 959844139[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - INFO: RetrievalWorker done.
2011-01-13 13:32:23 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:3761fa5a969d81ccd66dbf563fe64eed
2011-01-13 13:32:23 - INFO: Completed in 222ms (View: 0, DB: 78) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&citations=1]
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (49.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 13:32:23) [GET]
2011-01-13 13:32:23 - INFO:   Parameters: {"format"=>"json", "history"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:72398092c2151afa5ab1c79f97d5076a", :article_id=>959844139}
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:23 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:23 - DEBUG: Request headers:
2011-01-13 13:32:23 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:23 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:23 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:23 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:23", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:23 - DEBUG: Response headers:
2011-01-13 13:32:23 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:23 - DEBUG: [connection] = 'close']
2011-01-13 13:32:23 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Got 0 citation details.
2011-01-13 13:32:23 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:23 - DEBUG: Existing citation count: 0
2011-01-13 13:32:23 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:23 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:23 - DEBUG: Citation count: 0
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:23', 1, '2011-01-13 21:32:23', 2011, 124229983, 0)[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Saved history[980190969: 2011, 1] = 0
2011-01-13 13:32:23 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 959844139[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - INFO: RetrievalWorker done.
2011-01-13 13:32:23 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:72398092c2151afa5ab1c79f97d5076a
2011-01-13 13:32:23 - INFO: Completed in 225ms (View: 0, DB: 59) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&history=1]
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (59.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:32:23) [GET]
2011-01-13 13:32:23 - INFO:   Parameters: {"format"=>"xml", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:db669637b0ceca49009bba85ebe309d7", :article_id=>959844139}
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:23 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:23 - DEBUG: Request headers:
2011-01-13 13:32:23 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:23 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:23 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:23 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:23", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:23 - DEBUG: Response headers:
2011-01-13 13:32:23 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:23 - DEBUG: [connection] = 'close']
2011-01-13 13:32:23 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Got 0 citation details.
2011-01-13 13:32:23 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:23 - DEBUG: Existing citation count: 0
2011-01-13 13:32:23 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:23 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:23 - DEBUG: Citation count: 0
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval UPDATE (0.3ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mHistory Create (0.3ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:23', 1, '2011-01-13 21:32:23', 2011, 124229983, 0)[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Saved history[980190970: 2011, 1] = 0
2011-01-13 13:32:23 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:23 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Update (0.3ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:23', `retrieved_at` = '2011-01-13 21:32:23' WHERE `id` = 959844139[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - INFO: RetrievalWorker done.
2011-01-13 13:32:23 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:db669637b0ceca49009bba85ebe309d7
2011-01-13 13:32:23 - INFO: Completed in 238ms (View: 0, DB: 70) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml]
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (45.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:32:23) [GET]
2011-01-13 13:32:23 - INFO:   Parameters: {"format"=>"xml", "citations"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:1fb122a992990c48a7e1d626b44a491f", :article_id=>959844139}
2011-01-13 13:32:23 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:23 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:23', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:23 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:23 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:23 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:23 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:23 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:23 - DEBUG: Request headers:
2011-01-13 13:32:23 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:23 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:23 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:24 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:23", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:24 - DEBUG: Response headers:
2011-01-13 13:32:24 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:24 - DEBUG: [connection] = 'close']
2011-01-13 13:32:24 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Got 0 citation details.
2011-01-13 13:32:24 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:24 - DEBUG: Existing citation count: 0
2011-01-13 13:32:24 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:24 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:24 - DEBUG: Citation count: 0
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:24', 1, '2011-01-13 21:32:24', 2011, 124229983, 0)[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Saved history[980190971: 2011, 1] = 0
2011-01-13 13:32:24 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 959844139[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:24 - INFO: RetrievalWorker done.
2011-01-13 13:32:24 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:1fb122a992990c48a7e1d626b44a491f
2011-01-13 13:32:24 - INFO: Completed in 225ms (View: 0, DB: 55) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?citations=1]
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (42.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"xml", "history"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:c7986762b566cef88252dcf2ba80e138", :article_id=>959844139}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:24 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:24 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:24 - DEBUG: Request headers:
2011-01-13 13:32:24 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:24 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:24 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:24 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:24", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:24 - DEBUG: Response headers:
2011-01-13 13:32:24 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:24 - DEBUG: [connection] = 'close']
2011-01-13 13:32:24 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Got 0 citation details.
2011-01-13 13:32:24 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:24 - DEBUG: Existing citation count: 0
2011-01-13 13:32:24 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:24 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:24 - DEBUG: Citation count: 0
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:24', 1, '2011-01-13 21:32:24', 2011, 124229983, 0)[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Saved history[980190972: 2011, 1] = 0
2011-01-13 13:32:24 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Update (0.2ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 959844139[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:24 - INFO: RetrievalWorker done.
2011-01-13 13:32:24 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:c7986762b566cef88252dcf2ba80e138
2011-01-13 13:32:24 - INFO: Completed in 197ms (View: 0, DB: 49) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?history=1]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (47.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (7.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#edit (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"action"=>"edit", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:24 - INFO: Rendering template within layouts/application
2011-01-13 13:32:24 - INFO: Rendering articles/edit
Rendered articles/_form (7.3ms)
2011-01-13 13:32:24 - INFO: Completed in 19ms (View: 17, DB: 55) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005/edit]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"action"=>"index", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:32:24 - INFO: Rendering template within layouts/application
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:24 - INFO: Completed in 10ms (View: 7, DB: 1) | 200 OK [http://test.host/articles]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#new (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"action"=>"new", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:24 - INFO: Rendering template within layouts/application
2011-01-13 13:32:24 - INFO: Rendering articles/new
Rendered articles/_form (5.1ms)
2011-01-13 13:32:24 - INFO: Completed in 8ms (View: 7, DB: 0) | 200 OK [http://test.host/articles/new]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"1", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load Including Associations (0.4ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) AND `articles`.id IN (959844139, 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 6ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?cited=1]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load Including Associations (0.2ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"0", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) AND `articles`.id IN (819830547) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 7ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?cited=0]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 6ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 7ms (View: 3, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "order"=>"published_on", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY published_on LIMIT 0, 30[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (562580130,959844139,819830547)) [0m
2011-01-13 13:32:24 - INFO: Rendering articles/index
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:24 - INFO: Completed in 5ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?order=published_on]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:24) [POST]
2011-01-13 13:32:24 - INFO:   Parameters: {"article"=>{}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Rendering template within layouts/application
2011-01-13 13:32:24 - INFO: Rendering articles/new
Rendered articles/_form (7.3ms)
2011-01-13 13:32:24 - INFO: Completed in 12ms (View: 9, DB: 1) | 200 OK [http://test.host/articles?]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#show (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:ddd2d166d97003016cd3544fdec8ad0f", :article_id=>959844139}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 13:32:24 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 13:32:24 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 13:32:24 - DEBUG: Request headers:
2011-01-13 13:32:24 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:24 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:24 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:24 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:24", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:24 - DEBUG: Response headers:
2011-01-13 13:32:24 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:24 - DEBUG: [connection] = 'close']
2011-01-13 13:32:24 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Got 0 citation details.
2011-01-13 13:32:24 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:24 - DEBUG: Existing citation count: 0
2011-01-13 13:32:24 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:24 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:24 - DEBUG: Citation count: 0
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:24', 1, '2011-01-13 21:32:24', 2011, 124229983, 0)[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Saved history[980190973: 2011, 1] = 0
2011-01-13 13:32:24 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:24 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Update (0.3ms)[0m   [0mUPDATE `articles` SET `updated_at` = '2011-01-13 21:32:24', `retrieved_at` = '2011-01-13 21:32:24' WHERE `id` = 959844139[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 13:32:24 - INFO: RetrievalWorker done.
2011-01-13 13:32:24 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:ddd2d166d97003016cd3544fdec8ad0f
2011-01-13 13:32:24 - INFO: Rendering template within layouts/application
2011-01-13 13:32:24 - INFO: Rendering articles/show
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:32:24 - INFO: Completed in 229ms (View: 12, DB: 10) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (39.3ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:32:24) [GET]
2011-01-13 13:32:24 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles"}
2011-01-13 13:32:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:2b018b80582f68c296cb7b8371f9f159", :article_id=>562580130}
2011-01-13 13:32:24 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:24 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:24', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:32:24 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:24 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:24 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:24 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:32:24 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:24 - DEBUG: Request headers:
2011-01-13 13:32:24 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:24 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:24 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:25 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:24", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:25 - DEBUG: Response headers:
2011-01-13 13:32:25 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:25 - DEBUG: [connection] = 'close']
2011-01-13 13:32:25 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Got 0 citation details.
2011-01-13 13:32:25 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:25 - DEBUG: Existing citation count: 1
2011-01-13 13:32:25 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:25 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:25 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:25 - DEBUG: Citation count: 0
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `retrieved_at` = '2011-01-13 21:32:25' WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:25', 1, '2011-01-13 21:32:25', 2011, 721439208, 0)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Saved history[980190974: 2011, 1] = 0
2011-01-13 13:32:25 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:25 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:25 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:25 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:25 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:32:25 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:25 - DEBUG: Request headers:
2011-01-13 13:32:25 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:25 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:25", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:32:25 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mCrossRef Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:32:25', `disable_until` = '2011-01-13 21:32:35' WHERE `id` = 365262434[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:32:25 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:32:25 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:32:25 - INFO: RetrievalWorker done.
2011-01-13 13:32:25 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:2b018b80582f68c296cb7b8371f9f159
2011-01-13 13:32:25 - INFO: Rendering articles/show
2011-01-13 13:32:25 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:32:25 - INFO: Completed in 458ms (View: 3, DB: 50) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv]
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (42.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:32:25) [GET]
2011-01-13 13:32:25 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"connotea"}
2011-01-13 13:32:25 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mArticle Load Including Associations (0.7ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:6c6dd1e46f3b5c4435bd13fe12f173ba", :article_id=>562580130}
2011-01-13 13:32:25 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:25 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:25 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:32:25 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:25 - DEBUG: Request headers:
2011-01-13 13:32:25 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:25 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:25 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:25", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:25 - DEBUG: Response headers:
2011-01-13 13:32:25 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:25 - DEBUG: [connection] = 'close']
2011-01-13 13:32:25 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Got 0 citation details.
2011-01-13 13:32:25 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:25 - DEBUG: Existing citation count: 1
2011-01-13 13:32:25 - DEBUG:   [4;35;1mCitation Load (0.2ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:25 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:25 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:25 - DEBUG: Citation count: 0
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `retrieved_at` = '2011-01-13 21:32:25' WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:25', 1, '2011-01-13 21:32:25', 2011, 721439208, 0)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Saved history[980190975: 2011, 1] = 0
2011-01-13 13:32:25 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:25 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:25 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:25 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:25 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:32:25 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:25 - DEBUG: Request headers:
2011-01-13 13:32:25 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:25 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:25", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:32:25 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mCrossRef Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:32:25', `disable_until` = '2011-01-13 21:32:35' WHERE `id` = 365262434[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:32:25 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:32:25 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:32:25 - INFO: RetrievalWorker done.
2011-01-13 13:32:25 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:6c6dd1e46f3b5c4435bd13fe12f173ba
2011-01-13 13:32:25 - INFO: Rendering articles/show
2011-01-13 13:32:25 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:32:25 - INFO: Completed in 397ms (View: 2, DB: 52) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=connotea]
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (52.9ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 13:32:25) [GET]
2011-01-13 13:32:25 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"crossref"}
2011-01-13 13:32:25 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.3ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mArticle Load Including Associations (0.6ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:5e4e6f4c4a5ee3dae0aa63bbd9819ef0", :article_id=>562580130}
2011-01-13 13:32:25 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:25 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:25', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 13:32:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 13:32:25 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:25 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:25 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 13:32:25 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:25 - DEBUG: Request headers:
2011-01-13 13:32:25 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:25 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 13:32:26 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:25", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 13:32:26 - DEBUG: Response headers:
2011-01-13 13:32:26 - DEBUG: [location] = 'http://status.nature.com/connotea/paused.html']
2011-01-13 13:32:26 - DEBUG: [connection] = 'close']
2011-01-13 13:32:26 - DEBUG: [server] = 'BIG-IP']
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Got 0 citation details.
2011-01-13 13:32:26 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 13:32:26 - DEBUG: Existing citation count: 1
2011-01-13 13:32:26 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:26 - DEBUG: After existing citations uniquified: 0
2011-01-13 13:32:26 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 13:32:26 - DEBUG: Citation count: 0
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 721439208) [0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval UPDATE (0.3ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:26', `retrieved_at` = '2011-01-13 21:32:26' WHERE `id` = 721439208[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mHistory Create (0.3ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 21:32:26', 1, '2011-01-13 21:32:26', 2011, 721439208, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Saved history[980190976: 2011, 1] = 0
2011-01-13 13:32:26 - INFO: result=true, sources_count incremented: 1
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:26', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:26 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:26', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:26 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 13:32:26 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 13:32:26 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 13:32:26 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 13:32:26 - DEBUG: Request headers:
2011-01-13 13:32:26 - DEBUG: [accept] = '*/*'
2011-01-13 13:32:26 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 13:32:26 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:26", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 13:32:26 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mCrossRef Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 21:32:26', `disable_until` = '2011-01-13 21:32:36' WHERE `id` = 365262434[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 13:32:26 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 13:32:26 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 21:32:22", updated_at: "2011-01-13 21:32:22", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 21:32:26', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 1, only src: )
2011-01-13 13:32:26 - INFO: RetrievalWorker done.
2011-01-13 13:32:26 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:5e4e6f4c4a5ee3dae0aa63bbd9819ef0
2011-01-13 13:32:26 - INFO: Rendering articles/show
2011-01-13 13:32:26 - DEBUG:   [4;35;1mCitation Load (0.2ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Completed in 422ms (View: 4, DB: 64) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=crossref]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (42.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#update (for 0.0.0.0 at 2011-01-13 13:32:26) [PUT]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{}, "action"=>"update", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1371%2Fjournal.pbio.0000005
2011-01-13 13:32:26 - INFO: Completed in 10ms (DB: 44) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005?]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{"doi"=>"10.1000/182"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1000/182') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:26', '10.1000/182', NULL, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844149, NULL, 12978895, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844149, NULL, 365262434, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1000%2F182
2011-01-13 13:32:26 - INFO: Completed in 27ms (DB: 4) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{"doi"=>"10.0092/ooh"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0092/ooh') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:26', '10.0092/ooh', NULL, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844150, NULL, 12978895, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844150, NULL, 365262434, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0092%2Fooh
2011-01-13 13:32:26 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{"doi"=>"10.10/♥"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.10/♥') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:26', '10.10/♥', NULL, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844151, NULL, 12978895, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844151, NULL, 365262434, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F10.10%2F%E2%99%A5
2011-01-13 13:32:26 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{"doi"=>"1.0/1337"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '1.0/1337') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:26', '1.0/1337', NULL, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844152, NULL, 12978895, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844152, NULL, 365262434, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F1.0%2F1337
2011-01-13 13:32:26 - INFO: Completed in 25ms (DB: 3) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:32:26 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"article"=>{"doi"=>"10.9898098098098/นก"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.9898098098098/นก') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 21:32:26', '10.9898098098098/นก', NULL, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844153, NULL, 12978895, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 21:32:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 21:32:26', 959844153, NULL, 365262434, 0)[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/articles/info:doi%2F10.9898098098098%2F%E0%B8%99%E0%B8%81
2011-01-13 13:32:26 - INFO: Completed in 15ms (DB: 2) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (41.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - INFO: 

Processing DocsController#index (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"index", "controller"=>"docs"}
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/docs/install
2011-01-13 13:32:26 - INFO: Completed in 4ms (DB: 41) | 302 Found [http://test.host/docs]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - INFO: 

Processing DocsController#install (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"install", "controller"=>"docs"}
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering docs/index
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:26 - INFO: Completed in 6ms (View: 6, DB: 0) | 200 OK [http://test.host/docs/install]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: 

Processing GroupsController#groupArticleSummaries (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:32:26 - DEBUG: groupArticleSummaries
2011-01-13 13:32:26 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load Including Associations (0.4ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering groups/groupArticleSummaries
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:26 - INFO: Completed in 9ms (View: 3, DB: 1) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:32:26 - DEBUG: groupArticleSummaries
2011-01-13 13:32:26 - INFO: format:application/json
2011-01-13 13:32:26 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: Completed in 6ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=json]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "callback"=>"foo", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:32:26 - DEBUG: groupArticleSummaries
2011-01-13 13:32:26 - INFO: format:application/json
2011-01-13 13:32:26 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: Completed in 52ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?callback=foo&format=json]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: 

Processing GroupsController#groupArticleSummaries to xml (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"format"=>"xml", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 13:32:26 - DEBUG: groupArticleSummaries
2011-01-13 13:32:26 - INFO: format:application/xml
2011-01-13 13:32:26 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 13:32:26 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 13:32:26 - INFO: Completed in 8ms (View: 3, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=xml]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/
2011-01-13 13:32:26 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/logout]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = '2011-01-27 21:32:26', `remember_token` = '411c3e532e20530f88bcd21cd62f240cb31a72ea' WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering sessions/new
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:26 - INFO: Completed in 13ms (View: 10, DB: 1) | 200 OK [http://test.host/login]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (48.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = '2011-01-27 21:32:26', `remember_token` = '09487f006796e516aa2f9133346357fce7898755' WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = '2011-01-13 21:27:26' WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '09487f006796e516aa2f9133346357fce7898755') LIMIT 1[0m
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering sessions/new
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '09487f006796e516aa2f9133346357fce7898755') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:26 - INFO: Completed in 7ms (View: 4, DB: 49) | 200 OK [http://test.host/login]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '09487f006796e516aa2f9133346357fce7898755') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (43.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:26 - WARN: Failed login for 'quentin' from 0.0.0.0 at 2011-01-13 13:32:26 -0800
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering sessions/new
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:26 - INFO: Completed in 4ms (View: 3, DB: 44) | 200 OK [http://test.host/session?login=quentin&password=bad+password]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/
2011-01-13 13:32:26 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/session?login=quentin&password=monkey]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (46.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = '2011-01-27 21:32:26', `remember_token` = '2f1072852b8f1ee9ac561c2750a9e6b41c24ff1d' WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '2f1072852b8f1ee9ac561c2750a9e6b41c24ff1d') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Rendering template within layouts/application
2011-01-13 13:32:26 - INFO: Rendering sessions/new
2011-01-13 13:32:26 - INFO: Completed in 5ms (View: 2, DB: 48) | 200 OK [http://test.host/login]
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (46.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 13:32:26) [GET]
2011-01-13 13:32:26 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/
2011-01-13 13:32:26 - INFO: Completed in 1ms (DB: 47) | 302 Found [http://test.host/logout]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:26 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:32:26) [POST]
2011-01-13 13:32:26 - INFO:   Parameters: {"remember_me"=>"0", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:26', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:26 - INFO: Redirected to http://test.host/
2011-01-13 13:32:26 - INFO: Completed in 6ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=0]
2011-01-13 13:32:26 - DEBUG:   [4;35;1mSQL (46.2ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"remember_me"=>"1", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = '2011-01-27 21:32:27', `remember_token` = 'ffec6581528d81935647347d3778d97c11b4e5e8' WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Redirected to http://test.host/
2011-01-13 13:32:27 - INFO: Completed in 3ms (DB: 47) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=1]
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (43.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"create", "controller"=>"sources", "source"=>{}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUnconfiguredSource Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUnconfiguredSource Create (0.4ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 21:32:27', 0, '2011-01-13 21:32:27', 30, NULL, NULL, 604800, NULL, 10, 'UnconfiguredSource', NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262436 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262436)[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Redirected to http://test.host/sources
2011-01-13 13:32:27 - INFO: Completed in 10ms (DB: 47) | 302 Found [http://test.host/sources?&class=UnconfiguredSource]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (48.5ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#destroy (for 0.0.0.0 at 2011-01-13 13:32:27) [DELETE]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"destroy", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mHistory Load (0.1ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 1040397643) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mRetrieval Destroy (0.1ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 1040397643[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 650162847) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 650162847) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mRetrieval Destroy (0.1ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 650162847[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mCrossRef Destroy (0.2ms)[0m   [0mDELETE FROM `sources` WHERE `id` = 365262434[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Redirected to http://test.host/sources
2011-01-13 13:32:27 - INFO: Completed in 9ms (DB: 51) | 302 Found [http://test.host/sources/365262434]
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (44.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#edit (for 0.0.0.0 at 2011-01-13 13:32:27) [GET]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"edit", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering sources/edit
2011-01-13 13:32:27 - DEBUG:   [4;36;1mGroup Load (0.3ms)[0m   [0;1mSELECT * FROM `groups` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
Rendered sources/_form (10.2ms)
2011-01-13 13:32:27 - INFO: Completed in 14ms (View: 12, DB: 45) | 200 OK [http://test.host/sources/365262434/edit]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#index (for 0.0.0.0 at 2011-01-13 13:32:27) [GET]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"index", "controller"=>"sources"}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering sources/index
2011-01-13 13:32:27 - DEBUG:   [4;36;1mGroup Load (0.0ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:32:27 - INFO: Completed in 12ms (View: 6, DB: 1) | 200 OK [http://test.host/sources]
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#new (for 0.0.0.0 at 2011-01-13 13:32:27) [GET]
2011-01-13 13:32:27 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"new", "controller"=>"sources"}
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering sources/new
2011-01-13 13:32:27 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mGroup Load (0.0ms)[0m   [0mSELECT * FROM `groups` [0m
Rendered sources/_form (4.6ms)
2011-01-13 13:32:27 - INFO: Completed in 9ms (View: 7, DB: 0) | 200 OK [http://test.host/sources/new?class=UnconfiguredSource]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#show (for 0.0.0.0 at 2011-01-13 13:32:27) [GET]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"show", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) AND (`retrievals`.source_id = 365262434) ORDER BY (citations_count + other_citations_count) desc LIMIT 5[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering sources/show
2011-01-13 13:32:27 - DEBUG:   [4;35;1mGroup Load (0.0ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 13:32:27 - INFO: Completed in 9ms (View: 6, DB: 1) | 200 OK [http://test.host/sources/365262434]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 13:32:27 - INFO: 

Processing SourcesController#update (for 0.0.0.0 at 2011-01-13 13:32:27) [PUT]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"update", "id"=>"365262434", "controller"=>"sources", "source"=>{"class"=>"CrossRef"}}
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mCrossRef Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Redirected to http://test.host/sources
2011-01-13 13:32:27 - INFO: Completed in 3ms (DB: 1) | 302 Found [http://test.host/sources/365262434?source%5Bclass%5D=CrossRef]
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Create (0.1ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '34e5cfe6d4739c40f063122596b5e53e07c63bfd', '2011-01-13 21:32:27', 'c4b937a06241b94ef9a66535ec87d16c3ba939bf', NULL, '2011-01-13 21:32:27', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Redirected to http://test.host/
2011-01-13 13:32:27 - INFO: Completed in 8ms (DB: 1) | 302 Found [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (44.6ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>nil}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering users/new
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: Completed in 17ms (View: 8, DB: 46) | 200 OK [http://test.host/register?user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (43.0ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>nil, "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering users/new
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: Completed in 12ms (View: 7, DB: 44) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (46.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering users/new
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: Completed in 10ms (View: 5, DB: 48) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (42.7ms)[0m   [0mROLLBACK[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 13:32:27) [POST]
2011-01-13 13:32:27 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 21:32:27', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 13:32:27 - INFO: Rendering template within layouts/application
2011-01-13 13:32:27 - INFO: Rendering users/new
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - INFO: Completed in 13ms (View: 7, DB: 44) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 13:32:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 13:32:27 - DEBUG:   [4;35;1mSQL (46.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:26', '10.1/foo', NULL, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mConnotea Columns (1.2ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844140, NULL, 12978895, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mCrossRef Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844140, NULL, 365262434, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (51.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:14:26', `retrieved_at` = '2011-01-13 22:13:26' WHERE `id` = 562580130[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:26', `retrieved_at` = '2011-01-13 22:13:26' WHERE `id` = 721439208[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:26', `retrieved_at` = '2011-01-13 22:13:26' WHERE `id` = 1040397643[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:26', `retrieved_at` = '2009-01-13 22:14:26' WHERE `id` = 721439208[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (47.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:26', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844141, NULL, 12978895, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844141, NULL, 365262434, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (47.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:26', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844142, NULL, 12978895, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844142, NULL, 365262434, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (45.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSource Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 22:14:26' [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSource Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 22:14:25' [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (45.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:26', '10.1/foo', '2011-01-12 22:14:26', 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844143, NULL, 12978895, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:26', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:26', 959844143, NULL, 365262434, 0)[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:26 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:14:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (49.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:27', '10.1/foo', '2011-01-12 22:14:27', 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:27', 959844144, NULL, 12978895, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:27', 959844144, NULL, 365262434, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSource Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 22:14:27' [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (46.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:27', '10.1/foo', NULL, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:27', 959844145, NULL, 12978895, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:27', 959844145, NULL, 365262434, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:14:27', `published_on` = '2011-01-12 22:14:27' WHERE `id` = 959844145[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (41.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:27', 1, NULL, 1, 0)[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (46.6ms)[0m   [0mCOMMIT[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:14:27 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:27', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 14:14:27 - DEBUG:   [4;35;1mSQL (45.4ms)[0m   [0mCOMMIT[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:28', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (52.3ms)[0m   [0mCOMMIT[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:28', '10.0/citable', NULL, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:28', 959844146, NULL, 12978895, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:28', 959844146, NULL, 365262434, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:14:28', NULL, '2011-01-13 22:14:28', 1040397658)[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:14:28 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:28 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:28', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:28 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:28 - INFO: Got 1 citation details.
2011-01-13 14:14:28 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:14:28 - DEBUG: Existing citation count: 1
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:14:28 - INFO: Creating citation uri
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:14:28', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 22:14:28', 1040397658)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG: Citation count: 2
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:28', `retrieved_at` = '2011-01-13 22:14:28' WHERE `id` = 1040397658[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:14:28', 1, '2011-01-13 22:14:28', 2011, 1040397658, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:14:28', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 14:14:28 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:28', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:14:28', `retrieved_at` = '2011-01-13 22:14:28' WHERE `id` = 959844146[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - INFO: Refreshed article 10.0/citable
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (52.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:28', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:28', 959844147, NULL, 12978895, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:28', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:28', 959844147, NULL, 365262434, 0)[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:14:28 - INFO: Skipping: article not published yet
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (46.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:14:28 - DEBUG: Updating 2 stale articles
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:28 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:28 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:28', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:28 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:28 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:28 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:28 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:28 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:28 - DEBUG: Request headers:
2011-01-13 14:14:28 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:28 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:28 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:29 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:14:29 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:29', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (50.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mCrossRef Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 22:14:29', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:14:29 - DEBUG: Updating 2 stale articles
2011-01-13 14:14:29 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:29 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:29 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:29', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:29 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:29 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:29 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:29 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:29 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:29 - DEBUG: Request headers:
2011-01-13 14:14:29 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:29 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:29 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:31 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:29", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:14:31 - DEBUG: Response headers:
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - INFO: Got 0 citation details.
2011-01-13 14:14:31 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:14:31 - DEBUG: Existing citation count: 0
2011-01-13 14:14:31 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:14:31 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:14:31 - DEBUG: Citation count: 0
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:31', `retrieved_at` = '2011-01-13 22:14:31' WHERE `id` = 124229983[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:14:31', 1, '2011-01-13 22:14:31', 2011, 124229983, 0)[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 14:14:31 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:31', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:31 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:31', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:31 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:29", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:31', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:14:31', `retrieved_at` = '2011-01-13 22:14:31' WHERE `id` = 959844139[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 14:14:31 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 14:14:31 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:31 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:31', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 14:14:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:31 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:31 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:31 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:31 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 14:14:31 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 14:14:31 - DEBUG: Request headers:
2011-01-13 14:14:31 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:31 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:31 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:33 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:14:33 - DEBUG: Response headers:
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - INFO: Got 0 citation details.
2011-01-13 14:14:33 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:14:33 - DEBUG: Existing citation count: 0
2011-01-13 14:14:33 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:14:33 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:14:33 - DEBUG: Citation count: 0
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval UPDATE (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:33', `retrieved_at` = '2011-01-13 22:14:33' WHERE `id` = 868470324[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:14:33', 1, '2011-01-13 22:14:33', 2011, 868470324, 0)[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 14:14:33 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:33', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:33 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:33', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 14:14:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:33 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:29", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:33 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:33 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:14:33 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 14:14:33 - DEBUG: Request headers:
2011-01-13 14:14:33 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:33 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:34 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 14:14:34 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:34', `disable_until` = '2011-01-13 22:14:44' WHERE `id` = 365262434[0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:34', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 14:14:34 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 14:14:34 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (49.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:34 - DEBUG: Updating 1 stale article
2011-01-13 14:14:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:34 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:34 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:34', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:34 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:28", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:34 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:34 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:34 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:34 - DEBUG: Request headers:
2011-01-13 14:14:34 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:34 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:34 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:35 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:28", updated_at: "2011-01-13 22:14:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:14:35 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:35', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (52.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSource Create (0.1ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 22:14:35', 0, '2011-01-13 22:14:35', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:35 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:35 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (49.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 22:14:36' WHERE `id` = 12978895[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:36 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 14:14:36 - INFO: Sent mail to alm@alm.example.org
2011-01-13 14:14:36 - DEBUG: 
Date: Thu, 13 Jan 2011 14:14:36 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mConnotea Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 22:14:36', `disable_until` = '2011-01-15 22:14:36' WHERE `id` = 12978895[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (53.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 22:14:36' WHERE `id` = 12978895[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:36 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 22:14:36', `disable_until` = '2011-01-13 22:14:40' WHERE `id` = 12978895[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - INFO: Connotea is disabled until 2011-01-13 14:14:40 -0800. Skipping.
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:36 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 22:14:40', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (91.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Create (0.2ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '01dd87caa83d7ecd7b784347d7b7982be68fe0d0', '2011-01-13 22:14:40', '7856e9260446302eee261881a7af5bc22bd7074b', NULL, '2011-01-13 22:14:40', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (72.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (52.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = '2011-01-27 22:14:40', `remember_token` = '4694faa0802380cb0e696fac6236d249c46fb4b8' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (47.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = '2011-01-20 22:14:40', `remember_token` = '25942656e939271b2440d655e9f72fedb4a84a5f' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (47.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = '2011-01-20 22:14:40', `remember_token` = '42a6ea624ae4ed7b2c54b5ab1fbf148e61b35e07' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (41.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (51.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = '2011-01-27 22:14:40', `remember_token` = '3b3dc15656e3d35efca3e32d26234a9b73d4d363' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (46.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = '2011-01-27 22:14:40', `remember_token` = 'abc604e2f6af08622abce8108d475bc7b3881cb4' WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:40', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:40 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:40 - DEBUG:   [4;36;1mSQL (44.5ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:42 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:42) [POST]
2011-01-13 14:14:42 - INFO:   Parameters: {"article"=>{"doi"=>"10.0/dummy"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:42 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:42', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:42', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mConnotea Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:42', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:42', 959844148, NULL, 12978895, 0)[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mCrossRef Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:42', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:42', 959844148, NULL, 365262434, 0)[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:14:42 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0%2Fdummy
2011-01-13 14:14:42 - INFO: Completed in 21ms (DB: 77) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.0%2Fdummy]
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSQL (46.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:42 - INFO: 

Processing ArticlesController#destroy (for 0.0.0.0 at 2011-01-13 14:14:42) [DELETE]
2011-01-13 14:14:42 - INFO:   Parameters: {"action"=>"destroy", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:42 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 124229983) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 124229983[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mArticle Destroy (0.3ms)[0m   [0;1mDELETE FROM `articles` WHERE `id` = 959844139[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - INFO: Redirected to http://test.host/articles
2011-01-13 14:14:42 - INFO: Completed in 18ms (DB: 51) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSQL (45.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:42 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:42) [GET]
2011-01-13 14:14:42 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles", "query"=>"pgen"}
2011-01-13 14:14:42 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (doi like '%pgen%') ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:14:42 - INFO: Rendering articles/index
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:42 - INFO: Completed in 6ms (View: 3, DB: 46) | 200 OK [http://test.host/articles.csv?query=pgen]
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:42 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:14:42) [GET]
2011-01-13 14:14:42 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:42 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:42 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:de3996ee10f6d4bff0adb1daaa636c3b", :article_id=>959844139}
2011-01-13 14:14:42 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:42 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:42 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:42', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:42 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:42 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:42 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:42 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:42 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:42 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:42 - DEBUG: Request headers:
2011-01-13 14:14:42 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:42 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:42 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:43 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:43 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:43', `disable_until` = '2011-01-13 22:14:53' WHERE `id` = 12978895[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:43 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_json_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:43 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:43 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:43 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:43 - INFO: RetrievalWorker done.
2011-01-13 14:14:43 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:de3996ee10f6d4bff0adb1daaa636c3b
2011-01-13 14:14:43 - INFO: Completed in 469ms (View: 0, DB: 8) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json]
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (46.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:43 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:14:43) [GET]
2011-01-13 14:14:43 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:43 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:33f596e3baf16d72d9a3af8b933911b5", :article_id=>959844139}
2011-01-13 14:14:43 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:43 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:43 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:43 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:43 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:43 - DEBUG: Request headers:
2011-01-13 14:14:43 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:43 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:43 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:43 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:43", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:43 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:43', `disable_until` = '2011-01-13 22:14:53' WHERE `id` = 12978895[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:43 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:43 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:43 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:43 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:43 - INFO: RetrievalWorker done.
2011-01-13 14:14:43 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:33f596e3baf16d72d9a3af8b933911b5
2011-01-13 14:14:43 - INFO: Completed in 612ms (View: 0, DB: 53) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c]
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (44.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:43 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:14:43) [GET]
2011-01-13 14:14:43 - INFO:   Parameters: {"format"=>"json", "citations"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:43 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:5ce719a0678c0b0f0cca8a4072d40234", :article_id=>959844139}
2011-01-13 14:14:43 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:43 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:43', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:43 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:43 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:43 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:43 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:43 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:43 - DEBUG: Request headers:
2011-01-13 14:14:43 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:43 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:43 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:43", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:44 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:44', `disable_until` = '2011-01-13 22:14:54' WHERE `id` = 12978895[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_with_citations_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:44 - INFO: RetrievalWorker done.
2011-01-13 14:14:44 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:5ce719a0678c0b0f0cca8a4072d40234
2011-01-13 14:14:44 - INFO: Completed in 271ms (View: 0, DB: 53) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&citations=1]
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (42.4ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:14:44) [GET]
2011-01-13 14:14:44 - INFO:   Parameters: {"format"=>"json", "history"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:44 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:a8c1e0fb74a367ada4c89813417edcbf", :article_id=>959844139}
2011-01-13 14:14:44 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:44 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:44 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:44 - DEBUG: Request headers:
2011-01-13 14:14:44 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:44 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:44 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:44", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:44 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:44', `disable_until` = '2011-01-13 22:14:54' WHERE `id` = 12978895[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_jsonp_with_history_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:44 - INFO: RetrievalWorker done.
2011-01-13 14:14:44 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:a8c1e0fb74a367ada4c89813417edcbf
2011-01-13 14:14:44 - INFO: Completed in 212ms (View: 0, DB: 50) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&history=1]
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (42.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mArticle Load (0.0ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:14:44) [GET]
2011-01-13 14:14:44 - INFO:   Parameters: {"format"=>"xml", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:44 - DEBUG:   [4;35;1mArticle Load (0.0ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:62a64320b0bd83659d66c3a5618e5649", :article_id=>959844139}
2011-01-13 14:14:44 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:44 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:44 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:44 - DEBUG: Request headers:
2011-01-13 14:14:44 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:44 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:44 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:44", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:44 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:44', `disable_until` = '2011-01-13 22:14:54' WHERE `id` = 12978895[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:44 - INFO: RetrievalWorker done.
2011-01-13 14:14:44 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:62a64320b0bd83659d66c3a5618e5649
2011-01-13 14:14:44 - INFO: Completed in 222ms (View: 0, DB: 49) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml]
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (50.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:14:44) [GET]
2011-01-13 14:14:44 - INFO:   Parameters: {"format"=>"xml", "citations"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:44 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:44e96d9a1199e6901d91fed98896a0ac", :article_id=>959844139}
2011-01-13 14:14:44 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:44 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:44 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:44 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:44 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:44 - DEBUG: Request headers:
2011-01-13 14:14:44 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:44 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:44 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:44", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:44 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:44', `disable_until` = '2011-01-13 22:14:54' WHERE `id` = 12978895[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_citations_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:44 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:44 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:44', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:44 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:44 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:44 - INFO: RetrievalWorker done.
2011-01-13 14:14:44 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:44e96d9a1199e6901d91fed98896a0ac
2011-01-13 14:14:44 - INFO: Completed in 209ms (View: 0, DB: 57) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?citations=1]
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (46.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"xml", "history"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mHistory Load (0.1ms)[0m   [0mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:3dc30a447bed77a381f2f6cbe9ead4fc", :article_id=>959844139}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:45 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:45 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:45 - DEBUG: Request headers:
2011-01-13 14:14:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:45 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:45", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:45 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:45', `disable_until` = '2011-01-13 22:14:55' WHERE `id` = 12978895[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_history_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:45 - INFO: RetrievalWorker done.
2011-01-13 14:14:45 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:3dc30a447bed77a381f2f6cbe9ead4fc
2011-01-13 14:14:45 - INFO: Completed in 266ms (View: 0, DB: 53) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?history=1]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (44.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#edit (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"action"=>"edit", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:45 - INFO: Rendering template within layouts/application
2011-01-13 14:14:45 - INFO: Rendering articles/edit
Rendered articles/_form (6.8ms)
2011-01-13 14:14:45 - INFO: Completed in 17ms (View: 15, DB: 44) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005/edit]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"action"=>"index", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:14:45 - INFO: Rendering template within layouts/application
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:45 - INFO: Completed in 9ms (View: 7, DB: 1) | 200 OK [http://test.host/articles]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#new (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"action"=>"new", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:45 - INFO: Rendering template within layouts/application
2011-01-13 14:14:45 - INFO: Rendering articles/new
Rendered articles/_form (4.0ms)
2011-01-13 14:14:45 - INFO: Completed in 7ms (View: 6, DB: 0) | 200 OK [http://test.host/articles/new]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"1", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) AND `articles`.id IN (959844139, 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 5ms (View: 1, DB: 1) | 200 OK [http://test.host/articles.csv?cited=1]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load Including Associations (0.2ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"0", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) AND `articles`.id IN (819830547) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 5ms (View: 1, DB: 1) | 200 OK [http://test.host/articles.csv?cited=0]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 4ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "order"=>"published_on", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY published_on LIMIT 0, 30[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (6.8ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (562580130,959844139,819830547)) [0m
2011-01-13 14:14:45 - INFO: Rendering articles/index
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:45 - INFO: Completed in 50ms (View: 2, DB: 7) | 200 OK [http://test.host/articles.csv?order=published_on]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:45) [POST]
2011-01-13 14:14:45 - INFO:   Parameters: {"article"=>{}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - INFO: Rendering template within layouts/application
2011-01-13 14:14:45 - INFO: Rendering articles/new
Rendered articles/_form (6.9ms)
2011-01-13 14:14:45 - INFO: Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/articles?]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.0ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.0ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#show (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:c1266ce3d7952015820e43b942a59cb9", :article_id=>959844139}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:14:45 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:14:45 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:14:45 - DEBUG: Request headers:
2011-01-13 14:14:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:45 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:45", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:45 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mConnotea Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:45', `disable_until` = '2011-01-13 22:14:55' WHERE `id` = 12978895[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:113:in `test_should_show_article'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:14:45 - INFO: RetrievalWorker done.
2011-01-13 14:14:45 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:c1266ce3d7952015820e43b942a59cb9
2011-01-13 14:14:45 - INFO: Rendering template within layouts/application
2011-01-13 14:14:45 - INFO: Rendering articles/show
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:14:45 - INFO: Completed in 214ms (View: 12, DB: 7) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (46.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:14:45) [GET]
2011-01-13 14:14:45 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles"}
2011-01-13 14:14:45 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:8ab3f4c0650abde1645efc156afe1071", :article_id=>562580130}
2011-01-13 14:14:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:45 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:45 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:45 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:14:45 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:45 - DEBUG: Request headers:
2011-01-13 14:14:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:45 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:45", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:45 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mConnotea Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:45', `disable_until` = '2011-01-13 22:14:55' WHERE `id` = 12978895[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:45 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:45', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:14:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:45 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:45 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:45 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:14:45 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:45 - DEBUG: Request headers:
2011-01-13 14:14:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:46 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:45", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:14:46 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mCrossRef Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:46', `disable_until` = '2011-01-13 22:14:56' WHERE `id` = 365262434[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:14:46 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:14:46 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:46', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:14:46 - INFO: RetrievalWorker done.
2011-01-13 14:14:46 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:8ab3f4c0650abde1645efc156afe1071
2011-01-13 14:14:46 - INFO: Rendering articles/show
2011-01-13 14:14:46 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 14:14:46 - INFO: Completed in 427ms (View: 7, DB: 56) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv]
2011-01-13 14:14:46 - DEBUG:   [4;35;1mSQL (48.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:46 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:14:46) [GET]
2011-01-13 14:14:46 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"connotea"}
2011-01-13 14:14:46 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mArticle Load Including Associations (0.8ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:46 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:d3a79da3bc57cbe495030faf4c22732c", :article_id=>562580130}
2011-01-13 14:14:46 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:46 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:46 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:46', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:14:46 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:46 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:46 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:46 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:46 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:14:46 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:46 - DEBUG: Request headers:
2011-01-13 14:14:46 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:46 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:46 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:47 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:46", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:47 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:47', `disable_until` = '2011-01-13 22:14:57' WHERE `id` = 12978895[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:47 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:47 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:47', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:47 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:47', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:47 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:47 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:47 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:14:47 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:47 - DEBUG: Request headers:
2011-01-13 14:14:47 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:47 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:47 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:47", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:14:47 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:47', `disable_until` = '2011-01-13 22:14:57' WHERE `id` = 365262434[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:14:47 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:14:47 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:47', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:14:47 - INFO: RetrievalWorker done.
2011-01-13 14:14:47 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:d3a79da3bc57cbe495030faf4c22732c
2011-01-13 14:14:47 - INFO: Rendering articles/show
2011-01-13 14:14:47 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 14:14:47 - INFO: Completed in 1039ms (View: 4, DB: 58) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=connotea]
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (61.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:47 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:14:47) [GET]
2011-01-13 14:14:47 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"crossref"}
2011-01-13 14:14:47 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:47 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:4431fa630cfb10482fc38f3a3f462cad", :article_id=>562580130}
2011-01-13 14:14:47 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:47 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:47 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:47', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:14:47 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:47 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:14:47 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:47 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:47 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:14:47 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:47 - DEBUG: Request headers:
2011-01-13 14:14:47 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:47 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:47 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:14:48 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:47", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:14:48 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:48', `disable_until` = '2011-01-13 22:14:58' WHERE `id` = 12978895[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:14:48 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:14:48 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:48', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:48 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:48', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:48 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:14:48 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:14:48 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:14:48 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:14:48 - DEBUG: Request headers:
2011-01-13 14:14:48 - DEBUG: [accept] = '*/*'
2011-01-13 14:14:48 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:14:48 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:48", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:14:48 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:14:48', `disable_until` = '2011-01-13 22:14:58' WHERE `id` = 365262434[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:14:48 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:14:48 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:14:42", updated_at: "2011-01-13 22:14:42", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:14:48', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:14:48 - INFO: RetrievalWorker done.
2011-01-13 14:14:48 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:4431fa630cfb10482fc38f3a3f462cad
2011-01-13 14:14:48 - INFO: Rendering articles/show
2011-01-13 14:14:48 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Completed in 961ms (View: 4, DB: 71) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=crossref]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (49.4ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#update (for 0.0.0.0 at 2011-01-13 14:14:48) [PUT]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{}, "action"=>"update", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1371%2Fjournal.pbio.0000005
2011-01-13 14:14:48 - INFO: Completed in 9ms (DB: 51) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005?]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{"doi"=>"10.1000/182"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1000/182') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Create (0.4ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:48', '10.1000/182', NULL, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844149, NULL, 12978895, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844149, NULL, 365262434, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1000%2F182
2011-01-13 14:14:48 - INFO: Completed in 73ms (DB: 4) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{"doi"=>"10.0092/ooh"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0092/ooh') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:48', '10.0092/ooh', NULL, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844150, NULL, 12978895, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844150, NULL, 365262434, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0092%2Fooh
2011-01-13 14:14:48 - INFO: Completed in 11ms (DB: 2) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{"doi"=>"10.10/♥"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.10/♥') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:48', '10.10/♥', NULL, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844151, NULL, 12978895, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844151, NULL, 365262434, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.10%2F%E2%99%A5
2011-01-13 14:14:48 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{"doi"=>"1.0/1337"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '1.0/1337') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:48', '1.0/1337', NULL, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (5.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844152, NULL, 12978895, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844152, NULL, 365262434, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F1.0%2F1337
2011-01-13 14:14:48 - INFO: Completed in 18ms (DB: 7) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:14:48 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"article"=>{"doi"=>"10.9898098098098/นก"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.9898098098098/นก') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:14:48', '10.9898098098098/นก', NULL, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844153, NULL, 12978895, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:14:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:14:48', 959844153, NULL, 365262434, 0)[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/articles/info:doi%2F10.9898098098098%2F%E0%B8%99%E0%B8%81
2011-01-13 14:14:48 - INFO: Completed in 13ms (DB: 2) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (72.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing DocsController#index (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"index", "controller"=>"docs"}
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/docs/install
2011-01-13 14:14:48 - INFO: Completed in 2ms (DB: 72) | 302 Found [http://test.host/docs]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing DocsController#install (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"install", "controller"=>"docs"}
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering docs/index
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:48 - INFO: Completed in 6ms (View: 6, DB: 0) | 200 OK [http://test.host/docs/install]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: 

Processing GroupsController#groupArticleSummaries (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:14:48 - DEBUG: groupArticleSummaries
2011-01-13 14:14:48 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load Including Associations (0.4ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering groups/groupArticleSummaries
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:48 - INFO: Completed in 9ms (View: 3, DB: 1) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:14:48 - DEBUG: groupArticleSummaries
2011-01-13 14:14:48 - INFO: format:application/json
2011-01-13 14:14:48 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: Completed in 6ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=json]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "callback"=>"foo", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:14:48 - DEBUG: groupArticleSummaries
2011-01-13 14:14:48 - INFO: format:application/json
2011-01-13 14:14:48 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: Completed in 5ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?callback=foo&format=json]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: 

Processing GroupsController#groupArticleSummaries to xml (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"format"=>"xml", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:14:48 - DEBUG: groupArticleSummaries
2011-01-13 14:14:48 - INFO: format:application/xml
2011-01-13 14:14:48 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:14:48 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:14:48 - INFO: Completed in 7ms (View: 3, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=xml]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/
2011-01-13 14:14:48 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/logout]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = '2011-01-27 22:14:48', `remember_token` = '3bc7301eda81e6eb115de713547e65f9d6ddf418' WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering sessions/new
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:48 - INFO: Completed in 5ms (View: 4, DB: 1) | 200 OK [http://test.host/login]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (45.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = '2011-01-27 22:14:48', `remember_token` = 'fb20cc5140b59451f6480b7646f8a36874e28e4f' WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = '2011-01-13 22:09:48' WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'fb20cc5140b59451f6480b7646f8a36874e28e4f') LIMIT 1[0m
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering sessions/new
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'fb20cc5140b59451f6480b7646f8a36874e28e4f') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:48 - INFO: Completed in 4ms (View: 3, DB: 47) | 200 OK [http://test.host/login]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'fb20cc5140b59451f6480b7646f8a36874e28e4f') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (45.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:48 - WARN: Failed login for 'quentin' from 0.0.0.0 at 2011-01-13 14:14:48 -0800
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering sessions/new
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:48 - INFO: Completed in 4ms (View: 3, DB: 46) | 200 OK [http://test.host/session?login=quentin&password=bad+password]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/
2011-01-13 14:14:48 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/session?login=quentin&password=monkey]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (53.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = '2011-01-27 22:14:48', `remember_token` = 'a0e9c09d9b3195ffe973314948a86219ae3c13de' WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'a0e9c09d9b3195ffe973314948a86219ae3c13de') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Rendering template within layouts/application
2011-01-13 14:14:48 - INFO: Rendering sessions/new
2011-01-13 14:14:48 - INFO: Completed in 4ms (View: 2, DB: 54) | 200 OK [http://test.host/login]
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (49.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 14:14:48) [GET]
2011-01-13 14:14:48 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/
2011-01-13 14:14:48 - INFO: Completed in 1ms (DB: 50) | 302 Found [http://test.host/logout]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"remember_me"=>"0", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/
2011-01-13 14:14:48 - INFO: Completed in 6ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=0]
2011-01-13 14:14:48 - DEBUG:   [4;36;1mSQL (46.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:48 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:14:48) [POST]
2011-01-13 14:14:48 - INFO:   Parameters: {"remember_me"=>"1", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:48', `remember_token_expires_at` = '2011-01-27 22:14:48', `remember_token` = '10b9753eda55def11f8d4b0fe2b0bd464cf123bc' WHERE `id` = 1[0m
2011-01-13 14:14:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:48 - INFO: Redirected to http://test.host/
2011-01-13 14:14:48 - INFO: Completed in 3ms (DB: 47) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=1]
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (52.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"create", "controller"=>"sources", "source"=>{}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUnconfiguredSource Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUnconfiguredSource Create (0.3ms)[0m   [0;1mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 22:14:49', 0, '2011-01-13 22:14:49', 30, NULL, NULL, 604800, NULL, 10, 'UnconfiguredSource', NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262436 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262436)[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Redirected to http://test.host/sources
2011-01-13 14:14:49 - INFO: Completed in 10ms (DB: 56) | 302 Found [http://test.host/sources?&class=UnconfiguredSource]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (50.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#destroy (for 0.0.0.0 at 2011-01-13 14:14:49) [DELETE]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"destroy", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 1040397643) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mRetrieval Destroy (0.1ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 1040397643[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 650162847) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 650162847) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mRetrieval Destroy (0.1ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 650162847[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mCrossRef Destroy (0.2ms)[0m   [0;1mDELETE FROM `sources` WHERE `id` = 365262434[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Redirected to http://test.host/sources
2011-01-13 14:14:49 - INFO: Completed in 10ms (DB: 53) | 302 Found [http://test.host/sources/365262434]
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (47.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#edit (for 0.0.0.0 at 2011-01-13 14:14:49) [GET]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"edit", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering sources/edit
2011-01-13 14:14:49 - DEBUG:   [4;35;1mGroup Load (0.2ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (7.8ms)
2011-01-13 14:14:49 - INFO: Completed in 12ms (View: 10, DB: 48) | 200 OK [http://test.host/sources/365262434/edit]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#index (for 0.0.0.0 at 2011-01-13 14:14:49) [GET]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"index", "controller"=>"sources"}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering sources/index
2011-01-13 14:14:49 - DEBUG:   [4;35;1mGroup Load (0.0ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:14:49 - INFO: Completed in 11ms (View: 6, DB: 1) | 200 OK [http://test.host/sources]
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#new (for 0.0.0.0 at 2011-01-13 14:14:49) [GET]
2011-01-13 14:14:49 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"new", "controller"=>"sources"}
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering sources/new
2011-01-13 14:14:49 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (3.6ms)
2011-01-13 14:14:49 - INFO: Completed in 7ms (View: 5, DB: 0) | 200 OK [http://test.host/sources/new?class=UnconfiguredSource]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#show (for 0.0.0.0 at 2011-01-13 14:14:49) [GET]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"show", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) AND (`retrievals`.source_id = 365262434) ORDER BY (citations_count + other_citations_count) desc LIMIT 5[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering sources/show
2011-01-13 14:14:49 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:14:49 - INFO: Completed in 56ms (View: 53, DB: 1) | 200 OK [http://test.host/sources/365262434]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:14:49 - INFO: 

Processing SourcesController#update (for 0.0.0.0 at 2011-01-13 14:14:49) [PUT]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"update", "id"=>"365262434", "controller"=>"sources", "source"=>{"class"=>"CrossRef"}}
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mCrossRef Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Redirected to http://test.host/sources
2011-01-13 14:14:49 - INFO: Completed in 4ms (DB: 1) | 302 Found [http://test.host/sources/365262434?source%5Bclass%5D=CrossRef]
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:49', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Create (0.1ms)[0m   [0mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '4ad51996390d8c306901988bcc3275dcba12a997', '2011-01-13 22:14:49', 'c3eb7a745cee840da58931c9b16d424b24cb4367', NULL, '2011-01-13 22:14:49', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Redirected to http://test.host/
2011-01-13 14:14:49 - INFO: Completed in 8ms (DB: 1) | 302 Found [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (54.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>nil}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:49', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering users/new
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: Completed in 24ms (View: 12, DB: 56) | 200 OK [http://test.host/register?user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (53.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>nil, "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:49', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering users/new
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: Completed in 30ms (View: 16, DB: 56) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (53.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:49', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering users/new
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: Completed in 23ms (View: 9, DB: 55) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (52.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:14:49) [POST]
2011-01-13 14:14:49 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:14:49', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:14:49 - INFO: Rendering template within layouts/application
2011-01-13 14:14:49 - INFO: Rendering users/new
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - INFO: Completed in 14ms (View: 8, DB: 54) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:14:49 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:14:49 - DEBUG:   [4;36;1mSQL (45.3ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.1/foo', NULL, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mConnotea Columns (1.2ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844140, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mCrossRef Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844140, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (70.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Update (0.4ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:15:23', `retrieved_at` = '2011-01-13 22:14:23' WHERE `id` = 562580130[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:23', `retrieved_at` = '2011-01-13 22:14:23' WHERE `id` = 721439208[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:23', `retrieved_at` = '2011-01-13 22:14:23' WHERE `id` = 1040397643[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:23', `retrieved_at` = '2009-01-13 22:15:23' WHERE `id` = 721439208[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (46.9ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.8ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844141, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844141, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (47.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844142, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844142, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (44.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 22:15:23' [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.7ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 22:15:22' [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (53.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Create (0.4ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.1/foo', '2011-01-12 22:15:23', 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844143, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844143, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.8ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (44.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Create (0.4ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.1/foo', '2011-01-12 22:15:23', 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.4ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844144, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844144, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 22:15:23' [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (44.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:23', '10.1/foo', NULL, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844145, NULL, 12978895, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:23', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:23', 959844145, NULL, 365262434, 0)[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:15:23', `published_on` = '2011-01-12 22:15:23' WHERE `id` = 959844145[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.9ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (42.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:24', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:24', 1, NULL, 1, 0)[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (47.5ms)[0m   [0mCOMMIT[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:15:24 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:24', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 14:15:24 - DEBUG:   [4;35;1mSQL (45.8ms)[0m   [0mCOMMIT[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:25', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (43.4ms)[0m   [0mCOMMIT[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:25', '10.0/citable', NULL, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:25', 959844146, NULL, 12978895, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:25', 959844146, NULL, 365262434, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:15:25', NULL, '2011-01-13 22:15:25', 1040397658)[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:15:25 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:25 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:25', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:25 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:25 - INFO: Got 1 citation details.
2011-01-13 14:15:25 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:15:25 - DEBUG: Existing citation count: 1
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:15:25 - INFO: Creating citation uri
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:15:25', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 22:15:25', 1040397658)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mCitation Destroy (0.3ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG: Citation count: 2
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:25', `retrieved_at` = '2011-01-13 22:15:25' WHERE `id` = 1040397658[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:15:25', 1, '2011-01-13 22:15:25', 2011, 1040397658, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:15:25', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 14:15:25 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:25', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:15:25', `retrieved_at` = '2011-01-13 22:15:25' WHERE `id` = 959844146[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - INFO: Refreshed article 10.0/citable
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (44.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:15:25', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:25', 959844147, NULL, 12978895, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:15:25', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:15:25', 959844147, NULL, 365262434, 0)[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:15:25 - INFO: Skipping: article not published yet
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (48.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:15:25 - DEBUG: Updating 2 stale articles
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:15:25 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:25 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:25', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:15:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:25 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:25 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:25 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:15:25 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:15:25 - DEBUG: Request headers:
2011-01-13 14:15:25 - DEBUG: [accept] = '*/*'
2011-01-13 14:15:25 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:15:25 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:15:26 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:15:26 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:26', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (94.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mCrossRef Update (0.2ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 22:15:26', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:15:26 - DEBUG: Updating 2 stale articles
2011-01-13 14:15:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:15:26 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:26 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:26', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:15:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:26 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:26 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:26 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:26 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:15:26 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:15:26 - DEBUG: Request headers:
2011-01-13 14:15:26 - DEBUG: [accept] = '*/*'
2011-01-13 14:15:26 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:15:26 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:15:28 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:26", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:15:28 - DEBUG: Response headers:
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - INFO: Got 0 citation details.
2011-01-13 14:15:28 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:15:28 - DEBUG: Existing citation count: 0
2011-01-13 14:15:28 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:15:28 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:15:28 - DEBUG: Citation count: 0
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:28', `retrieved_at` = '2011-01-13 22:15:28' WHERE `id` = 124229983[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:15:28', 1, '2011-01-13 22:15:28', 2011, 124229983, 0)[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 14:15:28 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:28', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:28 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:28', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:28 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:26", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:28', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:15:28', `retrieved_at` = '2011-01-13 22:15:28' WHERE `id` = 959844139[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 14:15:28 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 14:15:28 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:28 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:28', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 14:15:28 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:28 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:28 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:28 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:28 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 14:15:28 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 14:15:28 - DEBUG: Request headers:
2011-01-13 14:15:28 - DEBUG: [accept] = '*/*'
2011-01-13 14:15:28 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:15:28 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:15:30 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:28", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:15:30 - DEBUG: Response headers:
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - INFO: Got 0 citation details.
2011-01-13 14:15:30 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:15:30 - DEBUG: Existing citation count: 0
2011-01-13 14:15:30 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:15:30 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:15:30 - DEBUG: Citation count: 0
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:30', `retrieved_at` = '2011-01-13 22:15:30' WHERE `id` = 868470324[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mHistory Load (0.4ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:15:30', 1, '2011-01-13 22:15:30', 2011, 868470324, 0)[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 14:15:30 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:30', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:30 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:30', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 14:15:30 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:30 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:30 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:26", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:30 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:30 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:15:30 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 14:15:30 - DEBUG: Request headers:
2011-01-13 14:15:30 - DEBUG: [accept] = '*/*'
2011-01-13 14:15:30 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:15:31 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:30", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 14:15:31 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:15:31', `disable_until` = '2011-01-13 22:15:41' WHERE `id` = 365262434[0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:31', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 14:15:31 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 14:15:31 - DEBUG:   [4;36;1mCrossRef Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (50.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:15:31 - DEBUG: Updating 1 stale article
2011-01-13 14:15:31 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:15:31 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:31 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:31', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:15:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:31 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:31 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:25", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:15:31 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:15:31 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:15:31 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:15:31 - DEBUG: Request headers:
2011-01-13 14:15:31 - DEBUG: [accept] = '*/*'
2011-01-13 14:15:31 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:15:31 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:15:32 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:15:25", updated_at: "2011-01-13 22:15:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:15:32 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:15:32', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (52.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSource Create (0.4ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 22:15:32', 0, '2011-01-13 22:15:32', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:32 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:15:32 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (53.3ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 22:15:33' WHERE `id` = 12978895[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:15:33 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 14:15:33 - INFO: Sent mail to alm@alm.example.org
2011-01-13 14:15:33 - DEBUG: 
Date: Thu, 13 Jan 2011 14:15:33 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 22:15:33', `disable_until` = '2011-01-15 22:15:33' WHERE `id` = 12978895[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (47.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mConnotea Update (0.3ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 22:15:33' WHERE `id` = 12978895[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:15:33 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 22:15:33', `disable_until` = '2011-01-13 22:15:37' WHERE `id` = 12978895[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - INFO: Connotea is disabled until 2011-01-13 14:15:37 -0800. Skipping.
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 22:15:37', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (56.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', 'c1d24951b9c0357aa710ae79bc34e948202b4faf', '2011-01-13 22:15:37', 'edb2ff6575a79722a61005296989aba2ee100b66', NULL, '2011-01-13 22:15:37', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (50.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (52.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = '2011-01-27 22:15:37', `remember_token` = '647951292a83f4d83671618e07b33d7ac8f48022' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (46.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = '2011-01-20 22:15:37', `remember_token` = 'f0a21554fb897cc81288a1d109142d9f24ae076d' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (46.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = '2011-01-20 22:15:37', `remember_token` = '8f996969c730a1bcc7fec7a4c6c06c79399ab393' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (49.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (49.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = '2011-01-27 22:15:37', `remember_token` = '5eff5a0c47b801f6e398cf46b15b91f9b1f3d080' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (40.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = '2011-01-27 22:15:37', `remember_token` = '6aa65c06e9ef2a4a3a7a6095252a3517f89641f0' WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:15:37', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:15:37 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:15:37 - DEBUG:   [4;36;1mSQL (45.2ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Create (0.3ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:15', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:15', '10.1/foo', NULL, 0)[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mConnotea Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:15', 959844140, NULL, 12978895, 0)[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mCrossRef Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844140 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:15', 959844140, NULL, 365262434, 0)[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844140) LIMIT 1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844140) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (52.6ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:35:15', `retrieved_at` = '2011-01-13 22:34:15' WHERE `id` = 562580130[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:15', `retrieved_at` = '2011-01-13 22:34:15' WHERE `id` = 721439208[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:15', `retrieved_at` = '2011-01-13 22:34:15' WHERE `id` = 1040397643[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:15', `retrieved_at` = '2009-01-13 22:35:15' WHERE `id` = 721439208[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (46.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mArticle Load (0.6ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:35:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:15 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:16', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844141, NULL, 12978895, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844141 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844141, NULL, 365262434, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (47.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:16', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844142, NULL, 12978895, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844142 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844142, NULL, 365262434, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (49.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSource Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-16 22:35:16' [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSource Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `disable_until` = '2011-01-13 22:35:15' [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (53.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:16', '10.1/foo', '2011-01-12 22:35:16', 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844143, NULL, 12978895, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844143 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844143, NULL, 365262434, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844143) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844143)) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844143 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (46.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Create (0.2ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:16', '10.1/foo', '2011-01-12 22:35:16', 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844144, NULL, 12978895, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844144 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844144, NULL, 365262434, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844144 AND (`retrievals`.`source_id` = 12978895)) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_until` = '2011-01-16 22:35:16' [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (47.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo') LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:16', '10.1/foo', NULL, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844145, NULL, 12978895, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844145 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 959844145, NULL, 365262434, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844145) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844145)) [0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1/foo' AND `articles`.id <> 959844145) LIMIT 1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:35:16', `published_on` = '2011-01-12 22:35:16' WHERE `id` = 959844145[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.7ms)[0m   [0;1mSELECT * FROM `articles` WHERE (articles.id IN (
	SELECT DISTINCT article_id
	FROM retrievals 
	JOIN sources ON retrievals.source_id = sources.id 
	WHERE retrievals.article_id = articles.id 
	AND retrievals.retrieved_at < TIMESTAMPADD(SECOND, - sources.staleness, UTC_TIMESTAMP())
	AND sources.active = 1
	AND (
		sources.disable_until IS NULL 
		OR sources.disable_until < UTC_TIMESTAMP()))
	AND articles.published_on < '2011-01-13') ORDER BY retrieved_at[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (51.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 819830547) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:16', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:16', 1, NULL, 1, 0)[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (45.4ms)[0m   [0mCOMMIT[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:35:16 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:16', `running` = 1 WHERE `id` = 1040397656[0m
2011-01-13 14:35:16 - DEBUG:   [4;35;1mSQL (43.0ms)[0m   [0mCOMMIT[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397656) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:17', `running` = 0 WHERE `id` = 1040397656[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (43.4ms)[0m   [0mCOMMIT[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:17', '10.0/citable', NULL, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:17', 959844146, NULL, 12978895, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:17', 959844146, NULL, 365262434, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mCitation Create (0.1ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:35:17', NULL, '2011-01-13 22:35:17', 1040397658)[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:35:17 - INFO: Updating article #<Article id: 959844146, doi: "10.0/citable", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844146 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:17 - DEBUG: Retrieval is #<Retrieval id: 1040397658, article_id: 959844146, source_id: 365262434, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:17', `running` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:17 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:17 - INFO: Got 1 citation details.
2011-01-13 14:35:17 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:35:17 - DEBUG: Existing citation count: 1
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:35:17 - INFO: Creating citation uri
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:35:17', '--- \n:doi: doi\n:journal_title: journal_title\n:article_title: article_title\n:uri: uri\n', '2011-01-13 22:35:17', 1040397658)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190963[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG: Citation count: 2
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397658[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:17', `retrieved_at` = '2011-01-13 22:35:17' WHERE `id` = 1040397658[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397658) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:35:17', 1, '2011-01-13 22:35:17', 2011, 1040397658, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:35:17', `citations_count` = 1 WHERE `id` = 980190963[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - INFO: Saved history[980190963: 2011, 1] = 1
2011-01-13 14:35:17 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:17', `running` = 0 WHERE `id` = 1040397658[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844146) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:35:17', `retrieved_at` = '2011-01-13 22:35:17' WHERE `id` = 959844146[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - INFO: Refreshed article 10.0/citable
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844146) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844146)) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844146) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397658) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (45.9ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:17', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:17', 959844147, NULL, 12978895, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844147 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:17', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:17', 959844147, NULL, 365262434, 0)[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:35:17 - INFO: Skipping: article not published yet
2011-01-13 14:35:17 - INFO: Updating article #<Article id: 959844147, doi: "10.0/unpublished", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (39.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:35:17 - DEBUG: Updating 2 stale articles
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:17 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:17 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:17', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:35:17 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:17 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:17 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:17 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:17 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:35:17 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:35:17 - DEBUG: Request headers:
2011-01-13 14:35:17 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:17 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:17 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:35:18 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:35:18 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:35:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:18 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:18 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:18 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:18', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:35:18 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:18 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:22:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:21:in `test_second_article_is_sourced_on_timeout'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:20:in `test_second_article_is_sourced_on_timeout'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSQL (68.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mCrossRef Update (40.9ms)[0m   [0;1mUPDATE `sources` SET `updated_at` = '2011-01-13 22:35:19', `timeout` = 1 WHERE `id` = 365262434[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mArticle Load (4.6ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 819830547) ORDER BY articles.doi[0m
2011-01-13 14:35:19 - DEBUG: Updating 2 stale articles
2011-01-13 14:35:19 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:19 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:19 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:19', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:35:19 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:19 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:19 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:19 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:19 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:35:19 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:35:19 - DEBUG: Request headers:
2011-01-13 14:35:19 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:19 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:19 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:35:21 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:19", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:35:21 - DEBUG: Response headers:
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - INFO: Got 0 citation details.
2011-01-13 14:35:21 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:35:21 - DEBUG: Existing citation count: 0
2011-01-13 14:35:21 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:35:21 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:35:21 - DEBUG: Citation count: 0
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:21', `retrieved_at` = '2011-01-13 22:35:21' WHERE `id` = 124229983[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mHistory Load (0.4ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 124229983) LIMIT 1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mHistory Create (0.2ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:35:21', 1, '2011-01-13 22:35:21', 2011, 124229983, 0)[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - INFO: Saved history[980190964: 2011, 1] = 0
2011-01-13 14:35:21 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:21', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:21 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:21', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:21 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:19", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:21', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:35:21', `retrieved_at` = '2011-01-13 22:35:21' WHERE `id` = 959844139[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - INFO: Refreshed article 10.1371/journal.pbio.0000005
2011-01-13 14:35:21 - DEBUG: DOI: 10.1371/journal.pbio.0000005 count now 1 (0)
2011-01-13 14:35:21 - INFO: Updating article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>...
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:21 - DEBUG: Retrieval is #<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:21', `running` = 1 WHERE `id` = 868470324[0m
2011-01-13 14:35:21 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:21 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:21 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:21 - INFO: Asking Connotea about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:21 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited
2011-01-13 14:35:21 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/uncited (timeout: 30)
2011-01-13 14:35:21 - DEBUG: Request headers:
2011-01-13 14:35:21 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:21 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:21 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:35:23 - INFO: Requested http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/uncited with {:password=>"pass", :retrieval=>#<Retrieval id: 868470324, article_id: 819830547, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:21", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}, got: 
2011-01-13 14:35:23 - DEBUG: Response headers:
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - INFO: Got 0 citation details.
2011-01-13 14:35:23 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:35:23 - DEBUG: Existing citation count: 0
2011-01-13 14:35:23 - DEBUG: After existing citations uniquified: 0
2011-01-13 14:35:23 - DEBUG: Deleting remaining existing citations: 0
2011-01-13 14:35:23 - DEBUG: Citation count: 0
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 868470324) [0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval UPDATE (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:23', `retrieved_at` = '2011-01-13 22:35:23' WHERE `id` = 868470324[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 868470324) [0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mHistory Load (0.3ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 868470324) LIMIT 1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mHistory Create (0.3ms)[0m   [0mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:35:23', 1, '2011-01-13 22:35:23', 2011, 868470324, 0)[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - INFO: Saved history[980190965: 2011, 1] = 0
2011-01-13 14:35:23 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:23', `running` = 0 WHERE `id` = 868470324[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 819830547 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:23 - DEBUG: Retrieval is #<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 650162847) [0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:23', `running` = 1 WHERE `id` = 650162847[0m
2011-01-13 14:35:23 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:23 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:23 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:19", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 1, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:23 - INFO: Asking CrossRef about 10.1371/uncited; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:23 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:35:23 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited (timeout: 1)
2011-01-13 14:35:23 - DEBUG: Request headers:
2011-01-13 14:35:23 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:23 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:24 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Funcited with {:retrieval=>#<Retrieval id: 650162847, article_id: 819830547, source_id: 365262434, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:23", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :timeout=>1}: time's up!
2011-01-13 14:35:24 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:35:24', `disable_until` = '2011-01-13 22:35:34' WHERE `id` = 365262434[0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 819830547, doi: "10.1371/uncited", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2010-01-01", title: "Please cite me!", citations_count: 0>: 
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:24', `running` = 0 WHERE `id` = 650162847[0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - INFO: Not refreshing article 10.1371/uncited (count: 1, only src: )
2011-01-13 14:35:24 - DEBUG: DOI: 10.1371/uncited count now 0 (0)
2011-01-13 14:35:24 - DEBUG:   [4;36;1mCrossRef Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (54.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:24 - DEBUG: Updating 1 stale article
2011-01-13 14:35:24 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:24 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844139 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:24 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:24', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:35:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:24 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:24 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:17", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:24 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:24 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:35:24 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:35:24 - DEBUG: Request headers:
2011-01-13 14:35:24 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:24 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:24 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:35:25 - [4;31;1mERROR[0m: Error (RetrieverTimeout: execution expired) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:17", updated_at: "2011-01-13 22:35:24", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: execution expired
2011-01-13 14:35:25 - INFO: Forced Timeout on query.  Not disabling this source.
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.6ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:25', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - [4;31;1mERROR[0m: Timeout exceeded on article update/usr/lib/ruby/1.8/timeout.rb:64:in `method_missing'
/home/josowski/Work/alm/head/lib/source_helper.rb:84:in `get_http_body'
/var/lib/gems/1.8/gems/system_timer-1.0/lib/system_timer.rb:28:in `timeout_after'
/home/josowski/Work/alm/head/lib/source_helper.rb:83:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/lib/retriever.rb:199:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:197:in `update_articles'
/home/josowski/Work/alm/head/lib/retriever.rb:188:in `update_articles'
./test/unit/retriever_test.rb:9:in `test_update_times_out'
/usr/lib/ruby/1.8/test/unit/assertions.rb:123:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:47:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:500:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:46:in `assert_block'
/usr/lib/ruby/1.8/test/unit/assertions.rb:121:in `assert_raise'
/usr/lib/ruby/1.8/test/unit/assertions.rb:495:in `_wrap_assertion'
/usr/lib/ruby/1.8/test/unit/assertions.rb:111:in `assert_raise'
./test/unit/retriever_test.rb:8:in `test_update_times_out'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
./test/unit/retriever_test.rb:7:in `test_update_times_out'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: execution expired
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (43.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Create (0.3ms)[0m   [0mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 22:35:25', 0, '2011-01-13 22:35:25', 30, NULL, NULL, 604800, NULL, 10, NULL, NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262435 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262435)[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `retrievals` WHERE (`retrievals`.source_id = 365262435) [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (45.4ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT max(`sources`.staleness) AS max_staleness FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mConnotea Update (0.1ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 172800, `updated_at` = '2011-01-13 22:35:25' WHERE `id` = 12978895[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:35:25 - INFO: Connotea had an error. Disabling for 2 days.
2011-01-13 14:35:25 - INFO: Sent mail to alm@alm.example.org
2011-01-13 14:35:25 - DEBUG: 
Date: Thu, 13 Jan 2011 14:35:25 -0800
From: alm@plos.org
To: alm@alm.example.org
Subject: WARNING: Connotea has been delayed too long.
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mConnotea Update (0.1ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 345600, `updated_at` = '2011-01-13 22:35:25', `disable_until` = '2011-01-15 22:35:25' WHERE `id` = 12978895[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (46.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mConnotea Update (0.2ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 4, `updated_at` = '2011-01-13 22:35:25' WHERE `id` = 12978895[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:35:25 - INFO: Connotea had an error. Disabling for 4 seconds.
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mConnotea Update (0.3ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 8, `updated_at` = '2011-01-13 22:35:25', `disable_until` = '2011-01-13 22:35:29' WHERE `id` = 12978895[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - INFO: Connotea is disabled until 2011-01-13 14:35:29 -0800. Skipping.
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:25 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:25 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 10, `updated_at` = '2011-01-13 22:35:29', `disable_until` = NULL WHERE `id` = 12978895[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (43.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Create (0.2ms)[0m   [0;1mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '4b5ceb217d6b21906b93c27b44950f990d05d923', '2011-01-13 22:35:29', 'bc368779eb5778f59e0a570c60dd2181625e65c3', NULL, '2011-01-13 22:35:29', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (44.8ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `login` = 'quentin2' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin2') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (39.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `remember_token_expires_at` = '2011-01-27 22:35:29', `remember_token` = '1d392fcdabb1b1beea4ecb115c6872b4d62ed9c5' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (51.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `remember_token_expires_at` = '2011-01-20 22:35:29', `remember_token` = 'bf3b77082753076dad14b3fb643a3b0b2d31c803' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (44.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `remember_token_expires_at` = '2011-01-20 22:35:29', `remember_token` = '3ed3315214a6d2b658e53e36dd2d93b63e984b7a' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (46.0ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (6.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `crypted_password` = '75c97d98d5dbe8c92e04449bd8abaa23ce3c719a' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mSQL (47.9ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:29 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:29', `remember_token_expires_at` = '2011-01-27 22:35:29', `remember_token` = 'e07a8705b8effa78824ca026f9afc321974eb633' WHERE `id` = 1[0m
2011-01-13 14:35:29 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:30 - DEBUG:   [4;35;1mSQL (46.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:30 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:30 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:30 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:30', `remember_token_expires_at` = '2011-01-27 22:35:30', `remember_token` = 'e738ae6c2fc8ca0d7266527d412b11701c031dac' WHERE `id` = 1[0m
2011-01-13 14:35:30 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:30 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:35:30', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:35:30 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:30 - DEBUG:   [4;36;1mSQL (47.8ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:31 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:35:31) [POST]
2011-01-13 14:35:31 - INFO:   Parameters: {"article"=>{"doi"=>"10.0/dummy"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:35:31 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/dummy') LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mArticle Create (0.1ms)[0m   [0;1mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:35:31', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:35:31', '10.0/dummy', NULL, 0)[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mConnotea Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:31', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:31', 959844148, NULL, 12978895, 0)[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mCrossRef Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:35:31', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:35:31', 959844148, NULL, 365262434, 0)[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844148) LIMIT 1[0m
2011-01-13 14:35:31 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0%2Fdummy
2011-01-13 14:35:31 - INFO: Completed in 24ms (DB: 108) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.0%2Fdummy]
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mSQL (51.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:31 - INFO: 

Processing ArticlesController#destroy (for 0.0.0.0 at 2011-01-13 14:35:31) [DELETE]
2011-01-13 14:35:31 - INFO:   Parameters: {"action"=>"destroy", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:35:31 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 124229983) [0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 124229983) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mRetrieval Destroy (0.2ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 124229983[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mRetrieval Destroy (0.1ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 14:35:31 - DEBUG:   [4;36;1mArticle Destroy (0.1ms)[0m   [0;1mDELETE FROM `articles` WHERE `id` = 959844139[0m
2011-01-13 14:35:31 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:31 - INFO: Redirected to http://test.host/articles
2011-01-13 14:35:31 - INFO: Completed in 10ms (DB: 54) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 14:35:31 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mSQL (50.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:32 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:35:32) [GET]
2011-01-13 14:35:32 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles", "query"=>"pgen"}
2011-01-13 14:35:32 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (doi like '%pgen%') ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:35:32 - INFO: Rendering articles/index
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:35:32 - INFO: Completed in 10ms (View: 6, DB: 52) | 200 OK [http://test.host/articles.csv?query=pgen]
2011-01-13 14:35:32 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:32 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:35:32) [GET]
2011-01-13 14:35:32 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:35:32 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:32 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:db6ab5a5618c5b3176fa11c36f66adbc", :article_id=>959844139}
2011-01-13 14:35:32 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:32 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:32 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:32', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:35:32 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:32 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:32 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:32 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:32 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:35:32 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:35:32 - DEBUG: Request headers:
2011-01-13 14:35:32 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:32 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:32 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:35:45 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:32", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:35:45 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:35:45', `disable_until` = '2011-01-13 22:35:55' WHERE `id` = 12978895[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:35:45 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_json_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:35:45 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:45', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:45 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:45', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:35:45 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:45', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:35:45 - INFO: RetrievalWorker done.
2011-01-13 14:35:45 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:db6ab5a5618c5b3176fa11c36f66adbc
2011-01-13 14:35:45 - INFO: Completed in 13060ms (View: 1, DB: 8) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json]
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSQL (55.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:45 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:35:45) [GET]
2011-01-13 14:35:45 - INFO:   Parameters: {"format"=>"json", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:35:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:45 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:3e90aa2aaabb0832740d04c964a1b083", :article_id=>959844139}
2011-01-13 14:35:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:35:45 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:45 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:35:45', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:35:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:35:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:35:45 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:35:45 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:35:45 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:35:45 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:35:45 - DEBUG: Request headers:
2011-01-13 14:35:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:35:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:35:45 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:36:15 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:45", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 14:36:15 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:36:15', `disable_until` = '2011-01-13 22:36:25' WHERE `id` = 12978895[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:15', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:36:15 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:15', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:36:15 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:15', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:36:15 - INFO: RetrievalWorker done.
2011-01-13 14:36:15 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:3e90aa2aaabb0832740d04c964a1b083
2011-01-13 14:36:15 - INFO: Completed in 30044ms (View: 0, DB: 61) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c]
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSQL (58.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:36:15 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:36:15) [GET]
2011-01-13 14:36:15 - INFO:   Parameters: {"format"=>"json", "citations"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:36:15 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mCitation Load (0.3ms)[0m   [0mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:15 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:dc8b93f50a44390bddefb439f5650733", :article_id=>959844139}
2011-01-13 14:36:15 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:36:15 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:15 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:15', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:36:15 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:15 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:36:15 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:36:15 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:36:15 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:36:15 - DEBUG: Request headers:
2011-01-13 14:36:15 - DEBUG: [accept] = '*/*'
2011-01-13 14:36:15 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:36:15 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:36:45 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:36:15", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 14:36:45 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:36:45', `disable_until` = '2011-01-13 22:36:55' WHERE `id` = 12978895[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:45', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:36:45 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:45', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:36:45 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:45', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:36:45 - INFO: RetrievalWorker done.
2011-01-13 14:36:45 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:dc8b93f50a44390bddefb439f5650733
2011-01-13 14:36:45 - INFO: Completed in 30093ms (View: 0, DB: 66) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&citations=1]
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSQL (70.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:36:45 - INFO: 

Processing ArticlesController#show to json (for 0.0.0.0 at 2011-01-13 14:36:45) [GET]
2011-01-13 14:36:45 - INFO:   Parameters: {"format"=>"json", "history"=>"1", "action"=>"show", "callback"=>"c", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:36:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:45 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:867ac5cf90456e06886b8eed5f7fb22c", :article_id=>959844139}
2011-01-13 14:36:45 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:36:45 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:45 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:36:45', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:36:45 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:36:45 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:36:45 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:36:45 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:36:45 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:36:45 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:36:45 - DEBUG: Request headers:
2011-01-13 14:36:45 - DEBUG: [accept] = '*/*'
2011-01-13 14:36:45 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:36:45 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:37:15 - [4;31;1mERROR[0m: Error (Timeout::Error: time's up!) while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:36:45", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: time's up!
2011-01-13 14:37:15 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:37:15', `disable_until` = '2011-01-13 22:37:25' WHERE `id` = 12978895[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:15', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:15 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:15', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:15 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:15', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:37:15 - INFO: RetrievalWorker done.
2011-01-13 14:37:15 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:867ac5cf90456e06886b8eed5f7fb22c
2011-01-13 14:37:15 - INFO: Completed in 30047ms (View: 0, DB: 76) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.json?callback=c&history=1]
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSQL (63.5ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:15 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:37:15) [GET]
2011-01-13 14:37:15 - INFO:   Parameters: {"format"=>"xml", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:37:15 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:15 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:41a6ded6dc61884c87c577eea73c238a", :article_id=>959844139}
2011-01-13 14:37:15 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:15 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:15 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:15', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:37:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:15 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:15 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:15 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:37:15 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:37:15 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:37:15 - DEBUG: Request headers:
2011-01-13 14:37:15 - DEBUG: [accept] = '*/*'
2011-01-13 14:37:15 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:37:15 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:37:42 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:37:15", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:37:42 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:37:42', `disable_until` = '2011-01-13 22:37:52' WHERE `id` = 12978895[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:37:42 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:37:42 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:42', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:42 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:37:42 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:42', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:42 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:42', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:37:42 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:42 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:37:42 - INFO: RetrievalWorker done.
2011-01-13 14:37:42 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:41a6ded6dc61884c87c577eea73c238a
2011-01-13 14:37:42 - INFO: Completed in 27374ms (View: 0, DB: 73) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml]
2011-01-13 14:37:43 - DEBUG:   [4;35;1mSQL (72.7ms)[0m   [0mROLLBACK[0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:43 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:37:43) [GET]
2011-01-13 14:37:43 - INFO:   Parameters: {"format"=>"xml", "citations"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:37:43 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` WHERE (`citations`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:43 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:8d505a2b0bdce23f0f1a515ccf8ed793", :article_id=>959844139}
2011-01-13 14:37:43 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:43 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:37:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:43 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:37:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:43', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:37:43 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:43 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:43 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:37:43 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:37:43 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:37:43 - DEBUG: Request headers:
2011-01-13 14:37:43 - DEBUG: [accept] = '*/*'
2011-01-13 14:37:43 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:37:43 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:37:51 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:37:43", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:37:51 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mConnotea Update (0.5ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:37:51', `disable_until` = '2011-01-13 22:38:01' WHERE `id` = 12978895[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:37:51 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_citations_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:37:51 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:51', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:51 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:37:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:51', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:37:51 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - DEBUG:   [4;36;1mRetrieval Update (0.5ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:51', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:37:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:51 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:37:51 - INFO: RetrievalWorker done.
2011-01-13 14:37:51 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:8d505a2b0bdce23f0f1a515ccf8ed793
2011-01-13 14:37:51 - INFO: Completed in 8956ms (View: 0, DB: 79) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?citations=1]
2011-01-13 14:37:52 - DEBUG:   [4;36;1mSQL (107.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:52 - INFO: 

Processing ArticlesController#show to xml (for 0.0.0.0 at 2011-01-13 14:37:52) [GET]
2011-01-13 14:37:52 - INFO:   Parameters: {"format"=>"xml", "history"=>"1", "action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:37:52 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mRetrieval Load (0.5ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mHistory Load (0.2ms)[0m   [0mSELECT `histories`.* FROM `histories` WHERE (`histories`.retrieval_id IN (124229983,308602354)) [0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:52 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:3e42be72402cbf08ae673c948398c09c", :article_id=>959844139}
2011-01-13 14:37:52 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:37:52 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:37:52 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:52 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:37:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:37:52', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:37:52 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:37:52 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:37:52 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:37:52 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:37:52 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:37:52 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:37:52 - DEBUG: Request headers:
2011-01-13 14:37:52 - DEBUG: [accept] = '*/*'
2011-01-13 14:37:52 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:37:52 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:38:00 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:37:52", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:38:00 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mConnotea Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:00', `disable_until` = '2011-01-13 22:38:10' WHERE `id` = 12978895[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:38:00 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:187:in `test_should_generate_xml_with_history_format'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:38:00 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:00', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:00 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:00', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:00 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:00', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:38:00 - INFO: RetrievalWorker done.
2011-01-13 14:38:00 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:3e42be72402cbf08ae673c948398c09c
2011-01-13 14:38:00 - INFO: Completed in 8403ms (View: 0, DB: 116) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005.xml?history=1]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (50.9ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#edit (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"action"=>"edit", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:00 - INFO: Rendering template within layouts/application
2011-01-13 14:38:00 - INFO: Rendering articles/edit
Rendered articles/_form (5.7ms)
2011-01-13 14:38:00 - INFO: Completed in 16ms (View: 14, DB: 51) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005/edit]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"action"=>"index", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:38:00 - INFO: Rendering template within layouts/application
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:00 - INFO: Completed in 10ms (View: 7, DB: 1) | 200 OK [http://test.host/articles]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 4ms (View: 2, DB: 0) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#new (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"action"=>"new", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:00 - INFO: Rendering template within layouts/application
2011-01-13 14:38:00 - INFO: Rendering articles/new
Rendered articles/_form (4.1ms)
2011-01-13 14:38:00 - INFO: Completed in 7ms (View: 6, DB: 0) | 200 OK [http://test.host/articles/new]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"1", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load Including Associations (0.3ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) AND `articles`.id IN (959844139, 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 5ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv?cited=1]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `articles`.id) AS count_all FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load Including Associations (0.2ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (retrievals.citations_count > 0 OR retrievals.other_citations_count > 0) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "cited"=>"0", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load Including Associations (0.2ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) AND `articles`.id IN (819830547) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 5ms (View: 1, DB: 1) | 200 OK [http://test.host/articles.csv?cited=0]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT * FROM `articles` WHERE (EXISTS (SELECT * from retrievals where article_id = `articles`.id GROUP BY article_id HAVING SUM(IFNULL(retrievals.citations_count,0)) + SUM(IFNULL(retrievals.other_citations_count,0)) = 0)) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 8ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY articles.doi LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (959844139,562580130,819830547)) [0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 4ms (View: 2, DB: 1) | 200 OK [http://test.host/articles.csv]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#index to csv (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"format"=>"csv", "action"=>"index", "order"=>"published_on", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` ORDER BY published_on LIMIT 0, 30[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id IN (562580130,959844139,819830547)) [0m
2011-01-13 14:38:00 - INFO: Rendering articles/index
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:00 - INFO: Completed in 59ms (View: 55, DB: 1) | 200 OK [http://test.host/articles.csv?order=published_on]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:00) [POST]
2011-01-13 14:38:00 - INFO:   Parameters: {"article"=>{}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` IS NULL) LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - INFO: Rendering template within layouts/application
2011-01-13 14:38:00 - INFO: Rendering articles/new
Rendered articles/_form (9.7ms)
2011-01-13 14:38:00 - INFO: Completed in 20ms (View: 14, DB: 1) | 200 OK [http://test.host/articles?]
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - INFO: 

Processing ArticlesController#show (for 0.0.0.0 at 2011-01-13 14:38:00) [GET]
2011-01-13 14:38:00 - INFO:   Parameters: {"action"=>"show", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:38:00 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) [0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844139) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 959844139)) [0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:00 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:0bfa2d814dbd3995ec453dddf569a89e", :article_id=>959844139}
2011-01-13 14:38:00 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:00 - INFO: Updating article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>...
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:00 - DEBUG: Retrieval is #<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 124229983) [0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:00', `running` = 1 WHERE `id` = 124229983[0m
2011-01-13 14:38:00 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:00 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:00 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:00 - INFO: Asking Connotea about 10.1371/journal.pbio.0000005; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:38:00 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005
2011-01-13 14:38:00 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 (timeout: 30)
2011-01-13 14:38:00 - DEBUG: Request headers:
2011-01-13 14:38:00 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:00 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:00 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:38:15 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pbio.0000005 with {:password=>"pass", :retrieval=>#<Retrieval id: 124229983, article_id: 959844139, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:00", retrieved_at: "1970-01-01 00:00:00", citations_count: 0, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:38:15 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mConnotea Update (0.5ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:15', `disable_until` = '2011-01-13 22:38:25' WHERE `id` = 12978895[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:38:15 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:113:in `test_should_show_article'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:38:15 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 959844139, doi: "10.1371/journal.pbio.0000005", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2007-01-01", title: "The merry-go-round broke down", citations_count: 0>: 
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:15', `running` = 0 WHERE `id` = 124229983[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844139) LIMIT 1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:15 - DEBUG: Retrieval is #<Retrieval id: 308602354, article_id: 959844139, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2011-01-12 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=false)
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 308602354) [0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:15', `running` = 1 WHERE `id` = 308602354[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:15 - INFO: Not refreshing source #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:15', `running` = 0 WHERE `id` = 308602354[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - INFO: Not refreshing article 10.1371/journal.pbio.0000005 (count: 1, only src: )
2011-01-13 14:38:15 - INFO: RetrievalWorker done.
2011-01-13 14:38:15 - INFO: Queuing article 959844139 for retrieval as retrieval_workers:retrieval:0bfa2d814dbd3995ec453dddf569a89e
2011-01-13 14:38:15 - INFO: Rendering template within layouts/application
2011-01-13 14:38:15 - INFO: Rendering articles/show
2011-01-13 14:38:15 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:38:15 - INFO: Completed in 14364ms (View: 16, DB: 7) | 200 OK [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005]
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSQL (62.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:15 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:38:15) [GET]
2011-01-13 14:38:15 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles"}
2011-01-13 14:38:15 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT `retrievals`.* FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) [0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` IN (365262434,12978895)) [0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mRetrieval Load (0.5ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSource Load (0.4ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:15 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:43ceaddb51dd4ab317afb49e3475bf8b", :article_id=>562580130}
2011-01-13 14:38:15 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:15 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:15 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:15', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:38:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:15 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:15 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:15 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:15 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:38:15 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:15 - DEBUG: Request headers:
2011-01-13 14:38:15 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:15 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:15 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:38:26 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:15", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:38:26 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mConnotea Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:26', `disable_until` = '2011-01-13 22:38:36' WHERE `id` = 12978895[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.5ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:38:26 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:38:26 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:26', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:26 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Update (0.3ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:26', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:26 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:26 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:26 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:38:26 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:26 - DEBUG: Request headers:
2011-01-13 14:38:26 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:26 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:26 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:26", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:38:26 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mCrossRef Update (0.4ms)[0m   [0mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:26', `disable_until` = '2011-01-13 22:38:36' WHERE `id` = 365262434[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.6ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:38:26 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:118:in `test_should_show_article_csv_sources'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:38:26 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Update (0.8ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:26', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:38:26 - INFO: RetrievalWorker done.
2011-01-13 14:38:26 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:43ceaddb51dd4ab317afb49e3475bf8b
2011-01-13 14:38:26 - INFO: Rendering articles/show
2011-01-13 14:38:26 - DEBUG:   [4;35;1mCitation Load (0.4ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 14:38:26 - INFO: Completed in 11322ms (View: 7, DB: 75) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv]
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSQL (64.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:26 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:38:26) [GET]
2011-01-13 14:38:26 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"connotea"}
2011-01-13 14:38:26 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mArticle Load Including Associations (0.7ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('connotea')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:26 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:b5d3573c5eecc8b3f726914b52550467", :article_id=>562580130}
2011-01-13 14:38:26 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:26 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:26 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:26', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:38:26 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:26 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:26 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:26 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:26 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:38:26 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:26 - DEBUG: Request headers:
2011-01-13 14:38:26 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:26 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:26 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:38:36 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:26", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:38:36 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mConnotea Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:36', `disable_until` = '2011-01-13 22:38:46' WHERE `id` = 12978895[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:38:36 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:38:36 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:36', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:36 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:36', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:36 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:36 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:36 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:38:36 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:36 - DEBUG: Request headers:
2011-01-13 14:38:36 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:36 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:36 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:36", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:38:36 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:36', `disable_until` = '2011-01-13 22:38:46' WHERE `id` = 365262434[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:38:36 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:124:in `test_should_show_article_csv_sources_connotea'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:38:36 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:36', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:38:36 - INFO: RetrievalWorker done.
2011-01-13 14:38:36 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:b5d3573c5eecc8b3f726914b52550467
2011-01-13 14:38:36 - INFO: Rendering articles/show
2011-01-13 14:38:36 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 721439208) LIMIT 1[0m
2011-01-13 14:38:36 - INFO: Completed in 10320ms (View: 4, DB: 74) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=connotea]
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (67.4ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:36 - INFO: 

Processing ArticlesController#show to csv (for 0.0.0.0 at 2011-01-13 14:38:36) [GET]
2011-01-13 14:38:36 - INFO:   Parameters: {"format"=>"csv", "action"=>"show", "id"=>"10.1371/journal.pgen.1000111", "controller"=>"articles", "source"=>"crossref"}
2011-01-13 14:38:36 - DEBUG:   [4;35;1mArticle Load IDs For Limited Eager Loading (0.2ms)[0m   [0mSELECT DISTINCT `articles`.id FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mArticle Load Including Associations (0.8ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `sources`.`id` AS t2_r0, `sources`.`type` AS t2_r1, `sources`.`url` AS t2_r2, `sources`.`username` AS t2_r3, `sources`.`password` AS t2_r4, `sources`.`staleness` AS t2_r5, `sources`.`created_at` AS t2_r6, `sources`.`updated_at` AS t2_r7, `sources`.`active` AS t2_r8, `sources`.`name` AS t2_r9, `sources`.`live_mode` AS t2_r10, `sources`.`salt` AS t2_r11, `sources`.`searchURL` AS t2_r12, `sources`.`timeout` AS t2_r13, `sources`.`group_id` AS t2_r14, `sources`.`disable_until` AS t2_r15, `sources`.`disable_delay` AS t2_r16, `sources`.`partner_id` AS t2_r17 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id WHERE (LOWER(sources.name) IN ('crossref')) AND (`articles`.`doi` = '10.1371/journal.pgen.1000111') AND `articles`.id IN (562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 562580130) AND ((source_id in (select id from sources where active = 1)) AND (`retrievals`.article_id = 562580130)) [0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:36 - INFO: RetrievalWorker: {:uid=>"retrieval_workers:retrieval:dad98f509280569e8142f488e70b3e0b", :article_id=>562580130}
2011-01-13 14:38:36 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:36 - INFO: Updating article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>...
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:36 - DEBUG: Retrieval is #<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:36 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 721439208) [0m
2011-01-13 14:38:36 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:36', `running` = 1 WHERE `id` = 721439208[0m
2011-01-13 14:38:36 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:37 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 12978895) [0m
2011-01-13 14:38:37 - INFO: Refreshing source: #<Connotea id: 12978895, type: "Connotea", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "Connotea", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: nil, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:37 - INFO: Asking Connotea about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:37 - INFO: Connotea query: http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111
2011-01-13 14:38:37 - DEBUG: http request: /data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:37 - DEBUG: Request headers:
2011-01-13 14:38:37 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:37 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:37 - DEBUG: [authorization] = 'Basic dXNlcjpwYXNz'
2011-01-13 14:38:50 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Authorization Required") while requesting http://www.connotea.org/data/uri/http://dx.doi.org/10.1371/journal.pgen.1000111 with {:password=>"pass", :retrieval=>#<Retrieval id: 721439208, article_id: 562580130, source_id: 12978895, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:36", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :username=>"user", :timeout=>30}: 401 "Authorization Required"
2011-01-13 14:38:50 - INFO: Connotea had an error. Disabling for 10 seconds.
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mConnotea Update (0.6ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:50', `disable_until` = '2011-01-13 22:39:00' WHERE `id` = 12978895[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 12978895 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 12978895)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - [4;31;1mERROR[0m: Unable to query: 401 "Authorization Required"
2011-01-13 14:38:50 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/connotea.rb:34:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Authorization Required"
2011-01-13 14:38:50 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:50', `running` = 0 WHERE `id` = 721439208[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 562580130) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:50 - DEBUG: Retrieval is #<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=true, stale?=true)
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397643) [0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:50', `running` = 1 WHERE `id` = 1040397643[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:50 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:38:50 - INFO: Asking CrossRef about 10.1371/journal.pgen.1000111; last updated 2009-01-12 16:00:00 -0800
2011-01-13 14:38:50 - INFO: CrossRef query: http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=
2011-01-13 14:38:50 - DEBUG: http request: /servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 (timeout: 30)
2011-01-13 14:38:50 - DEBUG: Request headers:
2011-01-13 14:38:50 - DEBUG: [accept] = '*/*'
2011-01-13 14:38:50 - DEBUG: [user-agent] = 'Article Level Metrics - http://alm.josowski.plos.org'
2011-01-13 14:38:50 - [4;31;1mERROR[0m: Error (Net::HTTPServerException: 401 "Unauthorized") while requesting http://doi.crossref.org/servlet/getForwardLinks?usr=user&pwd=pass&doi=10.1371%2Fjournal.pgen.1000111 with {:retrieval=>#<Retrieval id: 1040397643, article_id: 562580130, source_id: 365262434, created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:38:50", retrieved_at: "2009-01-13 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: true>, :timeout=>30}: 401 "Unauthorized"
2011-01-13 14:38:50 - INFO: CrossRef had an error. Disabling for 10 seconds.
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mCrossRef Update (0.4ms)[0m   [0;1mUPDATE `sources` SET `disable_delay` = 20, `updated_at` = '2011-01-13 22:38:50', `disable_until` = '2011-01-13 22:39:00' WHERE `id` = 365262434[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - [4;31;1mERROR[0m: Unable to query: 401 "Unauthorized"
2011-01-13 14:38:50 - [4;31;1mERROR[0m: /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
/home/josowski/Work/alm/head/lib/source_helper.rb:102:in `get_http_body'
/home/josowski/Work/alm/head/lib/source_helper.rb:31:in `get_xml'
/home/josowski/Work/alm/head/app/models/sources/cross_ref.rb:33:in `perform_query'
/home/josowski/Work/alm/head/app/models/source.rb:102:in `query'
/home/josowski/Work/alm/head/lib/retriever.rb:91:in `update_one'
/home/josowski/Work/alm/head/lib/retriever.rb:60:in `update'
/home/josowski/Work/alm/head/app/models/retrieval.rb:46:in `try_to_exclusively'
/home/josowski/Work/alm/head/lib/retriever.rb:56:in `update'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `__send__'
/var/lib/gems/1.8/gems/activerecord-2.3.8/lib/active_record/named_scope.rb:109:in `each'
/home/josowski/Work/alm/head/lib/retriever.rb:52:in `update'
/home/josowski/Work/alm/head/app/workers/retrieval_worker.rb:23:in `retrieval'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `send'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:40:in `dispatch_to_worker_method'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/base.rb:37:in `dispatch!'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote/runners/not_remote_runner.rb:16:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/remote.rb:38:in `run'
/home/josowski/Work/alm/head/vendor/plugins/workling/lib/workling/base.rb:50:in `method_missing'
/home/josowski/Work/alm/head/app/controllers/articles_controller.rb:60:in `show'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:617:in `call_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/flash.rb:151:in `perform_action'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `send'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/base.rb:532:in `process_without_filters'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/filters.rb:606:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:567:in `process_with_test'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:447:in `process'
/var/lib/gems/1.8/gems/actionpack-2.3.8/lib/action_controller/test_process.rb:398:in `get'
./test/functional/articles_controller_test.rb:130:in `test_should_show_article_csv_sources_crossref'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `__send__'
/var/lib/gems/1.8/gems/activesupport-2.3.8/lib/active_support/testing/setup_and_teardown.rb:62:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:34:in `run'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `each'
/usr/lib/ruby/1.8/test/unit/testsuite.rb:33:in `run'
/usr/lib/ruby/1.8/test/unit/ui/testrunnermediator.rb:46:in `run_suite'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:67:in `start_mediator'
/usr/lib/ruby/1.8/test/unit/ui/console/testrunner.rb:41:in `start'
/usr/lib/ruby/1.8/test/unit/ui/testrunnerutilities.rb:29:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:216:in `run'
/usr/lib/ruby/1.8/test/unit/autorunner.rb:12:in `run'
/usr/lib/ruby/1.8/test/unit.rb:279
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake/rake_test_loader.rb:5: 401 "Unauthorized"
2011-01-13 14:38:50 - [4;31;1mERROR[0m: result=false, error refreshing article #<Article id: 562580130, doi: "10.1371/journal.pgen.1000111", created_at: "2011-01-13 22:35:31", updated_at: "2011-01-13 22:35:31", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2005-10-05", title: "Jackdaws love my big sphinx of quartz", citations_count: 0>: 
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:38:50', `running` = 0 WHERE `id` = 1040397643[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - INFO: Not refreshing article 10.1371/journal.pgen.1000111 (count: 0, only src: )
2011-01-13 14:38:50 - INFO: RetrievalWorker done.
2011-01-13 14:38:50 - INFO: Queuing article 562580130 for retrieval as retrieval_workers:retrieval:dad98f509280569e8142f488e70b3e0b
2011-01-13 14:38:50 - INFO: Rendering articles/show
2011-01-13 14:38:50 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Completed in 13770ms (View: 4, DB: 77) | 200 OK [http://test.host/articles/10.1371%2Fjournal.pgen.1000111.csv?source=crossref]
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (53.4ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#update (for 0.0.0.0 at 2011-01-13 14:38:50) [PUT]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{}, "action"=>"update", "id"=>"info:doi%2F10.1371%2Fjournal.pbio.0000005", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`doi` = '10.1371/journal.pbio.0000005') ORDER BY articles.doi LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1371/journal.pbio.0000005' AND `articles`.id <> 959844139) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1371%2Fjournal.pbio.0000005
2011-01-13 14:38:50 - INFO: Completed in 4ms (DB: 54) | 302 Found [http://test.host/articles/info:doi%252F10.1371%252Fjournal.pbio.0000005?]
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:50) [POST]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{"doi"=>"10.1000/182"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.1000/182') LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:38:50', '10.1000/182', NULL, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844149, NULL, 12978895, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844149, NULL, 365262434, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844149) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F10.1000%2F182
2011-01-13 14:38:50 - INFO: Completed in 61ms (DB: 2) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:50) [POST]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{"doi"=>"10.0092/ooh"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0092/ooh') LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:38:50', '10.0092/ooh', NULL, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844150, NULL, 12978895, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844150, NULL, 365262434, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844150) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F10.0092%2Fooh
2011-01-13 14:38:50 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:50) [POST]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{"doi"=>"10.10/♥"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.10/♥') LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:38:50', '10.10/♥', NULL, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844151, NULL, 12978895, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844151, NULL, 365262434, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844151) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F10.10%2F%E2%99%A5
2011-01-13 14:38:50 - INFO: Completed in 13ms (DB: 2) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:50) [POST]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{"doi"=>"1.0/1337"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '1.0/1337') LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:38:50', '1.0/1337', NULL, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844152, NULL, 12978895, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844152, NULL, 365262434, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844152) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F1.0%2F1337
2011-01-13 14:38:50 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:38:50 - INFO: 

Processing ArticlesController#create (for 0.0.0.0 at 2011-01-13 14:38:50) [POST]
2011-01-13 14:38:50 - INFO:   Parameters: {"article"=>{"doi"=>"10.9898098098098/นก"}, "action"=>"create", "controller"=>"articles"}
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.9898098098098/นก') LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:38:50', '10.9898098098098/นก', NULL, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844153, NULL, 12978895, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:38:50', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:38:50', 959844153, NULL, 365262434, 0)[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 12978895 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`source_id` = 365262434 AND `retrievals`.`article_id` = 959844153) LIMIT 1[0m
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/articles/info:doi%2F10.9898098098098%2F%E0%B8%99%E0%B8%81
2011-01-13 14:38:50 - INFO: Completed in 10ms (DB: 1) | 302 Found [http://test.host/articles?article%5Bdoi%5D=10.1000%2F182]
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `articles` [0m
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (63.9ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:50 - INFO: 

Processing DocsController#index (for 0.0.0.0 at 2011-01-13 14:38:50) [GET]
2011-01-13 14:38:50 - INFO:   Parameters: {"action"=>"index", "controller"=>"docs"}
2011-01-13 14:38:50 - INFO: Redirected to http://test.host/docs/install
2011-01-13 14:38:50 - INFO: Completed in 2ms (DB: 64) | 302 Found [http://test.host/docs]
2011-01-13 14:38:50 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:50 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - INFO: 

Processing DocsController#install (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"install", "controller"=>"docs"}
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering docs/index
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 6ms (View: 6, DB: 0) | 200 OK [http://test.host/docs/install]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: 

Processing GroupsController#groupArticleSummaries (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:38:51 - DEBUG: groupArticleSummaries
2011-01-13 14:38:51 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:38:51 - DEBUG:   [4;36;1mArticle Load Including Associations (0.5ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering groups/groupArticleSummaries
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 10ms (View: 3, DB: 1) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:38:51 - DEBUG: groupArticleSummaries
2011-01-13 14:38:51 - INFO: format:application/json
2011-01-13 14:38:51 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:38:51 - DEBUG:   [4;35;1mArticle Load Including Associations (0.1ms)[0m   [0mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: Completed in 6ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=json]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: 

Processing GroupsController#groupArticleSummaries to json (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"format"=>"json", "action"=>"groupArticleSummaries", "callback"=>"foo", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:38:51 - DEBUG: groupArticleSummaries
2011-01-13 14:38:51 - INFO: format:application/json
2011-01-13 14:38:51 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:38:51 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: Completed in 6ms (View: 1, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?callback=foo&format=json]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: 

Processing GroupsController#groupArticleSummaries to xml (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"format"=>"xml", "action"=>"groupArticleSummaries", "id"=>"10.1371/journal.pbio.0000005", "controller"=>"groups"}
2011-01-13 14:38:51 - DEBUG: groupArticleSummaries
2011-01-13 14:38:51 - INFO: format:application/xml
2011-01-13 14:38:51 - INFO: ID:10.1371/journal.pbio.0000005
2011-01-13 14:38:51 - DEBUG:   [4;36;1mArticle Load Including Associations (0.1ms)[0m   [0;1mSELECT `articles`.`id` AS t0_r0, `articles`.`doi` AS t0_r1, `articles`.`created_at` AS t0_r2, `articles`.`updated_at` AS t0_r3, `articles`.`retrieved_at` AS t0_r4, `articles`.`pub_med` AS t0_r5, `articles`.`pub_med_central` AS t0_r6, `articles`.`published_on` AS t0_r7, `articles`.`title` AS t0_r8, `articles`.`citations_count` AS t0_r9, `retrievals`.`id` AS t1_r0, `retrievals`.`article_id` AS t1_r1, `retrievals`.`source_id` AS t1_r2, `retrievals`.`created_at` AS t1_r3, `retrievals`.`updated_at` AS t1_r4, `retrievals`.`retrieved_at` AS t1_r5, `retrievals`.`citations_count` AS t1_r6, `retrievals`.`other_citations_count` AS t1_r7, `retrievals`.`local_id` AS t1_r8, `retrievals`.`running` AS t1_r9, `citations`.`id` AS t2_r0, `citations`.`retrieval_id` AS t2_r1, `citations`.`uri` AS t2_r2, `citations`.`details` AS t2_r3, `citations`.`created_at` AS t2_r4, `citations`.`updated_at` AS t2_r5, `sources`.`id` AS t3_r0, `sources`.`type` AS t3_r1, `sources`.`url` AS t3_r2, `sources`.`username` AS t3_r3, `sources`.`password` AS t3_r4, `sources`.`staleness` AS t3_r5, `sources`.`created_at` AS t3_r6, `sources`.`updated_at` AS t3_r7, `sources`.`active` AS t3_r8, `sources`.`name` AS t3_r9, `sources`.`live_mode` AS t3_r10, `sources`.`salt` AS t3_r11, `sources`.`searchURL` AS t3_r12, `sources`.`timeout` AS t3_r13, `sources`.`group_id` AS t3_r14, `sources`.`disable_until` AS t3_r15, `sources`.`disable_delay` AS t3_r16, `sources`.`partner_id` AS t3_r17, `groups`.`id` AS t4_r0, `groups`.`name` AS t4_r1, `groups`.`created_at` AS t4_r2, `groups`.`updated_at` AS t4_r3 FROM `articles` LEFT OUTER JOIN `retrievals` ON retrievals.article_id = articles.id LEFT OUTER JOIN `citations` ON citations.retrieval_id = retrievals.id LEFT OUTER JOIN `sources` ON `sources`.id = `retrievals`.source_id LEFT OUTER JOIN `groups` ON `groups`.id = `sources`.group_id WHERE (articles.doi in ('10.1371/journal.pbio.0000005') and (retrievals.citations_count > 0 or retrievals.other_citations_count > 0)) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: Completed in 7ms (View: 3, DB: 0) | 200 OK [http://test.host/group/articles/10.1371%2Fjournal.pbio.0000005?format=xml]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/logout]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = '2011-01-27 22:38:51', `remember_token` = 'a027f628faaa1afbd45b3e55f1821f2ba63496f3' WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sessions/new
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 10ms (View: 8, DB: 1) | 200 OK [http://test.host/login]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (45.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = '2011-01-27 22:38:51', `remember_token` = '609e8db0ac606bee2d0f53cb63ebf50639507ac4' WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = '2011-01-13 22:33:51' WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '609e8db0ac606bee2d0f53cb63ebf50639507ac4') LIMIT 1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sessions/new
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '609e8db0ac606bee2d0f53cb63ebf50639507ac4') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 11ms (View: 8, DB: 47) | 200 OK [http://test.host/login]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '609e8db0ac606bee2d0f53cb63ebf50639507ac4') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (47.3ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:38:51 - WARN: Failed login for 'quentin' from 0.0.0.0 at 2011-01-13 14:38:51 -0800
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sessions/new
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 4ms (View: 3, DB: 48) | 200 OK [http://test.host/session?login=quentin&password=bad+password]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Update (0.1ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 2ms (DB: 0) | 302 Found [http://test.host/session?login=quentin&password=monkey]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (47.0ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = '2011-01-27 22:38:51', `remember_token` = '0f9f459ca20a0546c0af103722b1af5e4dee7fba' WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#new (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"new", "controller"=>"sessions"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '0f9f459ca20a0546c0af103722b1af5e4dee7fba') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sessions/new
2011-01-13 14:38:51 - INFO: Completed in 8ms (View: 4, DB: 48) | 200 OK [http://test.host/login]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (50.2ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#destroy (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"destroy", "controller"=>"sessions"}
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 0ms (DB: 51) | 302 Found [http://test.host/logout]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"remember_me"=>"0", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 2ms (DB: 1) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=0]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (47.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - INFO: 

Processing SessionsController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"remember_me"=>"1", "action"=>"create", "controller"=>"sessions", "password"=>"[FILTERED]", "login"=>"quentin"}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quentin') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = '2011-01-27 22:38:51', `remember_token` = 'cb3ba6b3d75ae56c869adf0b93f7daeb29fe384d' WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 5ms (DB: 49) | 302 Found [http://test.host/session?login=quentin&password=monkey&remember_me=1]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (49.2ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"create", "controller"=>"sources", "source"=>{}}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.3ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUnconfiguredSource Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUnconfiguredSource Create (0.3ms)[0m   [0;1mINSERT INTO `sources` (`name`, `salt`, `created_at`, `live_mode`, `updated_at`, `timeout`, `url`, `username`, `staleness`, `group_id`, `disable_delay`, `type`, `disable_until`, `password`, `searchURL`, `partner_id`, `active`) VALUES(NULL, NULL, '2011-01-13 22:38:51', 0, '2011-01-13 22:38:51', 30, NULL, NULL, 604800, NULL, 10, 'UnconfiguredSource', NULL, NULL, NULL, NULL, 1)[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.5ms)[0m   [0m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262436 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262436)[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/sources
2011-01-13 14:38:51 - INFO: Completed in 17ms (DB: 52) | 302 Found [http://test.host/sources?&class=UnconfiguredSource]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (50.8ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#destroy (for 0.0.0.0 at 2011-01-13 14:38:51) [DELETE]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"destroy", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mCitation Load (0.2ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397643) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 1040397643) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mRetrieval Destroy (0.2ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 1040397643[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 650162847) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mHistory Load (0.1ms)[0m   [0mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 650162847) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mRetrieval Destroy (0.1ms)[0m   [0;1mDELETE FROM `retrievals` WHERE `id` = 650162847[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mCitation Load (0.1ms)[0m   [0mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 308602354) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.retrieval_id = 308602354) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mRetrieval Destroy (0.1ms)[0m   [0mDELETE FROM `retrievals` WHERE `id` = 308602354[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mCrossRef Destroy (0.1ms)[0m   [0;1mDELETE FROM `sources` WHERE `id` = 365262434[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/sources
2011-01-13 14:38:51 - INFO: Completed in 13ms (DB: 54) | 302 Found [http://test.host/sources/365262434]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (76.5ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#edit (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"edit", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sources/edit
2011-01-13 14:38:51 - DEBUG:   [4;35;1mGroup Load (0.2ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (7.8ms)
2011-01-13 14:38:51 - INFO: Completed in 12ms (View: 10, DB: 77) | 200 OK [http://test.host/sources/365262434/edit]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#index (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"index", "controller"=>"sources"}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` [0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sources/index
2011-01-13 14:38:51 - DEBUG:   [4;35;1mGroup Load (0.0ms)[0m   [0mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:38:51 - INFO: Completed in 12ms (View: 6, DB: 1) | 200 OK [http://test.host/sources]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#new (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"class"=>"UnconfiguredSource", "action"=>"new", "controller"=>"sources"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`type` = 'UnconfiguredSource') LIMIT 1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sources/new
2011-01-13 14:38:51 - DEBUG:   [4;35;1mGroup Load (0.1ms)[0m   [0mSELECT * FROM `groups` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` [0m
Rendered sources/_form (3.6ms)
2011-01-13 14:38:51 - INFO: Completed in 7ms (View: 6, DB: 0) | 200 OK [http://test.host/sources/new?class=UnconfiguredSource]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#show (for 0.0.0.0 at 2011-01-13 14:38:51) [GET]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"show", "id"=>"365262434", "controller"=>"sources"}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.source_id = 365262434) AND (`retrievals`.source_id = 365262434) ORDER BY (citations_count + other_citations_count) desc LIMIT 5[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering sources/show
2011-01-13 14:38:51 - DEBUG:   [4;36;1mGroup Load (0.1ms)[0m   [0;1mSELECT * FROM `groups` WHERE (`groups`.`id` = 287030888) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 562580130) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844139) ORDER BY articles.doi[0m
2011-01-13 14:38:51 - INFO: Completed in 58ms (View: 55, DB: 1) | 200 OK [http://test.host/sources/365262434]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:38:51 - INFO: 

Processing SourcesController#update (for 0.0.0.0 at 2011-01-13 14:38:51) [PUT]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"update", "id"=>"365262434", "controller"=>"sources", "source"=>{"class"=>"CrossRef"}}
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mCrossRef Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) AND ( (`sources`.`type` = 'CrossRef' ) ) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1m
 INSERT INTO retrievals (article_id, source_id)
 SELECT id, 365262434 FROM articles
 WHERE id NOT IN
 (SELECT article_id FROM retrievals WHERE source_id = 365262434)[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/sources
2011-01-13 14:38:51 - INFO: Completed in 4ms (DB: 1) | 302 Found [http://test.host/sources/365262434?source%5Bclass%5D=CrossRef]
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.1ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Create (0.1ms)[0m   [0mINSERT INTO `users` (`name`, `salt`, `created_at`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `remember_token`, `login`, `email`) VALUES('', '0a64e007c87cc11a8fa8d011aaa61f8ae198e99e', '2011-01-13 22:38:51', '32d46db0c8f6ce011438896a07c9af9730c59462', NULL, '2011-01-13 22:38:51', NULL, 'quire', 'quire@example.com')[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Redirected to http://test.host/
2011-01-13 14:38:51 - INFO: Completed in 8ms (DB: 1) | 302 Found [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (50.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>nil}}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering users/new
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 18ms (View: 11, DB: 53) | 200 OK [http://test.host/register?user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (48.1ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>nil, "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering users/new
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 25ms (View: 14, DB: 51) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (49.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:38:51) [POST]
2011-01-13 14:38:51 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:38:51 - INFO: Rendering template within layouts/application
2011-01-13 14:38:51 - INFO: Rendering users/new
2011-01-13 14:38:51 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:51 - INFO: Completed in 26ms (View: 12, DB: 52) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire69&user%5Bpassword_confirmation%5D=]
2011-01-13 14:38:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (48.7ms)[0m   [0;1mROLLBACK[0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - INFO: 

Processing UsersController#create (for 0.0.0.0 at 2011-01-13 14:38:52) [POST]
2011-01-13 14:38:52 - INFO:   Parameters: {"action"=>"create", "controller"=>"users", "user"=>{"password_confirmation"=>"[FILTERED]", "login"=>"quire", "password"=>"[FILTERED]", "email"=>"quire@example.com"}}
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mUser Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-01-13 22:38:52', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` = BINARY 'quire') LIMIT 1[0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` = BINARY 'quire@example.com') LIMIT 1[0m
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
2011-01-13 14:38:52 - INFO: Rendering template within layouts/application
2011-01-13 14:38:52 - INFO: Rendering users/new
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - INFO: Completed in 14ms (View: 8, DB: 51) | 200 OK [http://test.host/register?user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire69]
2011-01-13 14:38:52 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
2011-01-13 14:38:52 - DEBUG:   [4;36;1mSQL (53.0ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:40:34', '10.0/citable', NULL, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mConnotea Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844154 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:40:34', 959844154, NULL, 12978895, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCrossRef Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844154 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:40:34', 959844154, NULL, 365262434, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844154 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:40:34', NULL, '2011-01-13 22:40:34', 1040397680)[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844154) [0m
2011-01-13 14:40:34 - INFO: Updating article #<Article id: 959844154, doi: "10.0/citable", created_at: "2011-01-13 22:40:34", updated_at: "2011-01-13 22:40:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844154 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:40:34 - DEBUG: Retrieval is #<Retrieval id: 1040397680, article_id: 959844154, source_id: 365262434, created_at: "2011-01-13 22:40:34", updated_at: "2011-01-13 22:40:34", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:40:34', `running` = 1 WHERE `id` = 1040397680[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:40:34", updated_at: "2011-01-13 22:40:34", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:40:34 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:40:34 - INFO: Got 1 citation details.
2011-01-13 14:40:34 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:40:34 - DEBUG: Existing citation count: 1
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:40:34 - INFO: Creating citation uri
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:40:34', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-13 22:40:34', 1040397680)[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190965[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG: Citation count: 2
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397680[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:40:34', `retrieved_at` = '2011-01-13 22:40:34' WHERE `id` = 1040397680[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397680) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:40:34', 1, '2011-01-13 22:40:34', 2011, 1040397680, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:40:34', `citations_count` = 1 WHERE `id` = 980190966[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - INFO: Saved history[980190966: 2011, 1] = 1
2011-01-13 14:40:34 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:40:34', `running` = 0 WHERE `id` = 1040397680[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844154) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:40:34', `retrieved_at` = '2011-01-13 22:40:34' WHERE `id` = 959844154[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - INFO: Refreshed article 10.0/citable
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844154) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844154)) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844154) [0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397680) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (55.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mArticle Create (0.4ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:40:34', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844155 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:40:34', 959844155, NULL, 12978895, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844155 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:40:34', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:40:34', 959844155, NULL, 365262434, 0)[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:40:34 - INFO: Updating article #<Article id: 959844155, doi: "10.0/unpublished", created_at: "2011-01-13 22:40:34", updated_at: "2011-01-13 22:40:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:40:34 - INFO: Skipping: article not published yet
2011-01-13 14:40:34 - INFO: Updating article #<Article id: 959844155, doi: "10.0/unpublished", created_at: "2011-01-13 22:40:34", updated_at: "2011-01-13 22:40:34", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:40:34 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:40:34 - DEBUG:   [4;36;1mSQL (50.0ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mArticle Create (0.4ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:41:48', '10.0/citable', NULL, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSource Load (0.5ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mConnotea Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844156 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:41:48', 959844156, NULL, 12978895, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCrossRef Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844156 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:41:48', 959844156, NULL, 365262434, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844156 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mCitation Create (0.3ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:41:48', NULL, '2011-01-13 22:41:48', 1040397684)[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844156) [0m
2011-01-13 14:41:48 - INFO: Updating article #<Article id: 959844156, doi: "10.0/citable", created_at: "2011-01-13 22:41:48", updated_at: "2011-01-13 22:41:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844156 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:41:48 - DEBUG: Retrieval is #<Retrieval id: 1040397684, article_id: 959844156, source_id: 365262434, created_at: "2011-01-13 22:41:48", updated_at: "2011-01-13 22:41:48", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:41:48', `running` = 1 WHERE `id` = 1040397684[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:41:48", updated_at: "2011-01-13 22:41:48", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:41:48 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:41:48 - INFO: Got 1 citation details.
2011-01-13 14:41:48 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:41:48 - DEBUG: Existing citation count: 1
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:41:48 - INFO: Creating citation uri
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Create (0.3ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:41:48', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-13 22:41:48', 1040397684)[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190967[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG: Citation count: 2
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval UPDATE (0.3ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397684[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Update (0.4ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:41:48', `retrieved_at` = '2011-01-13 22:41:48' WHERE `id` = 1040397684[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mHistory Load (0.4ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397684) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mHistory Create (0.4ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:41:48', 1, '2011-01-13 22:41:48', 2011, 1040397684, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:41:48', `citations_count` = 1 WHERE `id` = 980190967[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - INFO: Saved history[980190967: 2011, 1] = 1
2011-01-13 14:41:48 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:41:48', `running` = 0 WHERE `id` = 1040397684[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844156) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:41:48', `retrieved_at` = '2011-01-13 22:41:48' WHERE `id` = 959844156[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - INFO: Refreshed article 10.0/citable
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844156) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844156)) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844156) [0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397684) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (55.6ms)[0m   [0mROLLBACK[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:41:48', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844157 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:41:48', 959844157, NULL, 12978895, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844157 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:41:48', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:41:48', 959844157, NULL, 365262434, 0)[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:41:48 - INFO: Updating article #<Article id: 959844157, doi: "10.0/unpublished", created_at: "2011-01-13 22:41:48", updated_at: "2011-01-13 22:41:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:41:48 - INFO: Skipping: article not published yet
2011-01-13 14:41:48 - INFO: Updating article #<Article id: 959844157, doi: "10.0/unpublished", created_at: "2011-01-13 22:41:48", updated_at: "2011-01-13 22:41:48", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:41:48 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:41:48 - DEBUG:   [4;36;1mSQL (52.6ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:58:27', '10.0/citable', NULL, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mConnotea Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844158 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:58:27', 959844158, NULL, 12978895, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCrossRef Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844158 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:58:27', 959844158, NULL, 365262434, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844158 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-13 22:58:27', NULL, '2011-01-13 22:58:27', 1040397688)[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844158) [0m
2011-01-13 14:58:27 - INFO: Updating article #<Article id: 959844158, doi: "10.0/citable", created_at: "2011-01-13 22:58:27", updated_at: "2011-01-13 22:58:27", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844158 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-13 14:58:27 - DEBUG: Retrieval is #<Retrieval id: 1040397688, article_id: 959844158, source_id: 365262434, created_at: "2011-01-13 22:58:27", updated_at: "2011-01-13 22:58:27", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:58:27', `running` = 1 WHERE `id` = 1040397688[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-13 22:58:27", updated_at: "2011-01-13 22:58:27", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-13 14:58:27 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-13 14:58:27 - INFO: Got 1 citation details.
2011-01-13 14:58:27 - DEBUG: (after filtering out 0 duplicates!)
2011-01-13 14:58:27 - DEBUG: Existing citation count: 1
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG: After existing citations uniquified: 1
2011-01-13 14:58:27 - INFO: Creating citation uri
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-13 22:58:27', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-13 22:58:27', 1040397688)[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG: Deleting remaining existing citations: 1
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190969[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG: Citation count: 2
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397688[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:58:27', `retrieved_at` = '2011-01-13 22:58:27' WHERE `id` = 1040397688[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397688) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-13 22:58:27', 1, '2011-01-13 22:58:27', 2011, 1040397688, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-13 22:58:27', `citations_count` = 1 WHERE `id` = 980190968[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - INFO: Saved history[980190968: 2011, 1] = 1
2011-01-13 14:58:27 - INFO: result=true, sources_count incremented: 1
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-13 22:58:27', `running` = 0 WHERE `id` = 1040397688[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844158) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-13 22:58:27', `retrieved_at` = '2011-01-13 22:58:27' WHERE `id` = 959844158[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - INFO: Refreshed article 10.0/citable
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844158) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844158)) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844158) [0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397688) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (64.9ms)[0m   [0mROLLBACK[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-13 22:58:27', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844159 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:58:27', 959844159, NULL, 12978895, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844159 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-13 22:58:27', '1970-01-01 00:00:00', 0, NULL, '2011-01-13 22:58:27', 959844159, NULL, 365262434, 0)[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-13 14:58:27 - INFO: Updating article #<Article id: 959844159, doi: "10.0/unpublished", created_at: "2011-01-13 22:58:27", updated_at: "2011-01-13 22:58:27", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:58:27 - INFO: Skipping: article not published yet
2011-01-13 14:58:27 - INFO: Updating article #<Article id: 959844159, doi: "10.0/unpublished", created_at: "2011-01-13 22:58:27", updated_at: "2011-01-13 22:58:27", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-13 14:58:27 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-13 14:58:27 - DEBUG:   [4;36;1mSQL (44.7ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (23.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:26:51', '10.0/citable', NULL, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mConnotea Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844160 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:26:51', 959844160, NULL, 12978895, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCrossRef Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844160 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:26:51', 959844160, NULL, 365262434, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844160 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:26:51', NULL, '2011-01-14 17:26:51', 1040397692)[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844160) [0m
2011-01-14 09:26:51 - INFO: Updating article #<Article id: 959844160, doi: "10.0/citable", created_at: "2011-01-14 17:26:51", updated_at: "2011-01-14 17:26:51", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844160 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:26:51 - DEBUG: Retrieval is #<Retrieval id: 1040397692, article_id: 959844160, source_id: 365262434, created_at: "2011-01-14 17:26:51", updated_at: "2011-01-14 17:26:51", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:26:51', `running` = 1 WHERE `id` = 1040397692[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:26:51", updated_at: "2011-01-14 17:26:51", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:26:51 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:26:51 - INFO: Got 1 citation details.
2011-01-14 09:26:51 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:26:51 - DEBUG: Existing citation count: 1
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:26:51 - INFO: Creating citation uri
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:26:51', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:26:51', 1040397692)[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190971[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG: Citation count: 2
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397692[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:26:51', `retrieved_at` = '2011-01-14 17:26:51' WHERE `id` = 1040397692[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397692) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:26:51', 1, '2011-01-14 17:26:51', 2011, 1040397692, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:26:51', `citations_count` = 1 WHERE `id` = 980190969[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - INFO: Saved history[980190969: 2011, 1] = 1
2011-01-14 09:26:51 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:26:51', `running` = 0 WHERE `id` = 1040397692[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844160) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:26:51', `retrieved_at` = '2011-01-14 17:26:51' WHERE `id` = 959844160[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - INFO: Refreshed article 10.0/citable
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844160) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844160)) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844160) [0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397692) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (64.1ms)[0m   [0mROLLBACK[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:26:51', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844161 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:26:51', 959844161, NULL, 12978895, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844161 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:26:51', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:26:51', 959844161, NULL, 365262434, 0)[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:26:51 - INFO: Updating article #<Article id: 959844161, doi: "10.0/unpublished", created_at: "2011-01-14 17:26:51", updated_at: "2011-01-14 17:26:51", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:26:51 - INFO: Skipping: article not published yet
2011-01-14 09:26:51 - INFO: Updating article #<Article id: 959844161, doi: "10.0/unpublished", created_at: "2011-01-14 17:26:51", updated_at: "2011-01-14 17:26:51", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:26:51 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:26:51 - DEBUG:   [4;36;1mSQL (48.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:30:33', '10.0/citable', NULL, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mConnotea Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844162 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:30:33', 959844162, NULL, 12978895, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCrossRef Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844162 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:30:33', 959844162, NULL, 365262434, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844162 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mCitation Create (0.3ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:30:33', NULL, '2011-01-14 17:30:33', 1040397696)[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844162) [0m
2011-01-14 09:30:33 - INFO: Updating article #<Article id: 959844162, doi: "10.0/citable", created_at: "2011-01-14 17:30:33", updated_at: "2011-01-14 17:30:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844162 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:30:33 - DEBUG: Retrieval is #<Retrieval id: 1040397696, article_id: 959844162, source_id: 365262434, created_at: "2011-01-14 17:30:33", updated_at: "2011-01-14 17:30:33", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:30:33', `running` = 1 WHERE `id` = 1040397696[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:30:33", updated_at: "2011-01-14 17:30:33", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:30:33 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:30:33 - INFO: Got 1 citation details.
2011-01-14 09:30:33 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:30:33 - DEBUG: Existing citation count: 1
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:30:33 - INFO: Creating citation uri
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Create (0.3ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:30:33', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:30:33', 1040397696)[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190973[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG: Citation count: 2
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397696[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:30:33', `retrieved_at` = '2011-01-14 17:30:33' WHERE `id` = 1040397696[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397696) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mHistory Create (0.3ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:30:33', 1, '2011-01-14 17:30:33', 2011, 1040397696, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mHistory Update (0.3ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:30:33', `citations_count` = 1 WHERE `id` = 980190970[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - INFO: Saved history[980190970: 2011, 1] = 1
2011-01-14 09:30:33 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:30:33', `running` = 0 WHERE `id` = 1040397696[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844162) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:30:33', `retrieved_at` = '2011-01-14 17:30:33' WHERE `id` = 959844162[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - INFO: Refreshed article 10.0/citable
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844162) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844162)) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844162) [0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397696) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (54.7ms)[0m   [0mROLLBACK[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:30:33', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844163 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:30:33', 959844163, NULL, 12978895, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844163 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:30:33', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:30:33', 959844163, NULL, 365262434, 0)[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:30:33 - INFO: Updating article #<Article id: 959844163, doi: "10.0/unpublished", created_at: "2011-01-14 17:30:33", updated_at: "2011-01-14 17:30:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:30:33 - INFO: Skipping: article not published yet
2011-01-14 09:30:33 - INFO: Updating article #<Article id: 959844163, doi: "10.0/unpublished", created_at: "2011-01-14 17:30:33", updated_at: "2011-01-14 17:30:33", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:30:33 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:30:33 - DEBUG:   [4;36;1mSQL (50.8ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mArticle Load (0.5ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:31:53', '10.0/citable', NULL, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mConnotea Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844164 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:31:53', 959844164, NULL, 12978895, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCrossRef Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844164 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:31:53', 959844164, NULL, 365262434, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844164 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:31:53', NULL, '2011-01-14 17:31:53', 1040397700)[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Update (0.4ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844164) [0m
2011-01-14 09:31:53 - INFO: Updating article #<Article id: 959844164, doi: "10.0/citable", created_at: "2011-01-14 17:31:53", updated_at: "2011-01-14 17:31:53", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844164 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:31:53 - DEBUG: Retrieval is #<Retrieval id: 1040397700, article_id: 959844164, source_id: 365262434, created_at: "2011-01-14 17:31:53", updated_at: "2011-01-14 17:31:53", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:31:53', `running` = 1 WHERE `id` = 1040397700[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:31:53", updated_at: "2011-01-14 17:31:53", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:31:53 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:31:53 - INFO: Got 1 citation details.
2011-01-14 09:31:53 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:31:53 - DEBUG: Existing citation count: 1
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:31:53 - INFO: Creating citation uri
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:31:53', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:31:53', 1040397700)[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190975[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG: Citation count: 2
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397700[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:31:53', `retrieved_at` = '2011-01-14 17:31:53' WHERE `id` = 1040397700[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mHistory Load (0.2ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397700) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:31:53', 1, '2011-01-14 17:31:53', 2011, 1040397700, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:31:53', `citations_count` = 1 WHERE `id` = 980190971[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - INFO: Saved history[980190971: 2011, 1] = 1
2011-01-14 09:31:53 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:31:53', `running` = 0 WHERE `id` = 1040397700[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844164) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:31:53', `retrieved_at` = '2011-01-14 17:31:53' WHERE `id` = 959844164[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - INFO: Refreshed article 10.0/citable
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844164) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844164)) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844164) [0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397700) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (52.8ms)[0m   [0mROLLBACK[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:31:53', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844165 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:31:53', 959844165, NULL, 12978895, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844165 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:31:53 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:31:53', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:31:53', 959844165, NULL, 365262434, 0)[0m
2011-01-14 09:31:53 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:31:53 - INFO: Updating article #<Article id: 959844165, doi: "10.0/unpublished", created_at: "2011-01-14 17:31:53", updated_at: "2011-01-14 17:31:53", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:31:53 - INFO: Skipping: article not published yet
2011-01-14 09:31:53 - DEBUG:   [4;36;1mSQL (47.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mArticle Load (0.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:32:11', '10.0/citable', NULL, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mConnotea Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844166 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Create (0.5ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:32:11', 959844166, NULL, 12978895, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCrossRef Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844166 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:32:11', 959844166, NULL, 365262434, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844166 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mCitation Create (0.3ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:32:11', NULL, '2011-01-14 17:32:11', 1040397704)[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844166) [0m
2011-01-14 09:32:11 - INFO: Updating article #<Article id: 959844166, doi: "10.0/citable", created_at: "2011-01-14 17:32:11", updated_at: "2011-01-14 17:32:11", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844166 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:32:11 - DEBUG: Retrieval is #<Retrieval id: 1040397704, article_id: 959844166, source_id: 365262434, created_at: "2011-01-14 17:32:11", updated_at: "2011-01-14 17:32:11", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:32:11', `running` = 1 WHERE `id` = 1040397704[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:32:11", updated_at: "2011-01-14 17:32:11", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:32:11 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:32:11 - INFO: Got 1 citation details.
2011-01-14 09:32:11 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:32:11 - DEBUG: Existing citation count: 1
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:32:11 - INFO: Creating citation uri
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:32:11', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:32:11', 1040397704)[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190977[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG: Citation count: 2
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval UPDATE (0.3ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397704[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:32:11', `retrieved_at` = '2011-01-14 17:32:11' WHERE `id` = 1040397704[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397704) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:32:11', 1, '2011-01-14 17:32:11', 2011, 1040397704, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:32:11', `citations_count` = 1 WHERE `id` = 980190972[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - INFO: Saved history[980190972: 2011, 1] = 1
2011-01-14 09:32:11 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:32:11', `running` = 0 WHERE `id` = 1040397704[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mArticle Load (0.4ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844166) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mArticle Update (0.3ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:32:11', `retrieved_at` = '2011-01-14 17:32:11' WHERE `id` = 959844166[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - INFO: Refreshed article 10.0/citable
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844166) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844166)) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844166) [0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397704) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (49.1ms)[0m   [0mROLLBACK[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:32:11', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844167 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:32:11', 959844167, NULL, 12978895, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844167 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:32:11', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:32:11', 959844167, NULL, 365262434, 0)[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:32:11 - INFO: Updating article #<Article id: 959844167, doi: "10.0/unpublished", created_at: "2011-01-14 17:32:11", updated_at: "2011-01-14 17:32:11", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:32:11 - INFO: Skipping: article not published yet
2011-01-14 09:32:11 - INFO: Updating article #<Article id: 959844167, doi: "10.0/unpublished", created_at: "2011-01-14 17:32:11", updated_at: "2011-01-14 17:32:11", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:32:11 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:32:11 - DEBUG:   [4;35;1mSQL (0.4ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:32:12 - DEBUG:   [4;36;1mSQL (50.2ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:51:43', '10.0/citable', NULL, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mConnotea Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844168 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:51:43', 959844168, NULL, 12978895, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCrossRef Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844168 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:51:43', 959844168, NULL, 365262434, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844168 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mCitation Create (0.3ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:51:43', NULL, '2011-01-14 17:51:43', 1040397708)[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844168) [0m
2011-01-14 09:51:43 - INFO: Updating article #<Article id: 959844168, doi: "10.0/citable", created_at: "2011-01-14 17:51:43", updated_at: "2011-01-14 17:51:43", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Load (0.4ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844168 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:51:43 - DEBUG: Retrieval is #<Retrieval id: 1040397708, article_id: 959844168, source_id: 365262434, created_at: "2011-01-14 17:51:43", updated_at: "2011-01-14 17:51:43", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:51:43', `running` = 1 WHERE `id` = 1040397708[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:51:42", updated_at: "2011-01-14 17:51:42", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:51:43 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:51:43 - INFO: Got 1 citation details.
2011-01-14 09:51:43 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:51:43 - DEBUG: Existing citation count: 1
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:51:43 - INFO: Creating citation uri
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Create (0.3ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:51:43', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:51:43', 1040397708)[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mCitation Destroy (0.2ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190979[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG: Citation count: 2
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval UPDATE (0.2ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397708[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Update (0.2ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:51:43', `retrieved_at` = '2011-01-14 17:51:43' WHERE `id` = 1040397708[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mHistory Load (0.3ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397708) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mHistory Create (0.3ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:51:43', 1, '2011-01-14 17:51:43', 2011, 1040397708, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mHistory Update (0.2ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:51:43', `citations_count` = 1 WHERE `id` = 980190973[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - INFO: Saved history[980190973: 2011, 1] = 1
2011-01-14 09:51:43 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:51:43', `running` = 0 WHERE `id` = 1040397708[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844168) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:51:43', `retrieved_at` = '2011-01-14 17:51:43' WHERE `id` = 959844168[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - INFO: Refreshed article 10.0/citable
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mArticle Load (0.3ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844168) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mCitation Load (0.4ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844168)) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844168) [0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397708) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (55.3ms)[0m   [0mROLLBACK[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:51:43', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844169 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:51:43', 959844169, NULL, 12978895, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844169 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:51:43', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:51:43', 959844169, NULL, 365262434, 0)[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:51:43 - INFO: Updating article #<Article id: 959844169, doi: "10.0/unpublished", created_at: "2011-01-14 17:51:43", updated_at: "2011-01-14 17:51:43", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:51:43 - INFO: Skipping: article not published yet
2011-01-14 09:51:43 - INFO: Updating article #<Article id: 959844169, doi: "10.0/unpublished", created_at: "2011-01-14 17:51:43", updated_at: "2011-01-14 17:51:43", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 09:51:43 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSHOW TABLES[0m
2011-01-14 09:51:43 - DEBUG:   [4;36;1mSQL (49.8ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:52:15', '10.0/citable', NULL, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mConnotea Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844170 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Create (0.3ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:52:15', 959844170, NULL, 12978895, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCrossRef Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844170 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Create (0.4ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:52:15', 959844170, NULL, 365262434, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSource Load (0.4ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844170 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 17:52:15', NULL, '2011-01-14 17:52:15', 1040397712)[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.4ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844170) [0m
2011-01-14 09:52:15 - INFO: Updating article #<Article id: 959844170, doi: "10.0/citable", created_at: "2011-01-14 17:52:15", updated_at: "2011-01-14 17:52:15", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Load (0.3ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844170 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSource Load (0.2ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 09:52:15 - DEBUG: Retrieval is #<Retrieval id: 1040397712, article_id: 959844170, source_id: 365262434, created_at: "2011-01-14 17:52:15", updated_at: "2011-01-14 17:52:15", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Update (0.3ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:52:15', `running` = 1 WHERE `id` = 1040397712[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 17:52:15", updated_at: "2011-01-14 17:52:15", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 09:52:15 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 09:52:15 - INFO: Got 1 citation details.
2011-01-14 09:52:15 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 09:52:15 - DEBUG: Existing citation count: 1
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Load (0.3ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG: After existing citations uniquified: 1
2011-01-14 09:52:15 - INFO: Creating citation uri
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Create (0.2ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 17:52:15', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 17:52:15', 1040397712)[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190981[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG: Citation count: 2
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397712[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:52:15', `retrieved_at` = '2011-01-14 17:52:15' WHERE `id` = 1040397712[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397712) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mHistory Create (0.2ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 17:52:15', 1, '2011-01-14 17:52:15', 2011, 1040397712, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 17:52:15', `citations_count` = 1 WHERE `id` = 980190974[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - INFO: Saved history[980190974: 2011, 1] = 1
2011-01-14 09:52:15 - INFO: result=true, sources_count incremented: 1
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 17:52:15', `running` = 0 WHERE `id` = 1040397712[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844170) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mArticle Update (0.2ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 17:52:15', `retrieved_at` = '2011-01-14 17:52:15' WHERE `id` = 959844170[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - INFO: Refreshed article 10.0/citable
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844170) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844170)) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844170) [0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397712) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (57.0ms)[0m   [0mROLLBACK[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mArticle Create (0.3ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 17:52:15', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844171 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:52:15', 959844171, NULL, 12978895, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844171 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 09:52:15 - DEBUG:   [4;36;1mRetrieval Create (0.3ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 17:52:15', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 17:52:15', 959844171, NULL, 365262434, 0)[0m
2011-01-14 09:52:15 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 09:52:15 - INFO: Updating article #<Article id: 959844171, doi: "10.0/unpublished", created_at: "2011-01-14 17:52:15", updated_at: "2011-01-14 17:52:15", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:52:15 - INFO: Skipping: article not published yet
2011-01-14 09:52:15 - INFO: Updating article #<Article id: 959844171, doi: "10.0/unpublished", created_at: "2011-01-14 17:52:15", updated_at: "2011-01-14 17:52:15", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 09:52:15 - INFO: Skipping: article not published yet
2011-01-14 09:52:15 - DEBUG:   [4;36;1mSQL (41.1ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mArticle Load (0.3ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 18:33:24', '10.0/citable', NULL, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mConnotea Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Load (0.2ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844172 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Create (0.2ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 18:33:24', 959844172, NULL, 12978895, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCrossRef Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844172 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 18:33:24', 959844172, NULL, 365262434, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSource Load (0.3ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844172 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mCitation Create (0.2ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 18:33:24', NULL, '2011-01-14 18:33:24', 1040397716)[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844172) [0m
2011-01-14 10:33:24 - INFO: Updating article #<Article id: 959844172, doi: "10.0/citable", created_at: "2011-01-14 18:33:24", updated_at: "2011-01-14 18:33:24", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844172 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 10:33:24 - DEBUG: Retrieval is #<Retrieval id: 1040397716, article_id: 959844172, source_id: 365262434, created_at: "2011-01-14 18:33:24", updated_at: "2011-01-14 18:33:24", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Update (0.2ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 18:33:24', `running` = 1 WHERE `id` = 1040397716[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 18:33:24", updated_at: "2011-01-14 18:33:24", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 10:33:24 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 10:33:24 - INFO: Got 1 citation details.
2011-01-14 10:33:24 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 10:33:24 - DEBUG: Existing citation count: 1
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG: After existing citations uniquified: 1
2011-01-14 10:33:24 - INFO: Creating citation uri
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 18:33:24', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 18:33:24', 1040397716)[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190983[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG: Citation count: 2
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397716[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 18:33:24', `retrieved_at` = '2011-01-14 18:33:24' WHERE `id` = 1040397716[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397716) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 18:33:24', 1, '2011-01-14 18:33:24', 2011, 1040397716, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 18:33:24', `citations_count` = 1 WHERE `id` = 980190975[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - INFO: Saved history[980190975: 2011, 1] = 1
2011-01-14 10:33:24 - INFO: result=true, sources_count incremented: 1
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 18:33:24', `running` = 0 WHERE `id` = 1040397716[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mArticle Load (0.2ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844172) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 18:33:24', `retrieved_at` = '2011-01-14 18:33:24' WHERE `id` = 959844172[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - INFO: Refreshed article 10.0/citable
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844172) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mCitation Load (0.2ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844172)) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844172) [0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397716) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (69.2ms)[0m   [0mROLLBACK[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mArticle Load (0.1ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mArticle Create (0.2ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 18:33:24', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.3ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844173 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 18:33:24', 959844173, NULL, 12978895, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mRetrieval Load (0.2ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844173 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mRetrieval Create (0.2ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 18:33:24', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 18:33:24', 959844173, NULL, 365262434, 0)[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 10:33:24 - INFO: Updating article #<Article id: 959844173, doi: "10.0/unpublished", created_at: "2011-01-14 18:33:24", updated_at: "2011-01-14 18:33:24", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 10:33:24 - INFO: Skipping: article not published yet
2011-01-14 10:33:24 - INFO: Updating article #<Article id: 959844173, doi: "10.0/unpublished", created_at: "2011-01-14 18:33:24", updated_at: "2011-01-14 18:33:24", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 10:33:24 - DEBUG:   [4;35;1mSQL (0.3ms)[0m   [0mSHOW TABLES[0m
2011-01-14 10:33:24 - DEBUG:   [4;36;1mSQL (48.0ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (18.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (13.8ms)[0m   [0mSELECT version FROM schema_migrations[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mArticle Load (22.4ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable') LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mArticle Create (9.5ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 22:32:59', '10.0/citable', NULL, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSource Load (0.2ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mConnotea Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `sources`[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844174 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Create (0.1ms)[0m   [0mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 22:32:59', 959844174, NULL, 12978895, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCrossRef Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `sources`[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844174 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 22:32:59', 959844174, NULL, 365262434, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844174 AND (`retrievals`.`source_id` = 365262434)) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mCitation Create (0.1ms)[0m   [0mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('bogus', '2011-01-14 22:32:59', NULL, '2011-01-14 22:32:59', 1040397720)[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844174) [0m
2011-01-14 14:32:59 - INFO: Updating article #<Article id: 959844174, doi: "10.0/citable", created_at: "2011-01-14 22:32:59", updated_at: "2011-01-14 22:32:59", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: nil, title: nil, citations_count: 0>...
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844174 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSource Load (0.1ms)[0m   [0mSELECT * FROM `sources` WHERE (`sources`.`id` = 365262434) [0m
2011-01-14 14:32:59 - DEBUG: Retrieval is #<Retrieval id: 1040397720, article_id: 959844174, source_id: 365262434, created_at: "2011-01-14 22:32:59", updated_at: "2011-01-14 22:32:59", retrieved_at: "1970-01-01 00:00:00", citations_count: 1, other_citations_count: 0, local_id: nil, running: nil> (lazy=nil, stale?=true)
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 22:32:59', `running` = 1 WHERE `id` = 1040397720[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - INFO: Refreshing source: #<CrossRef id: 365262434, type: "CrossRef", url: nil, username: "user", staleness: 31557600, created_at: "2011-01-14 22:32:58", updated_at: "2011-01-14 22:32:58", active: true, name: "CrossRef", live_mode: false, salt: nil, searchURL: nil, timeout: 30, group_id: 287030888, disable_until: nil, disable_delay: 10, partner_id: nil>
2011-01-14 14:32:59 - INFO: Asking CrossRef about 10.0/citable; last updated 1969-12-31 16:00:00 -0800
2011-01-14 14:32:59 - INFO: Got 1 citation details.
2011-01-14 14:32:59 - DEBUG: (after filtering out 0 duplicates!)
2011-01-14 14:32:59 - DEBUG: Existing citation count: 1
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG: After existing citations uniquified: 1
2011-01-14 14:32:59 - INFO: Creating citation uri
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Create (0.1ms)[0m   [0;1mINSERT INTO `citations` (`uri`, `created_at`, `details`, `updated_at`, `retrieval_id`) VALUES('uri', '2011-01-14 22:32:59', '--- \n:journal_title: journal_title\n:article_title: article_title\n:doi: doi\n:uri: uri\n', '2011-01-14 22:32:59', 1040397720)[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) + 1 WHERE (`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG: Deleting remaining existing citations: 1
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `citations_count` = COALESCE(`citations_count`, 0) - 1 WHERE (`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mCitation Destroy (0.1ms)[0m   [0mDELETE FROM `citations` WHERE `id` = 980190985[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG: Citation count: 2
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `citations` WHERE (`citations`.retrieval_id = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval UPDATE (0.1ms)[0m   [0mUPDATE `retrievals` SET `citations_count` = 1 WHERE `id` = 1040397720[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Update (0.1ms)[0m   [0mUPDATE `retrievals` SET `updated_at` = '2011-01-14 22:32:59', `retrieved_at` = '2011-01-14 22:32:59' WHERE `id` = 1040397720[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mHistory Load (0.1ms)[0m   [0;1mSELECT * FROM `histories` WHERE (`histories`.`month` = 1 AND `histories`.`year` = 2011) AND (`histories`.retrieval_id = 1040397720) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mHistory Create (0.1ms)[0m   [0;1mINSERT INTO `histories` (`created_at`, `month`, `updated_at`, `year`, `retrieval_id`, `citations_count`) VALUES('2011-01-14 22:32:59', 1, '2011-01-14 22:32:59', 2011, 1040397720, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mHistory Update (0.1ms)[0m   [0mUPDATE `histories` SET `updated_at` = '2011-01-14 22:32:59', `citations_count` = 1 WHERE `id` = 980190976[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - INFO: Saved history[980190976: 2011, 1] = 1
2011-01-14 14:32:59 - INFO: result=true, sources_count incremented: 1
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Update (0.1ms)[0m   [0;1mUPDATE `retrievals` SET `updated_at` = '2011-01-14 22:32:59', `running` = 0 WHERE `id` = 1040397720[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/citable' AND `articles`.id <> 959844174) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mArticle Update (0.1ms)[0m   [0;1mUPDATE `articles` SET `updated_at` = '2011-01-14 22:32:59', `retrieved_at` = '2011-01-14 22:32:59' WHERE `id` = 959844174[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - INFO: Refreshed article 10.0/citable
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.`uri` = 'uri') [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT * FROM `citations` WHERE (`citations`.retrieval_id = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mArticle Load (0.1ms)[0m   [0mSELECT * FROM `articles` WHERE (`articles`.`id` = 959844174) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mCitation Load (0.1ms)[0m   [0;1mSELECT `citations`.* FROM `citations` INNER JOIN `retrievals` ON `citations`.retrieval_id = `retrievals`.id WHERE ((`retrievals`.article_id = 959844174)) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.article_id = 959844174) [0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Load (0.1ms)[0m   [0;1mSELECT * FROM `retrievals` WHERE (`retrievals`.`id` = 1040397720) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (89.6ms)[0m   [0mROLLBACK[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mArticle Load (0.2ms)[0m   [0;1mSELECT `articles`.id FROM `articles` WHERE (`articles`.`doi` = BINARY '10.0/unpublished') LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mArticle Create (0.1ms)[0m   [0mINSERT INTO `articles` (`created_at`, `retrieved_at`, `pub_med`, `pub_med_central`, `title`, `updated_at`, `doi`, `published_on`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', NULL, NULL, NULL, '2011-01-14 22:32:59', '10.0/unpublished', '2000-01-01', 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSource Load (0.1ms)[0m   [0;1mSELECT * FROM `sources` WHERE (`sources`.`active` = 1) [0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844175 AND `retrievals`.`source_id` = 12978895) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 22:32:59', 959844175, NULL, 12978895, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mRetrieval Load (0.1ms)[0m   [0mSELECT * FROM `retrievals` WHERE (`retrievals`.`article_id` = 959844175 AND `retrievals`.`source_id` = 365262434) LIMIT 1[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mRetrieval Create (0.1ms)[0m   [0;1mINSERT INTO `retrievals` (`created_at`, `retrieved_at`, `other_citations_count`, `running`, `updated_at`, `article_id`, `local_id`, `source_id`, `citations_count`) VALUES('2011-01-14 22:32:59', '1970-01-01 00:00:00', 0, NULL, '2011-01-14 22:32:59', 959844175, NULL, 365262434, 0)[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
2011-01-14 14:32:59 - INFO: Updating article #<Article id: 959844175, doi: "10.0/unpublished", created_at: "2011-01-14 22:32:59", updated_at: "2011-01-14 22:32:59", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 14:32:59 - INFO: Skipping: article not published yet
2011-01-14 14:32:59 - INFO: Updating article #<Article id: 959844175, doi: "10.0/unpublished", created_at: "2011-01-14 22:32:59", updated_at: "2011-01-14 22:32:59", retrieved_at: "1970-01-01 00:00:00", pub_med: nil, pub_med_central: nil, published_on: "2000-01-01", title: nil, citations_count: 0>...
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSHOW TABLES[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (0.1ms)[0m   [0;1mSHOW TABLES[0m
2011-01-14 14:32:59 - DEBUG:   [4;35;1mSQL (0.1ms)[0m   [0mSHOW TABLES[0m
2011-01-14 14:32:59 - DEBUG:   [4;36;1mSQL (86.9ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (33.6ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT version FROM schema_migrations[0m
